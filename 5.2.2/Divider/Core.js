var Turn=0,sbl=["O","X"],Brd=[],RB=0,cnt="F;B;R;L;FR;BR;FL;BL",RBs=18,cr=["lightgray","white"],bc=["palevioletred","lightsteelblue"]
function Set(crd){if(Turn==0)Wtr();if(Controls(crd).innerHTML==""){Controls(crd).innerHTML=sbl[Turn%2];Rng(crd);Turn++;Wtr()}}
function Rng(crd){var ord=Split(cnt,";"),arw="";for(i in ord){var lst=[],ck=0;arw="";for(j=0;j<10;j++){arw+=ord[i];if(Controls(Crd(arw,crd))){var t=Controls(Crd(arw,crd)).innerHTML;if(t==sbl[(Turn+1)%2]){lst.push(Crd(arw,crd))}if(t==sbl[Turn%2]&&Controls(Crd(arw,crd)).style.color!="blue"){ck=1;break}}else{break}}if(ck==1)for(j in lst)Controls(lst[j]).style.color="blue"}}
function Crd(arw,crd){var arw=Split(arw,""),x=0,y=0;for(var i in arw){switch(arw[i]){case"F":y--;break;case"B":y++;break;case"R":x++;break;case"L":x--;break}}return Chr(Asc(Mid(crd,0,1))+x)+Val(Val(Mid(crd,1,1))+y)}
function Cln(msg,tgt){var ck;if(msg!=""){ck=confirm(msg)}else{ck=true}if(ck==true){for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){if(Instr(Controls(Chr(cd1)+cd2).innerHTML,tgt)>-1){Controls(Chr(cd1)+cd2).innerHTML="";Controls(Chr(cd1)+cd2).title=""}if(Controls(Chr(cd1)+cd2).style.backgroundColor!="dimgray"||tgt==" "||tgt=="")Controls(Chr(cd1)+cd2).style.backgroundColor=cr[(cd1+cd2)%2];Controls(Chr(cd1)+cd2).style.color="black"}}if(tgt==""){Turn=0;Brd=[];if(RB==1)RdB()}}}
function Rul(){var OA=0,XA=0,PA=0;for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){var sym=Controls(Chr(cd1)+cd2).innerHTML;if(sym!=""){PA++;if(Controls(Chr(cd1)+cd2).style.color=="blue"){if(sym=="O"){XA++}else if(sym=="X"){OA++}}}}}if(Turn>2){if(OA>=PA/3)Cln("O Win.","");if(XA>=PA/3)Cln("X Win.","");if(PA==81)if(OA>XA){Cln("O Win.","")}else if(XA>OA){Cln("X Win.","")}else{Cln("Draw.","")}}}
function Wtr(){var s="";for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){var c=Controls(Chr(cd1)+cd2).style.color;switch(Controls(Chr(cd1)+cd2).innerHTML){case"O":if(c=="blue"){s+="4"}else{s+="0"}break;case"X":if(c=="blue"){s+="5"}else{s+="1"}break;case" ":s+="3";break;default:s+="2"}}}Brd[Turn]=s;Rul()}
function Rdr(turn){if(turn>=0&&Brd[turn]!=""){var s=0;for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){var sym="",frc="black";switch(Mid(Brd[turn],s,1)){case"0":sym="O";break;case"1":sym="X";break;case"3":sym=" ";break;case"4":sym="O";frc="blue";break;case"5":sym="X";frc="blue"}Controls(Chr(cd1)+cd2).innerHTML=sym;Controls(Chr(cd1)+cd2).style.color=frc;s++;Turn=turn}}}Rul()}
function RdB(){var n=0,ck=0;if(RBs>27)RBs=27;while(n<RBs){var cd1=Val(Rnd()*9+65),cd2=Val(Rnd()*9+1),crd=Chr(cd1)+cd2;if(Controls(crd).innerHTML==""&&Val(cd1+cd2)%2==0){Controls(crd).style.backgroundColor="dimgray";Controls(crd).innerHTML=" ";n++}ck++;if(ck>81)break}}