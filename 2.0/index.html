<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=0.9, user-scalable=no, minimum-scale=0.9, maximum-scale=0.9" /> <meta name="mobile-web-app-capable" content="yes" />
<title>Square.Connect</title>
<link href="https://upload.wikimedia.org/wikipedia/commons/2/20/Square.Connect.png" rel="shortcut icon" type="image/x-icon" >
<link href="https://upload.wikimedia.org/wikipedia/commons/2/20/Square.Connect.png" rel="icon" type="image/x-icon" >
<style type="text/css">
body {-moz-user-select : none;-webkit-user-select: none;margin: 0px;}
.bod ,.cmd , .cnd{background-color: white;color: black}
.Val{border:medium none ;background-color:lightgray;width:15px;}
.lst:hover{background-color: gray;color: black;}
.bod:hover{opacity:0.5}
@media screen and (min-width:1000px) , screen and (min-width:768px) and (max-width:1000px) {
.bod ,.cmd , .cnd{height: 80px;font-size: 60px;border: 2px black solid}
.bod{width: 80px}.cmd{width: 720px}.cnd{width: 360px}.rr{height:35px}
}
@media screen and (max-width:768px) , screen and (max-device-width:480px) {
.bod ,.cmd , .cnd{height: 40px;font-size: 30px;border: 1px black solid}
.bod{width: 40px}.cmd{width: 360px}.cnd{width: 180px}.rr{height:90px}
}
</style>
<script>
var Turn=1,P="",Q="",O="O",X="X",Chs="",OArea=0,XArea=0,Board=new Array(),SetCrd=new Array(),LM=new Array(),SplSym=""
var TurnStart=5,TurnEnd=40,TurnCount=0,TimeCount=0,TotalScore=0,r1=0,r2=0,SymCheck=0,ConCheck=0,Axf=0,Drg=0,DAct=10,TAct=8
function ChessMode(Crd){
var crd1=Crd.charCodeAt(Crd.substr(0,1)),crd2=parseInt(Crd.substr(1,1)),OAra=0,XAra=0,OLdr=0,XLdr=0
var Cmd=coor("OFD").value,typ="",move="gainsboro"
if(coor(Crd).style.color=="red")typ="a";if(coor(Crd).style.color=="orange")typ="b"
if(coor(Crd).style.color=="gold")typ="c";if(coor(Crd).style.color=="seagreen")typ="d"
if(coor(Crd).style.color=="blue")typ="e";if(coor(Crd).style.color=="purple")typ="f"
if(coor(Crd).style.color=="deeppink")typ="g";if(coor(Crd).style.color=="slateblue")typ="h"
if(coor(Crd).style.color=="brown")typ="i"
if(coor(Crd).style.backgroundColor==move){
for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){
	if(coor(Chr(cd1)+cd2).style.backgroundColor=="gray"){
		coor(Crd).style.color=coor(Chr(cd1)+cd2).style.color
		coor(Crd).value=coor(Chr(cd1)+cd2).value
		ItemSet("black","white","",Chr(cd1)+cd2);Turn++;CharaterRule()
	}else{coor(Chr(cd1)+cd2).style.backgroundColor="white"}
}}
for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){
	coor(Chr(cd1)+cd2).style.backgroundColor="white"
}}
}else{
	for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){
		coor(Chr(cd1)+cd2).style.backgroundColor="white"
		if(coor(Chr(cd1)+cd2).value==O){OAra++;if(coor(Chr(cd1)+cd2).style.color=="brown")OLdr++}
		if(coor(Chr(cd1)+cd2).value==X){XAra++;if(coor(Chr(cd1)+cd2).style.color=="brown")XLdr++}
	}}
	if(OAra==0)Winner("O方已無生還者");if(XAra==0)Winner("X方已無生還者")
	if(Cmd.search("Rul.Chs.Ldr")>=0){if(OLdr==0)Winner("O方領導已死亡");if(XLdr==0)Winner("X方領導已死亡")}
	if(coor(Crd).value==Q){
		if(typ!=""){
			for(tp=0;tp<9;tp++){
				var md="";
				if(tp==0)md=" ";if(tp==1)md=".f";if(tp==2)md=".k";if(tp==3)md=".l";if(tp==4)md=".j";if(tp==5)md=".s";if(tp==6)md=".s.l"
				if(Cmd.search(typ+".8"+md)>=0)Cmd=Cmd+typ+".4"+md+typ+".YX"+md
				if(Cmd.search(typ+".4"+md)>=0)Cmd=Cmd+typ+".X"+md+typ+".Y"+md
				if(Cmd.search(typ+".X"+md)>=0)Cmd=Cmd+typ+".R"+md+typ+".L"+md
				if(Cmd.search(typ+".Y"+md)>=0)Cmd=Cmd+typ+".F"+md+typ+".B"+md
				if(Cmd.search(typ+".YX"+md)>=0)Cmd=Cmd+typ+".FX"+md+typ+".BX"+md
				if(Cmd.search(typ+".FX"+md)>=0)Cmd=Cmd+typ+".FR"+md+typ+".FL"+md
				if(Cmd.search(typ+".BX"+md)>=0)Cmd=Cmd+typ+".BR"+md+typ+".BL"+md
				if(Cmd.search(typ+".YR"+md)>=0)Cmd=Cmd+typ+".FR"+md+typ+".BR"+md
				if(Cmd.search(typ+".YL"+md)>=0)Cmd=Cmd+typ+".FL"+md+typ+".BL"+md
				if(Cmd.search(typ+".8n"+md)>=0)Cmd=Cmd+typ+".YXX"+md+typ+".YYX"+md
				if(Cmd.search(typ+".YXX"+md)>=0)Cmd=Cmd+typ+".FXX"+md+typ+".BXX"+md
				if(Cmd.search(typ+".FXX"+md)>=0)Cmd=Cmd+typ+".FRR"+md+typ+".FLL"+md
				if(Cmd.search(typ+".BXX"+md)>=0)Cmd=Cmd+typ+".BRR"+md+typ+".BLL"+md
				if(Cmd.search(typ+".YRR"+md)>=0)Cmd=Cmd+typ+".FRR"+md+typ+".BRR"+md
				if(Cmd.search(typ+".YLL"+md)>=0)Cmd=Cmd+typ+".FLL"+md+typ+".BLL"+md
				if(Cmd.search(typ+".YYX"+md)>=0)Cmd=Cmd+typ+".FFX"+md+typ+".BBX"+md
				if(Cmd.search(typ+".FFX"+md)>=0)Cmd=Cmd+typ+".FFR"+md+typ+".FFL"+md
				if(Cmd.search(typ+".BBX"+md)>=0)Cmd=Cmd+typ+".BBR"+md+typ+".BBL"+md
				if(Cmd.search(typ+".YYR"+md)>=0)Cmd=Cmd+typ+".FFR"+md+typ+".BBR"+md
				if(Cmd.search(typ+".YYL"+md)>=0)Cmd=Cmd+typ+".FFL"+md+typ+".BBL"+md
				if(Cmd.search(typ+".28"+md)>=0)Cmd=Cmd+typ+".24"+md+typ+".2YX"+md
				if(Cmd.search(typ+".24"+md)>=0)Cmd=Cmd+typ+".2X"+md+typ+".2Y"+md
				if(Cmd.search(typ+".2X"+md)>=0)Cmd=Cmd+typ+".2R"+md+typ+".2L"+md
				if(Cmd.search(typ+".2Y"+md)>=0)Cmd=Cmd+typ+".2F"+md+typ+".2B"+md
				if(Cmd.search(typ+".2YX"+md)>=0)Cmd=Cmd+typ+".2FX"+md+typ+".2BX"+md
				if(Cmd.search(typ+".2FX"+md)>=0)Cmd=Cmd+typ+".2FR"+md+typ+".2FL"+md
				if(Cmd.search(typ+".2BX"+md)>=0)Cmd=Cmd+typ+".2BR"+md+typ+".2BL"+md
				if(Cmd.search(typ+".2YR"+md)>=0)Cmd=Cmd+typ+".2FR"+md+typ+".2BR"+md
				if(Cmd.search(typ+".2YL"+md)>=0)Cmd=Cmd+typ+".2FL"+md+typ+".2BL"+md
			}
			var sym;if(Q==O)sym="0";if(Q==X)sym="1"
			if(Cmd.search(typ+".F")>=0&&coor(Chr(crd1)+(crd2-1))){
				if(Cmd.search(typ+".F ")>=0)coor(Chr(crd1)+(crd2-1)).style.backgroundColor=move
				if(Cmd.search(typ+".F.k")>=0&&coor(Chr(crd1)+(crd2-1)).value!=""){coor(Chr(crd1)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".F.f")>=0){coor(Chr(crd1)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(typ+".F.l")>=0&&coor(Chr(crd1)+(crd2-1)).value==""){coor(Chr(crd1)+(crd2-1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".B")>=0&&coor(Chr(crd1)+(crd2+1))){
				if(Cmd.search(typ+".B ")>=0)coor(Chr(crd1)+(crd2+1)).style.backgroundColor=move
				if(Cmd.search(typ+".B.k")>=0&&coor(Chr(crd1)+(crd2+1)).value!=""){coor(Chr(crd1)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".B.f")>=0){coor(Chr(crd1)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(typ+".B.l")>=0&&coor(Chr(crd1)+(crd2-1)).value==""){coor(Chr(crd1)+(crd2+1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".L")>=0&&coor(Chr(crd1-1)+crd2)){
				if(Cmd.search(typ+".L ")>=0)coor(Chr(crd1-1)+crd2).style.backgroundColor=move
				if(Cmd.search(typ+".L.k")>=0&&coor(Chr(crd1-1)+crd2).value!=""){coor(Chr(crd1-1)+crd2).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".L.f")>=0){coor(Chr(crd1-1)+crd2).style.backgroundColor=move}
				if(Cmd.search(typ+".L.l")>=0&&coor(Chr(crd1-1)+crd2).value==""){coor(Chr(crd1-1)+crd2).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".R")>=0&&coor(Chr(crd1+1)+crd2)){
				if(Cmd.search(typ+".R ")>=0)coor(Chr(crd1+1)+crd2).style.backgroundColor=move
				if(Cmd.search(typ+".R.k")>=0&&coor(Chr(crd1+1)+crd2).value!=""){coor(Chr(crd1+1)+crd2).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".R.f")>=0){coor(Chr(crd1+1)+crd2).style.backgroundColor=move}
				if(Cmd.search(typ+".R.l")>=0&&coor(Chr(crd1+1)+crd2).value==""){coor(Chr(crd1+1)+crd2).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".FR")>=0&&coor(Chr(crd1+1)+(crd2-1))){
				if(Cmd.search(typ+".FR ")>=0)coor(Chr(crd1+1)+(crd2-1)).style.backgroundColor=move
				if(Cmd.search(typ+".FR.k")>=0&&coor(Chr(crd1+1)+(crd2-1)).value!=""){coor(Chr(crd1+1)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".FR.f")>=0){coor(Chr(crd1+1)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(typ+".FR.l")>=0&&coor(Chr(crd1+1)+(crd2-1)).value==""){coor(Chr(crd1+1)+(crd2-1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".FL")>=0&&coor(Chr(crd1-1)+(crd2-1))){
				if(Cmd.search(typ+".FL ")>=0)coor(Chr(crd1-1)+(crd2-1)).style.backgroundColor=move
				if(Cmd.search(typ+".FL.k")>=0&&coor(Chr(crd1-1)+(crd2-1)).value!=""){coor(Chr(crd1-1)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".FL.f")>=0){coor(Chr(crd1-1)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(typ+".FL.l")>=0&&coor(Chr(crd1-1)+(crd2-1)).value==""){coor(Chr(crd1-1)+(crd2-1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".BR"&&coor(Chr(crd1+1)+(crd2+1)))>=0){
				if(Cmd.search(typ+".BR ")>=0)coor(Chr(crd1+1)+(crd2+1)).style.backgroundColor=move
				if(Cmd.search(typ+".BR.k")>=0&&coor(Chr(crd1+1)+(crd2+1)).value!=""){coor(Chr(crd1+1)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".BR.f")>=0){coor(Chr(crd1+1)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(typ+".BR.l")>=0&&coor(Chr(crd1+1)+(crd2+1)).value==""){coor(Chr(crd1+1)+(crd2+1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".BL")>=0&&coor(Chr(crd1-1)+(crd2+1))){
				if(Cmd.search(typ+".BL ")>=0)coor(Chr(crd1-1)+(crd2+1)).style.backgroundColor=move
				if(Cmd.search(typ+".BL.k")>=0&&coor(Chr(crd1-1)+(crd2+1)).value!=""){coor(Chr(crd1-1)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".BL.f")>=0){coor(Chr(crd1-1)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(typ+".BL.l")>=0&&coor(Chr(crd1-1)+(crd2+1)).value==""){coor(Chr(crd1-1)+(crd2+1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".2F")>=0&&coor(Chr(crd1)+(crd2-2))){
				if(Cmd.search(typ+".2F ")>=0)coor(Chr(crd1)+(crd2-2)).style.backgroundColor=move
				if(Cmd.search(typ+".2F.k")>=0&&coor(Chr(crd1)+(crd2-2)).value!=""){coor(Chr(crd1)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".2F.f")>=0){coor(Chr(crd1)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(typ+".2F.l")>=0&&coor(Chr(crd1)+(crd2-2)).value==""){coor(Chr(crd1)+(crd2-2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".2B")>=0&&coor(Chr(crd1)+(crd2+2))){
				if(Cmd.search(typ+".2B ")>=0)coor(Chr(crd1)+(crd2+2)).style.backgroundColor=move
				if(Cmd.search(typ+".2B.k")>=0&&coor(Chr(crd1)+(crd2+2)).value!=""){coor(Chr(crd1)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".2B.f")>=0){coor(Chr(crd1)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(typ+".2B.l")>=0&&coor(Chr(crd1)+(crd2-2)).value==""){coor(Chr(crd1)+(crd2+2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".2L")>=0&&coor(Chr(crd1-2)+crd2)){
				if(Cmd.search(typ+".2L ")>=0)coor(Chr(crd1-2)+crd2).style.backgroundColor=move
				if(Cmd.search(typ+".2L.k")>=0&&coor(Chr(crd1-2)+crd2).value!=""){coor(Chr(crd1-2)+crd2).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".2L.f")>=0){coor(Chr(crd1-2)+crd2).style.backgroundColor=move}
				if(Cmd.search(typ+".2L.l")>=0&&coor(Chr(crd1-2)+crd2).value==""){coor(Chr(crd1-2)+crd2).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".2R")>=0&&coor(Chr(crd1+2)+crd2)){
				if(Cmd.search(typ+".2R ")>=0)coor(Chr(crd1+2)+crd2).style.backgroundColor=move
				if(Cmd.search(typ+".2R.k")>=0&&coor(Chr(crd1+2)+crd2).value!=""){coor(Chr(crd1+2)+crd2).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".2R.f")>=0){coor(Chr(crd1+2)+crd2).style.backgroundColor=move}
				if(Cmd.search(typ+".2R.l")>=0&&coor(Chr(crd1+2)+crd2).value==""){coor(Chr(crd1+2)+crd2).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".2FR")>=0&&coor(Chr(crd1+2)+(crd2-2))){
				if(Cmd.search(typ+".2FR ")>=0)coor(Chr(crd1+2)+(crd2-2)).style.backgroundColor=move
				if(Cmd.search(typ+".2FR.k")>=0&&coor(Chr(crd1+2)+(crd2-2)).value!=""){coor(Chr(crd1+2)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".2FR.f")>=0){coor(Chr(crd1+2)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(typ+".2FR.l")>=0&&coor(Chr(crd1+2)+(crd2-2)).value==""){coor(Chr(crd1+2)+(crd2-2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".2FL")>=0&&coor(Chr(crd1-2)+(crd2-2))){
				if(Cmd.search(typ+".2FL ")>=0)coor(Chr(crd1-2)+(crd2-2)).style.backgroundColor=move
				if(Cmd.search(typ+".2FL.k")>=0&&coor(Chr(crd1-2)+(crd2-2)).value!=""){coor(Chr(crd1-2)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".2FL.f")>=0){coor(Chr(crd1-2)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(typ+".2FL.l")>=0&&coor(Chr(crd1-2)+(crd2-2)).value==""){coor(Chr(crd1-2)+(crd2-2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".2BR")>=0&&coor(Chr(crd1+2)+(crd2+2))){
				if(Cmd.search(typ+".2BR ")>=0)coor(Chr(crd1+2)+(crd2+2)).style.backgroundColor=move
				if(Cmd.search(typ+".2BR.k")>=0&&coor(Chr(crd1+2)+(crd2+2)).value!=""){coor(Chr(crd1+2)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".2BR.f")>=0){coor(Chr(crd1+2)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(typ+".2BR.l")>=0&&coor(Chr(crd1+2)+(crd2+2)).value==""){coor(Chr(crd1+2)+(crd2+2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".2BL")>=0&&coor(Chr(crd1-2)+(crd2+2))){
				if(Cmd.search(typ+".2BL ")>=0)coor(Chr(crd1-2)+(crd2+2)).style.backgroundColor=move
				if(Cmd.search(typ+".2BL.k")>=0&&coor(Chr(crd1-2)+(crd2+2)).value!=""){coor(Chr(crd1-2)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".2BL.f")>=0){coor(Chr(crd1-2)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(typ+".2BL.l")>=0&&coor(Chr(crd1-2)+(crd2+2)).value==""){coor(Chr(crd1-2)+(crd2+2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".FFR")>=0&&coor(Chr(crd1+1)+(crd2-2))){
				if(Cmd.search(typ+".FFR ")>=0)coor(Chr(crd1+1)+(crd2-2)).style.backgroundColor=move
				if(Cmd.search(typ+".FFR.k")>=0&&coor(Chr(crd1+1)+(crd2-2)).value!=""){coor(Chr(crd1+1)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".FFR.f")>=0){coor(Chr(crd1+1)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(typ+".FFR.l")>=0&&coor(Chr(crd1+1)+(crd2-2)).value==""){coor(Chr(crd1+1)+(crd2-2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".FFL")>=0&&coor(Chr(crd1-1)+(crd2-2))){
				if(Cmd.search(typ+".FFL ")>=0)coor(Chr(crd1-1)+(crd2-2)).style.backgroundColor=move
				if(Cmd.search(typ+".FFL.k")>=0&&coor(Chr(crd1-1)+(crd2-2)).value!=""){coor(Chr(crd1-1)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".FFL.f")>=0){coor(Chr(crd1-1)+(crd2-2)).style.backgroundColor=move}
				if(Cmd.search(typ+".FFL.l")>=0&&coor(Chr(crd1-1)+(crd2-2)).value==""){coor(Chr(crd1-1)+(crd2-2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".BBR")>=0&&coor(Chr(crd1+1)+(crd2+2))){
				if(Cmd.search(typ+".BBR ")>=0)coor(Chr(crd1+1)+(crd2+2)).style.backgroundColor=move
				if(Cmd.search(typ+".BBR.k")>=0&&coor(Chr(crd1+1)+(crd2+2)).value!=""){coor(Chr(crd1+1)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".BBR.f")>=0){coor(Chr(crd1+1)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(typ+".BBR.l")>=0&&coor(Chr(crd1+1)+(crd2+2)).value==""){coor(Chr(crd1+1)+(crd2+2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".BBL")>=0&&coor(Chr(crd1-1)+(crd2+2))){
				if(Cmd.search(typ+".BBL ")>=0)coor(Chr(crd1-1)+(crd2+2)).style.backgroundColor=move
				if(Cmd.search(typ+".BBL.k")>=0&&coor(Chr(crd1-1)+(crd2+2)).value!=""){coor(Chr(crd1-1)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".BBL.f")>=0){coor(Chr(crd1-1)+(crd2+2)).style.backgroundColor=move}
				if(Cmd.search(typ+".BBL.l")>=0&&coor(Chr(crd1-1)+(crd2+2)).value==""){coor(Chr(crd1-1)+(crd2+2)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".FRR")>=0&&coor(Chr(crd1+2)+(crd2-1))){
				if(Cmd.search(typ+".FRR ")>=0)coor(Chr(crd1+2)+(crd2-1)).style.backgroundColor=move
				if(Cmd.search(typ+".FRR.k")>=0&&coor(Chr(crd1+2)+(crd2-1)).value!=""){coor(Chr(crd1+2)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".FRR.f")>=0){coor(Chr(crd1+2)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(typ+".FRR.l")>=0&&coor(Chr(crd1+2)+(crd2-1)).value==""){coor(Chr(crd1+2)+(crd2-1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".FLL")>=0&&coor(Chr(crd1-2)+(crd2-1))){
				if(Cmd.search(typ+".FLL ")>=0)coor(Chr(crd1-2)+(crd2-1)).style.backgroundColor=move
				if(Cmd.search(typ+".FLL.k")>=0&&coor(Chr(crd1-2)+(crd2-1)).value!=""){coor(Chr(crd1-2)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".FLL.f")>=0){coor(Chr(crd1-2)+(crd2-1)).style.backgroundColor=move}
				if(Cmd.search(typ+".FLL.l")>=0&&coor(Chr(crd1-2)+(crd2-1)).value==""){coor(Chr(crd1-2)+(crd2-1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".BRR")>=0&&coor(Chr(crd1+2)+(crd2+1))){
				if(Cmd.search(typ+".BRR ")>=0)coor(Chr(crd1+2)+(crd2+1)).style.backgroundColor=move
				if(Cmd.search(typ+".BRR.k")>=0&&coor(Chr(crd1+2)+(crd2+1)).value!=""){coor(Chr(crd1+2)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".BRR.f")>=0){coor(Chr(crd1+2)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(typ+".BRR.l")>=0&&coor(Chr(crd1+2)+(crd2+1)).value==""){coor(Chr(crd1+2)+(crd2+1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".BLL")>=0&&coor(Chr(crd1-2)+(crd2+1))){
				if(Cmd.search(typ+".BLL ")>=0)coor(Chr(crd1-2)+(crd2+1)).style.backgroundColor=move
				if(Cmd.search(typ+".BLL.k")>=0&&coor(Chr(crd1-2)+(crd2+1)).value!=""){coor(Chr(crd1-2)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(crd1+""+crd2+sym+typ+".BLL.f")>=0){coor(Chr(crd1-2)+(crd2+1)).style.backgroundColor=move}
				if(Cmd.search(typ+".BLL.l")>=0&&coor(Chr(crd1-2)+(crd2+1)).value==""){coor(Chr(crd1-2)+(crd2+1)).style.backgroundColor=move}
			}
			if(Cmd.search(typ+".F.s")>=0){
				for(c=1;c<10;c++){if(coor(Chr(crd1)+(crd2-c))&&coor(Chr(crd1)+(crd2-c)).value==""){
						coor(Chr(crd1)+(crd2-c)).style.backgroundColor=move
					}else{
						if(Cmd.search(typ+".F.s.l")<0){coor(Chr(crd1)+(crd2-c)).style.backgroundColor=move}break;
				}}
			}
			if(Cmd.search(typ+".B.s")>=0){
				for(c=1;c<10;c++){if(coor(Chr(crd1)+(crd2+c))&&coor(Chr(crd1)+(crd2+c)).value==""){
						coor(Chr(crd1)+(crd2+c)).style.backgroundColor=move
					}else{
						if(Cmd.search(typ+".B.s.l")<0){coor(Chr(crd1)+(crd2+c)).style.backgroundColor=move}break;
				}}
			}
			if(Cmd.search(typ+".L.s")>=0){
				for(c=1;c<10;c++){if(coor(Chr(crd1-c)+crd2)&&coor(Chr(crd1-c)+crd2).value==""){
						coor(Chr(crd1-c)+crd2).style.backgroundColor=move
					}else{
						if(Cmd.search(typ+".L.s.l")<0){coor(Chr(crd1-c)+crd2).style.backgroundColor=move}break;
				}}
			}
			if(Cmd.search(typ+".R.s")>=0){
				for(c=1;c<10;c++){if(coor(Chr(crd1+c)+crd2)&&coor(Chr(crd1+c)+crd2).value==""){
						coor(Chr(crd1+c)+crd2).style.backgroundColor=move
					}else{
						if(Cmd.search(typ+".R.s.l")<0){coor(Chr(crd1+c)+crd2).style.backgroundColor=move}break;
				}}
			}
			if(Cmd.search(typ+".FR.s")>=0){
				for(c=1;c<10;c++){if(coor(Chr(crd1+c)+(crd2-c))&&coor(Chr(crd1+c)+(crd2-c)).value==""){
						coor(Chr(crd1+c)+(crd2-c)).style.backgroundColor=move
					}else{
						if(Cmd.search(typ+".FR.s.l")<0){coor(Chr(crd1+c)+(crd2-c)).style.backgroundColor=move}break;
				}}
			}
			if(Cmd.search(typ+".FL.s")>=0){
				for(c=1;c<10;c++){if(coor(Chr(crd1-c)+(crd2-c))&&coor(Chr(crd1-c)+(crd2-c)).value==""){
						coor(Chr(crd1-c)+(crd2-c)).style.backgroundColor=move
					}else{
						if(Cmd.search(typ+".FL.s.l")<0){coor(Chr(crd1-c)+(crd2-c)).style.backgroundColor=move}break;
				}}
			}
			if(Cmd.search(typ+".BR.s")>=0){
				for(c=1;c<10;c++){if(coor(Chr(crd1+c)+(crd2+c))&&coor(Chr(crd1+c)+(crd2+c)).value==""){
						coor(Chr(crd1+c)+(crd2+c)).style.backgroundColor=move
					}else{
						if(Cmd.search(typ+".BR.s.l")<0){coor(Chr(crd1+c)+(crd2+c)).style.backgroundColor=move}break;
				}}
			}
			if(Cmd.search(typ+".BL.s")>=0){
				for(c=1;c<10;c++){if(coor(Chr(crd1-c)+(crd2+c))&&coor(Chr(crd1-c)+(crd2+c)).value==""){
						coor(Chr(crd1-c)+(crd2+c)).style.backgroundColor=move
					}else{
						if(Cmd.search(typ+".BL.s.l")<0){coor(Chr(crd1-c)+(crd2+c)).style.backgroundColor=move}break;
				}}
			}
			if(Cmd.search(typ+".F.j")>=0){var ck=0
				for(c=1;c<10;c++){if(coor(Chr(crd1)+(crd2-c))&&coor(Chr(crd1)+(crd2-c)).value!=""){
						if(ck==1){coor(Chr(crd1)+(crd2-c)).style.backgroundColor=move;break}else{ck++}
				}}
			}
			if(Cmd.search(typ+".B.j")>=0){var ck=0
				for(c=1;c<10;c++){if(coor(Chr(crd1)+(crd2+c))&&coor(Chr(crd1)+(crd2+c)).value!=""){
					if(ck==1){coor(Chr(crd1)+(crd2+c)).style.backgroundColor=move;break}else{ck++}
				}}
			}
			if(Cmd.search(typ+".R.j")>=0){var ck=0
				for(c=1;c<10;c++){if(coor(Chr(crd1+c)+crd2)&&coor(Chr(crd1+c)+crd2).value!=""){
					if(ck==1){coor(Chr(crd1+c)+crd2).style.backgroundColor=move;break}else{ck++}
				}}
			}
			if(Cmd.search(typ+".L.j")>=0){var ck=0
				for(c=1;c<10;c++){if(coor(Chr(crd1-c)+crd2)&&coor(Chr(crd1-c)+crd2).value!=""){
					if(ck==1){coor(Chr(crd1-c)+crd2).style.backgroundColor=move;break}else{ck++}
				}}
			}
			if(Cmd.search(typ+".FR.j")>=0){var ck=0
				for(c=1;c<10;c++){if(coor(Chr(crd1+c)+(crd2-c))&&coor(Chr(crd1+c)+(crd2-c)).value!=""){
					if(ck==1){coor(Chr(crd1+c)+(crd2-c)).style.backgroundColor=move;break}else{ck++}
				}}
			}
			if(Cmd.search(typ+".FL.j")>=0){var ck=0
				for(c=1;c<10;c++){if(coor(Chr(crd1-c)+(crd2-c))&&coor(Chr(crd1-c)+(crd2-c)).value!=""){
					if(ck==1){coor(Chr(crd1-c)+(crd2-c)).style.backgroundColor=move;break}else{ck++}
				}}
			}
			if(Cmd.search(typ+".BR.j")>=0){var ck=0
				for(c=1;c<10;c++){if(coor(Chr(crd1+c)+(crd2+c))&&coor(Chr(crd1+c)+(crd2+c)).value!=""){
					if(ck==1){coor(Chr(crd1+c)+(crd2+c)).style.backgroundColor=move;break}else{ck++}
				}}
			}
			if(Cmd.search(typ+".BL.j")>=0){var ck=0
				for(c=1;c<10;c++){if(coor(Chr(crd1-c)+(crd2+c))&&coor(Chr(crd1-c)+(crd2+c)).value!=""){
					if(ck==1){coor(Chr(crd1-c)+(crd2+c)).style.backgroundColor=move;break}else{ck++}
				}}
			}
		}
		coor(Crd).style.backgroundColor="gray"
	}
}
}//棋盤組件
function SetSym(Crd){
var Cmd=coor('OFD').value,ScoreO=0,ScoreX=0,SymO=0,SymX=0
coor('OFD').type="Hidden"
document.all.Weapon.style.display='none'
if(Cmd.search("Rul.Wpn")>=0){if(coor(Crd).value!=""&&SetCrd[Turn-1]==Crd&&Turn>2)document.all.Weapon.style.display='inline'}
if(coor(Crd).value=="Y"){Random(9,65,9,1);ItemSet("darkgray","gray","Guris",r1+r2)}
if(Turn%2==0){Q=X}else{Q=O}
if(Cmd.search("Rul.Chs")>=0){
	ChessMode(Crd)
}else{
for(cd1=65;cd1<74;cd1++){
    for(cd2=1;cd2<10;cd2++){
		if(coor(Chr(cd1)+cd2).value==O)SymO++
		if(coor(Chr(cd1)+cd2).value==X)SymX++
	}
}
if(SymO==0||SymX==0){
	if(Turn<3){
		P=""
		switch(Cmd.search){
		    case ("Sym.Ara.D")>=0:alert('ck')
		}
		if(Cmd.search("Sym.Ara.D")>=0)if(Turn%2==0){CircleAra("K",Crd)}else{CircleAra("D",Crd)}
		if(Cmd.search("Sym.Ara.U")>=0)if(Turn%2==0){CircleAra("D",Crd)}else{CircleAra("U",Crd)}
		if(Cmd.search("Sym.Ara.Q")>=0)if(Turn%2==0){CircleAra("H",Crd)}else{CircleAra("Q",Crd)}
		if(Cmd.search("Sym.Ara.F")>=0)ItemSet("black","seagreen",coor(Crd).value, Crd)
		if(Cmd.search("Sym.Ara.O")>=0)ItemSet("black","cyan",coor(Crd).value, Crd)
	}
}else{
		if(Cmd.search("Cnt.non")>=0){P=""}else{P=Q}
		if(Cmd.search("Sym.Ara.P")>=0){
			var c1=SetCrd[1].substr(0,1)
            var c2=SetCrd[1].substr(1,1)
            var d1=SetCrd[2].substr(0,1)
            var d2=SetCrd[2].substr(1,1)
            if(Turn>1){
                 coor(c1+d2).style.backgroundColor="lightgray"
                 coor(d1+c2).style.backgroundColor="lightgray"
			}
		}
}
var crd1= Crd.charCodeAt(Crd.substr(0,1))     ,crd2=parseInt(Crd.substr(1,1))            ,
	F   = Chr(crd1)+(crd2-1)  ,B   = Chr(crd1)+(crd2+1)  ,
    R   = Chr(crd1+1)+(crd2)  ,L   = Chr(crd1-1)+(crd2)  ,
    FF  = Chr(crd1)+(crd2-2)  ,BB  = Chr(crd1)+(crd2+2)  ,
    RR  = Chr(crd1+2)+(crd2)  ,LL  = Chr(crd1-2)+(crd2)  ,
    FR  = Chr(crd1+1)+(crd2-1),FL  = Chr(crd1-1)+(crd2-1),
    BR  = Chr(crd1+1)+(crd2+1),BL  = Chr(crd1-1)+(crd2+1),
    FFR = Chr(crd1+1)+(crd2-2),FFL = Chr(crd1-1)+(crd2-2),
    BBR = Chr(crd1+1)+(crd2+2),BBL = Chr(crd1-1)+(crd2+2),
    FRR = Chr(crd1+2)+(crd2-1),FLL = Chr(crd1-2)+(crd2-1),
    BRR = Chr(crd1+2)+(crd2+1),BLL = Chr(crd1-2)+(crd2+1),
    FFRR= Chr(crd1+2)+(crd2-2),FFLL= Chr(crd1-2)+(crd2-2),
    BBRR= Chr(crd1+2)+(crd2+2),BBLL= Chr(crd1-2)+(crd2+2)
Connect(F,F,F,Crd);Connect(B,B,B,Crd);Connect(R,R,R,Crd);Connect(L,L,L,Crd)
Connect(FR,FR,FR,Crd);Connect(FL,FL,FL,Crd);Connect(BR,BR,BR,Crd);Connect(BL,BL,BL,Crd)
if(Cmd.search("Cnt.rmt")>=0){
Connect(FF,F,F,Crd);Connect(BB,B,B,Crd);Connect(LL,L,L,Crd);Connect(RR,R,R,Crd)
Connect(FFRR,FR,FR,Crd);Connect(BBLL,BL,BL,Crd);Connect(FFLL,FL,FL,Crd);Connect(BBRR,BR,BR,Crd)
}
if(Cmd.search("Cnt.abn")>=0){
Connect(BBL,BL,L,Crd);Connect(BBL,B,BL,Crd);Connect(BBL,B,BB,Crd);Connect(FFL,FL,L,Crd);Connect(FFL,F,FL,Crd);Connect(FFL,F,FF,Crd)
Connect(BBR,BR,R,Crd);Connect(BBR,B,BR,Crd);Connect(BBR,B,BB,Crd);Connect(FFR,FR,R,Crd);Connect(FFR,F,FR,Crd);Connect(FFR,F,FF,Crd)
Connect(FRR,FR,F,Crd);Connect(FRR,RR,R,Crd);Connect(FRR,FR,R,Crd);Connect(BRR,BR,B,Crd);Connect(BRR,RR,R,Crd);Connect(BRR,BR,R,Crd)
Connect(FLL,FL,F,Crd);Connect(FLL,LL,L,Crd);Connect(FLL,FL,L,Crd);Connect(BLL,BL,B,Crd);Connect(BLL,LL,L,Crd);Connect(BLL,BL,L,Crd)
}
if(SymCheck==0){
	if(coor(Crd).value=="")alert(Crd+"，未產生連線")
}else{
	Turn++;SymCheck=0;CharaterRule()
	if(Cmd.search("Sym.Ara.E")>=0)if(Turn%2==0){CircleAra("E",Crd)}else{CircleAra("T",Crd)}
};AreaRule();ShapeRule();BasicRule()
for(cd1=65;cd1<74;cd1++){
	for(cd2=1;cd2<10;cd2++){
		if(coor(Chr(cd1)+cd2).value=="O ")ScoreX++
		if(coor(Chr(cd1)+cd2).value=="X ")ScoreO++
		if(coor(Chr(cd1)+cd2).value==")|("&&Axf==0)Axf=1
		if(coor(Chr(cd1)+cd2).value=="δ"&&Drg==0)Drg=1
		if(Axf>=3){
			if(coor(Chr(cd1)+cd2).value==")|("&&coor(Chr(cd1)+cd2).style.color=="black"){
				coor(Chr(cd1)+cd2).style.color="maroon";Axf=0
				for(cr1=cd1-1;cr1<cd1+2;cr1++){for(cr2=cd2-1;cr2<cd2+2;cr2++){
					if(coor(Chr(cr1)+cr2).value!=""){coor(Chr(cr1)+cr2).style.color="maroon";coor(Chr(cr1)+cr2).value=coor(Chr(cr1)+cr2).value+" "}
				}}
			}
		}
		if(Drg>=3){
			if(coor(Chr(cd1)+cd2).value=="δ")coor(Chr(cd1)+cd2).style.color="maroon"
			if(coor(Chr(cd1)+cd2).style.color=="dodgerblue"){coor(Chr(cd1)+cd2).style.color="green"}if(Chr(cd1)+cd2=="I9")Drg=0
		}
	}
}
if(Axf>0)Axf++;if(Drg>0)Drg++
if(Cmd.search("Rul.Bld")>=0){
if(TotalScore!=0){
	if(TotalScore==ScoreX)Winner("X得分較高，X獲勝")
	if(TotalScore==ScoreO)Winner("O得分較高，O獲勝")
}else{
	if(ScoreO>ScoreX+1)Winner("O得分較高，O獲勝")
	if(ScoreX>ScoreO+1)Winner("X得分較高，X獲勝")
}
}
if(Cmd.search("Rul.Ldr")>=0&&Turn>4){
	if(coor(SetCrd[1])){
		if(coor(SetCrd[1]).value!=O){
		Winner("O領導死亡，X獲勝")
		}else{
		if(coor(SetCrd[2]))if(coor(SetCrd[2]).value!=X)Winner("X領導死亡，O獲勝")
		}
	}
}
};Writer();coor('Undo').value="Undo("+(Turn-1)+")";if(Turn>4){ConnectCheck()};LMRule()
}//載入座標與連線
function LMRule(){
var Cmd=coor("OFD").value
	for(c=1;c<10;c++){
		if(LM[c]&&coor(LM[c]).value!=""&&Cmd.search("Rul.Min")>=0){
			CircleCrt("black","dimgray"," ",LM[c])
		}
	}
}//地雷規則
function Connect(crd1,crd2,crd3,Crd){
if(coor(crd1)&&coor(crd2)&&coor(crd3)){
	if(coor(crd1).value==P||coor(crd1).value=="K"){
		if(coor(Crd).value==""){
			if(coor(crd2).value==""||coor(crd2).value.search(P)>=0||coor(crd1).value=="K"){
				if(coor(crd3).value==""||coor(crd3).value.search(P)>=0||coor(crd1).value=="K"){
					coor(Crd).value=Q;SetCrd[Turn]=Crd;SymCheck=1
				}
			}
		}
	}
	if(coor(crd1).value.search(P)>=0&&coor(crd1).style.color=="teal"){
		coor(crd1).value=P;coor(crd1).style.color="black"
	}
}
}//連線判別
function ConnectCheck(){
var Cmd=coor("OFD").value
	for(crd1=65;crd1<74;crd1++){
		for(crd2=1;crd2<10;crd2++){ConCheck=0
			var Crd = Chr(crd1)+(crd2)    ,
			    F   = Chr(crd1)+(crd2-1)  ,B   = Chr(crd1)+(crd2+1)  ,
			    R   = Chr(crd1+1)+(crd2)  ,L   = Chr(crd1-1)+(crd2)  ,
			    FF  = Chr(crd1)+(crd2-2)  ,BB  = Chr(crd1)+(crd2+2)  ,
			    RR  = Chr(crd1+2)+(crd2)  ,LL  = Chr(crd1-2)+(crd2)  ,
			    FR  = Chr(crd1+1)+(crd2-1),FL  = Chr(crd1-1)+(crd2-1),
			    BR  = Chr(crd1+1)+(crd2+1),BL  = Chr(crd1-1)+(crd2+1),
			    FFR = Chr(crd1+1)+(crd2-2),FFL = Chr(crd1-1)+(crd2-2),
			    BBR = Chr(crd1+1)+(crd2+2),BBL = Chr(crd1-1)+(crd2+2),
			    FRR = Chr(crd1+2)+(crd2-1),FLL = Chr(crd1-2)+(crd2-1),
			    BRR = Chr(crd1+2)+(crd2+1),BLL = Chr(crd1-2)+(crd2+1),
			    FFRR= Chr(crd1+2)+(crd2-2),FFLL= Chr(crd1-2)+(crd2-2),
			    BBRR= Chr(crd1+2)+(crd2+2),BBLL= Chr(crd1-2)+(crd2+2)
                ConTest(F,F,F,Crd);ConTest(B,B,B,Crd);ConTest(R,R,R,Crd);ConTest(L,L,L,Crd)
                ConTest(FR,FR,FR,Crd);ConTest(FL,FL,FL,Crd);ConTest(BR,BR,BR,Crd);ConTest(BL,BL,BL,Crd)
            if(Cmd.search("Cnt.rmt")>=0){
                ConTest(FF,F,F,Crd);ConTest(BB,B,B,Crd);ConTest(LL,L,L,Crd);ConTest(RR,R,R,Crd)
                ConTest(FFRR,FR,FR,Crd);ConTest(BBLL,BL,BL,Crd);ConTest(FFLL,FL,FL,Crd);ConTest(BBRR,BR,BR,Crd)
            }
            if(Cmd.search("Cnt.abn")>=0){
                ConTest(BBL,BL,L,Crd);ConTest(BBL,B,BL,Crd);ConTest(BBL,B,BB,Crd);ConTest(FFL,FL,L,Crd);ConTest(FFL,F,FL,Crd);ConTest(FFL,F,FF,Crd)
                ConTest(BBR,BR,R,Crd);ConTest(BBR,B,BR,Crd);ConTest(BBR,B,BB,Crd);ConTest(FFR,FR,R,Crd);ConTest(FFR,F,FR,Crd);ConTest(FFR,F,FF,Crd)
                ConTest(FRR,FR,F,Crd);ConTest(FRR,RR,R,Crd);ConTest(FRR,FR,R,Crd);ConTest(BRR,BR,B,Crd);ConTest(BRR,RR,R,Crd);ConTest(BRR,BR,R,Crd)
                ConTest(FLL,FL,F,Crd);ConTest(FLL,LL,L,Crd);ConTest(FLL,FL,L,Crd);ConTest(BLL,BL,B,Crd);ConTest(BLL,LL,L,Crd);ConTest(BLL,BL,L,Crd)
            }
            if(ConCheck==0&&coor(Crd).value!=""&&Crd!=SetCrd[1]&&Crd!=SetCrd[2]){
				if(Cmd.search("Rul.Cnt.kil")>=0){
					alert(Crd+"，連線失效");ItemSet("black","white","",Crd)
				}else if(Cmd.search("Rul.Cnt.dis")>=0&&coor(Crd).value.substr(0,1)!=" "){
					coor(Crd).value=" "+coor(Crd).value
					coor(Crd).style.color="teal"
				}
			}
		}
	}
}//連線確認
function ConTest(crd1,crd2,crd3,Crd){var Symbol
for(Sym=0;Sym<2;Sym++){switch(Sym){case 0:Symbol=O;break;case 1:Symbol=X}
if(coor(crd1)&&coor(crd2)&&coor(crd3)){
	if(coor(crd1).value==Symbol||coor(crd1).value=="K"){
		if(coor(Crd).value==Symbol){
			if(coor(crd2).value==""||coor(crd2).value.search(Symbol)>=0||coor(crd1).value=="K"){
				if(coor(crd3).value==""||coor(crd3).value.search(Symbol)>=0||coor(crd1).value=="K"){
					ConCheck++
				}
			}
		}
	}
}
}
}//連線測試
function CleanBoard(){
P="";Q="";Turn=1
for(cd1=65;cd1<74;cd1++){
	for(cd2=1;cd2<10;cd2++){
		coor(Chr(cd1)+cd2).value=""
		coor(Chr(cd1)+cd2).style.backgroundColor="white"
		coor(Chr(cd1)+cd2).style.color="black"
		coor(Chr(cd1)+cd2).title=Chr(cd1)+cd2
		coor(Chr(cd1)+cd2).type="button"
	}
}coor('OFD').type="Hidden"
if(coor('OFD').value!=""){Creator((coor('OFD').value));Reader(coor('OFD').value)}
coor("Undo").value="Undo("+(Turn-1)+")";document.body.scrollTop=0;ModeLoad();TimeCount=0;Counter()
}//清除棋盤內容
function Writer(){
var Sym=""
Cor="<-|"
for(cd1=65;cd1<74;cd1++){
	for(cd2=1;cd2<10;cd2++){
		if(coor(Chr(cd1)+cd2).value==""){
			Sym=Sym+cd1+""+cd2+"2 ";Cor=Cor+"2"
		}
		if(coor(Chr(cd1)+cd2).value==O){
			Sym=Sym+cd1+""+cd2+"0";Cor=Cor+"0"
		}
		if(coor(Chr(cd1)+cd2).value==X){
			Sym=Sym+cd1+""+cd2+"1";Cor=Cor+"1"
		}
		if(coor(Chr(cd1)+cd2).value=="O ")Sym=Sym+cd1+""+cd2+"03 "
		if(coor(Chr(cd1)+cd2).value=="X ")Sym=Sym+cd1+""+cd2+"13 "
		if(coor(Chr(cd1)+cd2).value==" O")Sym=Sym+cd1+""+cd2+"0n "
		if(coor(Chr(cd1)+cd2).value==" X")Sym=Sym+cd1+""+cd2+"1n "
		if(coor(Chr(cd1)+cd2).style.color=="green")Sym=Sym+"1"
		if(coor(Chr(cd1)+cd2).style.color=="coral")Sym=Sym+"2"
		if(coor(Chr(cd1)+cd2).style.color=="red")Sym=Sym+"a"
		if(coor(Chr(cd1)+cd2).style.color=="orange")Sym=Sym+"b"
		if(coor(Chr(cd1)+cd2).style.color=="gold")Sym=Sym+"c"
		if(coor(Chr(cd1)+cd2).style.color=="seagreen")Sym=Sym+"d"
		if(coor(Chr(cd1)+cd2).style.color=="blue")Sym=Sym+"e"
		if(coor(Chr(cd1)+cd2).style.color=="purple")Sym=Sym+"f"
		if(coor(Chr(cd1)+cd2).style.color=="deeppink")Sym=Sym+"g"
		if(coor(Chr(cd1)+cd2).style.color=="slateblue")Sym=Sym+"h"
		if(coor(Chr(cd1)+cd2).style.color=="brown")Sym=Sym+"i"
		if(coor(Chr(cd1)+cd2).style.color=="dodgerblue")Sym=Sym+"n"
		Sym=Sym+" "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="orange")Sym=Sym+cd1+""+cd2+"S "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="dimgray")Sym=Sym+cd1+""+cd2+"B "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="lightgray")Sym=Sym+cd1+""+cd2+"P "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="darkgray")Sym=Sym+cd1+""+cd2+"L "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="indianred")Sym=Sym+cd1+""+cd2+"C "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="lightdkyblue")Sym=Sym+cd1+""+cd2+"V "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="crimson")Sym=Sym+cd1+""+cd2+"D "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="royalblue")Sym=Sym+cd1+""+cd2+"K "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="palevioletred")Sym=Sym+cd1+""+cd2+"Q "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="lightsteelblue")Sym=Sym+cd1+""+cd2+"H "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="mediumvioletred")Sym=Sym+cd1+""+cd2+"U "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="steelblue")Sym=Sym+cd1+""+cd2+"Y "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="orchid")Sym=Sym+cd1+""+cd2+"G "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="dodgerblue")Sym=Sym+cd1+""+cd2+"A "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="hotpink")Sym=Sym+cd1+""+cd2+"J "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="feepskyblue")Sym=Sym+cd1+""+cd2+"I "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="firebrick")Sym=Sym+cd1+""+cd2+"E "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="powderblue")Sym=Sym+cd1+""+cd2+"T "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="seagreen")Sym=Sym+cd1+""+cd2+"F "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="gainsboro")Sym=Sym+cd1+""+cd2+"R "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="blueviolet")Sym=Sym+cd1+""+cd2+"N "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="greenYellow")Sym=Sym+cd1+""+cd2+"Z "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="tan")Sym=Sym+cd1+""+cd2+"M "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="darkSlateGray")Sym=Sym+cd1+""+cd2+"W "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="cyan")Sym=Sym+cd1+""+cd2+"O "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="fuchsia")Sym=Sym+cd1+""+cd2+"X "
		if(coor(Chr(cd1)+cd2).value=="A")Sym=Sym+"A"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="B")Sym=Sym+"B"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="C")Sym=Sym+"C"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="D")Sym=Sym+"D"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="E")Sym=Sym+"E"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="F")Sym=Sym+"F"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="G")Sym=Sym+"G"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="H")Sym=Sym+"H"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="I")Sym=Sym+"I"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="J")Sym=Sym+"J"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="K")Sym=Sym+"K"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="L")Sym=Sym+"L"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="M")Sym=Sym+"M"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="N")Sym=Sym+"N"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="P")Sym=Sym+"P"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="Q")Sym=Sym+"Q"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="R")Sym=Sym+"R"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="S")Sym=Sym+"S"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="T")Sym=Sym+"T"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="U")Sym=Sym+"U"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="V")Sym=Sym+"V"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="W")Sym=Sym+"W"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="Y")Sym=Sym+"Y"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="Z")Sym=Sym+"Z"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value==")|(")Sym=Sym+"Wx"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="ϝ")Sym=Sym+"Wp"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="ϡ")Sym=Sym+"Wk"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="Ξ")Sym=Sym+"Ws"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="Φ")Sym=Sym+"Wb"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="Θ")Sym=Sym+"Wd"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="Ψ")Sym=Sym+"Wf"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="Λ")Sym=Sym+"Wl"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value=="δ")Sym=Sym+"Wg"+cd1+""+cd2
		if(coor(Chr(cd1)+cd2).value==")|( ")Sym=Sym+"Wx"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).value=="ϝ ")Sym=Sym+"Wp"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).value=="ϡ ")Sym=Sym+"Wk"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).value=="Ξ ")Sym=Sym+"Ws"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).value=="Φ ")Sym=Sym+"Wb"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).value=="Θ ")Sym=Sym+"Wd"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).value=="Ψ ")Sym=Sym+"Wf"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).value=="Λ ")Sym=Sym+"Wl"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).value=="δ ")Sym=Sym+"Wg"+cd1+""+cd2+"u"
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="Maroon")Sym=Sym+"O"+cd1+""+cd2+" "
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="Olive")Sym=Sym+"X"+cd1+""+cd2+" "
		if(coor(Chr(cd1)+cd2).style.color=="maroon"){
			if(coor(Chr(cd1)+cd2).value.search(" ")<0){
				coor(Chr(cd1)+cd2).value=coor(Chr(cd1)+cd2).value+" "
			}
		}
	}Sym=Sym+" ";Cor=Cor+"|"
};Sym=Sym+"<T:"+Turn+">";Board[Turn]=Sym;Cor=Cor+"->"
}//輸出棋盤內容
function Reader(Cmd){
var Cor=Cmd
for(n=0;n<Cor.length;n++){
	if(Cor.substr(n,3)=="<-|"&&Cor.substr(n+93,2)=="->"){
		for(i=n+3;i<Cor.length-2;i+=10){var crd = Cor.substr(i,9)
			for(j=0;j<crd.length;j++){
				switch(crd.substr(j,1)){
					case "0":coor(Chr((i-2)/10+65)+(j+1)).value=O;break
					case "1":coor(Chr((i-2)/10+65)+(j+1)).value=X;break
					case "2":coor(Chr((i-2)/10+65)+(j+1)).value="";break
				}
			}
		}
	}
}
for(T1=1;T1<100;T1++){
	if(Cmd.search("T<"+T1+",")>=0){TurnStart=T1}
	if(Cmd.search(","+T1+">")>=0){TurnEnd=T1}
	if(Cmd.search("<T:"+T1+">")>=0){Turn=T1}
	if(Cmd.search("<S:"+T1+">")>=0){TotalScore=T1}
	if(Cmd.search("<DA:"+T1+">")>=0){DAct=T1-1}
	if(Cmd.search("<TA:"+T1+">")>=0){TAct=T1-1}
}
Cmd=Cmd+" "
for(C=65;C<91;C++){
	for(cd1=65;cd1<74;cd1++){
		if(Cmd.search(cd1+"N"+Chr(C))>=0){
			for(cd2=1;cd2<10;cd2++){
				Cmd=Cmd+cd1+""+cd2+Chr(C)+" "
			}
		}
		if(Cmd.search(Chr(C)+cd1+"N")>=0){
			for(cd2=1;cd2<10;cd2++){
				Cmd=Cmd+Chr(C)+cd1+""+cd2+" "
			}
		}
	}
	for(cd2=1;cd2<10;cd2++){
		if(Cmd.search("TT"+cd2+Chr(C))>=0){
			for(cd1=65;cd1<74;cd1++){
				Cmd=Cmd+cd1+""+cd2+Chr(C)+" "
			}
		}
		if(Cmd.search(Chr(C)+"TT"+cd2)>=0){
			for(cd1=65;cd1<74;cd1++){
				Cmd=Cmd+Chr(C)+cd1+""+cd2+" "
			}
		}
	}
}
for(S=0;S<3;S++){
	for(C=97;C<106;C++){
		for(cd1=65;cd1<74;cd1++){
			if(Cmd.search(cd1+"N"+""+S+Chr(C))>=0){
				for(cd2=1;cd2<10;cd2++){
					Cmd=Cmd+cd1+""+cd2+S+Chr(C)+" "
				}
			}
		}
		for(cd2=1;cd2<10;cd2++){
			if(Cmd.search("TT"+cd2+""+S+Chr(C))>=0){
				for(cd1=65;cd1<74;cd1++){
					Cmd=Cmd+cd1+""+cd2+S+Chr(C)+" "
				}
			}
		}
	}
}
for(cd1=65;cd1<74;cd1++){
	for(cd2=1;cd2<10;cd2++){
		if(Cmd.search("undo")>=0)ItemSet("black","white","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"2")>=0)coor(Chr(cd1)+cd2).value=""
		if(Cmd.search(cd1+""+cd2+"S")>=0)ItemSet("black","orange","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"B")>=0)ItemSet("black","dimgray"," ",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"N")>=0)ItemSet("black","blueviolet","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"Z")>=0)ItemSet("black","greenyellow","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"P")>=0)ItemSet("black","lightgray","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"L")>=0)ItemSet("black","darkgray","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"R")>=0)ItemSet("black","gainsboro","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"F")>=0)ItemSet("black","seagreen","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"M")>=0)ItemSet("black","tan","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"W")>=0)ItemSet("black","darkslategray","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"C")>=0)ItemSet("black","indianred","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"V")>=0)ItemSet("black","lightskyblue","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"D")>=0)ItemSet("black","crimson","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"K")>=0)ItemSet("black","royalblue","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"Q")>=0)ItemSet("black","palevioletred","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"H")>=0)ItemSet("black","lightsteelblue","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"U")>=0)ItemSet("black","mediumvioletred","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"Y")>=0)ItemSet("black","steelblue","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"G")>=0)ItemSet("black","orchid","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"A")>=0)ItemSet("black","dodgerblue","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"J")>=0)ItemSet("black","hotpink","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"I")>=0)ItemSet("black","deepskyblue","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"E")>=0)ItemSet("black","firebrick","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"T")>=0)ItemSet("black","powderblue","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"O")>=0)ItemSet("black","cyan","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"X")>=0)ItemSet("black","fuchsia","",Chr(cd1)+cd2)
		if(Cmd.search(cd1+""+cd2+"0")>=0)coor(Chr(cd1)+cd2).value=O
		if(Cmd.search(cd1+""+cd2+"1")>=0)coor(Chr(cd1)+cd2).value=X
		if(Cmd.search(cd1+""+cd2+"01")>=0)coor(Chr(cd1)+cd2).style.color="green"
		if(Cmd.search(cd1+""+cd2+"11")>=0)coor(Chr(cd1)+cd2).style.color="green"
		if(Cmd.search(cd1+""+cd2+"02")>=0)coor(Chr(cd1)+cd2).style.color="coral"
		if(Cmd.search(cd1+""+cd2+"12")>=0)coor(Chr(cd1)+cd2).style.color="coral"
		if(Cmd.search(cd1+""+cd2+"03")>=0)coor(Chr(cd1)+cd2).style.color="maroon"
		if(Cmd.search(cd1+""+cd2+"13")>=0)coor(Chr(cd1)+cd2).style.color="maroon"
		if(Cmd.search(cd1+""+cd2+"0n")>=0){
			coor(Chr(cd1)+cd2).style.color="teal"
			coor(Chr(cd1)+cd2).value=" O"
		}
		if(Cmd.search(cd1+""+cd2+"1n")>=0){
			coor(Chr(cd1)+cd2).style.color="teal"
			coor(Chr(cd1)+cd2).value=" X"
		}
		if(Cmd.search(cd1+""+cd2+"0a")>=0)coor(Chr(cd1)+cd2).style.color="red"
		if(Cmd.search(cd1+""+cd2+"1a")>=0)coor(Chr(cd1)+cd2).style.color="red"
		if(Cmd.search(cd1+""+cd2+"0b")>=0)coor(Chr(cd1)+cd2).style.color="orange"
		if(Cmd.search(cd1+""+cd2+"1b")>=0)coor(Chr(cd1)+cd2).style.color="orange"
		if(Cmd.search(cd1+""+cd2+"0c")>=0)coor(Chr(cd1)+cd2).style.color="gold"
		if(Cmd.search(cd1+""+cd2+"1c")>=0)coor(Chr(cd1)+cd2).style.color="gold"
		if(Cmd.search(cd1+""+cd2+"0d")>=0)coor(Chr(cd1)+cd2).style.color="seagreen"
		if(Cmd.search(cd1+""+cd2+"1d")>=0)coor(Chr(cd1)+cd2).style.color="seagreen"
		if(Cmd.search(cd1+""+cd2+"0e")>=0)coor(Chr(cd1)+cd2).style.color="blue"
		if(Cmd.search(cd1+""+cd2+"1e")>=0)coor(Chr(cd1)+cd2).style.color="blue"
		if(Cmd.search(cd1+""+cd2+"0f")>=0)coor(Chr(cd1)+cd2).style.color="purple"
		if(Cmd.search(cd1+""+cd2+"1f")>=0)coor(Chr(cd1)+cd2).style.color="purple"
		if(Cmd.search(cd1+""+cd2+"0g")>=0)coor(Chr(cd1)+cd2).style.color="deeppink"
		if(Cmd.search(cd1+""+cd2+"1g")>=0)coor(Chr(cd1)+cd2).style.color="deeppink"
		if(Cmd.search(cd1+""+cd2+"0h")>=0)coor(Chr(cd1)+cd2).style.color="slateblue"
		if(Cmd.search(cd1+""+cd2+"1h")>=0)coor(Chr(cd1)+cd2).style.color="slateblue"
		if(Cmd.search(cd1+""+cd2+"0i")>=0)coor(Chr(cd1)+cd2).style.color="brown"
		if(Cmd.search(cd1+""+cd2+"1i")>=0)coor(Chr(cd1)+cd2).style.color="brown"
		if(Cmd.search(cd1+""+cd2+"0p")>=0)coor(Chr(cd1)+cd2).style.color="dodgerblue"
		if(Cmd.search(cd1+""+cd2+"1p")>=0)coor(Chr(cd1)+cd2).style.color="dodgerblue"
		if(Cmd.search("A"+cd1+""+cd2)>=0)ItemSet("white","indigo","Azaga",Chr(cd1)+cd2)
		if(Cmd.search("B"+cd1+""+cd2)>=0)ItemSet("red","darkred","Bilaz",Chr(cd1)+cd2)
		if(Cmd.search("C"+cd1+""+cd2)>=0)ItemSet("blueviolet","indigo","Catra",Chr(cd1)+cd2)
		if(Cmd.search("D"+cd1+""+cd2)>=0)ItemSet("red","dimgray","Diaxu",Chr(cd1)+cd2)
		if(Cmd.search("E"+cd1+""+cd2)>=0)ItemSet("navy","white","Esomo",Chr(cd1)+cd2)
		if(Cmd.search("F"+cd1+""+cd2)>=0)ItemSet("skyblue","blue","Fixia",Chr(cd1)+cd2)
		if(Cmd.search("G"+cd1+""+cd2)>=0)ItemSet("darkgray","gray","Guris",Chr(cd1)+cd2)
		if(Cmd.search("H"+cd1+""+cd2)>=0&&Cmd.search("Crt.H.Act")<0)ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1)+cd2)
		if(Cmd.search("I"+cd1+""+cd2)>=0)ItemSet("white","silver","Ibers",Chr(cd1)+cd2)
		if(Cmd.search("J"+cd1+""+cd2)>=0)ItemSet("crimson","darkgreen","Junky",Chr(cd1)+cd2)
		if(Cmd.search("K"+cd1+""+cd2)>=0)ItemSet("dimgray","white","Kiase",Chr(cd1)+cd2)
		if(Cmd.search("L"+cd1+""+cd2)>=0)ItemSet("lime","darkgreen","Luqus",Chr(cd1)+cd2)
		if(Cmd.search("M"+cd1+""+cd2)>=0)ItemSet("navy","cornflowerblue","Mokla",Chr(cd1)+cd2)
		if(Cmd.search("N"+cd1+""+cd2)>=0)ItemSet("purple","black","Nasos",Chr(cd1)+cd2)
		if(Cmd.search("P"+cd1+""+cd2)>=0)ItemSet("dimgray","black","Poken",Chr(cd1)+cd2)
		if(Cmd.search("Q"+cd1+""+cd2)>=0)ItemSet("white","white","Quare",Chr(cd1)+cd2)
		if(Cmd.search("R"+cd1+""+cd2)>=0)ItemSet("gold","darkorange","Rader",Chr(cd1)+cd2)
		if(Cmd.search("S"+cd1+""+cd2)>=0)ItemSet("black","white","Sinbo",Chr(cd1)+cd2)
		if(Cmd.search("T"+cd1+""+cd2)>=0)ItemSet("steelblue","skyblue","Tiafu",Chr(cd1)+cd2)
		if(Cmd.search("U"+cd1+""+cd2)>=0)ItemSet("midnightblue","orangered","Uinos",Chr(cd1)+cd2)
		if(Cmd.search("V"+cd1+""+cd2)>=0)ItemSet("brown","darkorange","Vitor",Chr(cd1)+cd2)
		if(Cmd.search("W"+cd1+""+cd2)>=0)ItemSet("purple","pink","Waler",Chr(cd1)+cd2)
		if(Cmd.search("Y"+cd1+""+cd2)>=0)ItemSet("white","deeppink","Yokla",Chr(cd1)+cd2)
		if(Cmd.search("Z"+cd1+""+cd2)>=0)ItemSet("red","black","Zager",Chr(cd1)+cd2)
		if(Cmd.search("O"+cd1+""+cd2)>=0)ItemSet("red","maroon","Oxdra",Chr(cd1)+cd2)
		if(Cmd.search("X"+cd1+""+cd2)>=0)ItemSet("yellow","olive","Xomud",Chr(cd1)+cd2)
		if(Cmd.search("Wx"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value=")|("
		if(Cmd.search("Wb"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value="Φ"
		if(Cmd.search("Wd"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value="Θ"
		if(Cmd.search("Wl"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value="Λ"
		if(Cmd.search("Wp"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value="ϝ"
		if(Cmd.search("Wk"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value="ϡ"
		if(Cmd.search("Ws"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value="Ξ"
		if(Cmd.search("Wf"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value="Ψ"
		if(Cmd.search("Wg"+cd1+""+cd2)>=0)coor(Chr(cd1)+cd2).value="δ"
		if(Cmd.search(cd1+""+cd2+"u")>=0){
			coor(Chr(cd1)+cd2).style.color="maroon"
			coor(Chr(cd1)+cd2).value=coor(Chr(cd1)+cd2).value+" "
		}
	}
}
}//輸入棋盤內容
function Creator(Cmd){
if(Cmd.search("Rul.Min")>=0){var Min=3
	for(C=1;C<10;C++){LM[C]="";if(Cmd.search("Rul.Min<"+C+">")>=0)Min=C}
	for(c=1;c<Min+1;c++){
		Random(9,65,9,1);LM[c]=r1+r2
	}
}
if(Cmd.search("Ara.prt")>=0){var Ara
	for(C=3;C<10;C++){if(Cmd.search("Ara.prt<"+C+">")>=0)Ara=C}
	ItemSet("black","crimson","","A1")
	ItemSet("black","orange","","E9")
	ItemSet("black","dodgerblue","","I2")
	if(Ara>3)ItemSet("black","seagreen","","F4")
	if(Ara>4)ItemSet("black","blueviolet","","C5")
	if(Ara>5)ItemSet("black","fuchsia","","H8")
	if(Ara>6)ItemSet("black","tan","","D7")
	if(Ara>7)ItemSet("black","lightgray","","B3")
	if(Ara>8)ItemSet("black","greenyellow","","G6")
	var chk=0
	while(chk>=0){chk=0
		for(cd1=65;cd1<74;cd1++){
			for(cd2=1;cd2<10;cd2++){
				if(coor(Chr(cd1)+cd2).style.backgroundColor=="white")chk++
			}
		}
		if(chk==0)break
		Random(9,65,9,1)
		if(coor(r1+r2).style.backgroundColor=="white"){
			if(coor(r1+(r2+1))&&coor(r1+(r2+1)).style.backgroundColor!="white"){
				coor(r1+r2).style.backgroundColor=coor(r1+(r2+1)).style.backgroundColor
			}
			if(coor(r1+(r2-1))&&coor(r1+(r2-1)).style.backgroundColor!="white"){
				coor(r1+r2).style.backgroundColor=coor(r1+(r2-1)).style.backgroundColor
			}
			if(coor(Chr(r1.charCodeAt(r1)+1)+r2)&&coor(Chr(r1.charCodeAt(r1)+1)+r2).style.backgroundColor!="white"){
				coor(r1+r2).style.backgroundColor=coor(Chr(r1.charCodeAt(r1)+1)+r2).style.backgroundColor
			}
			if(coor(Chr(r1.charCodeAt(r1)-1)+r2)&&coor(Chr(r1.charCodeAt(r1)-1)+r2).style.backgroundColor!="white"){
				coor(r1+r2).style.backgroundColor=coor(Chr(r1.charCodeAt(r1)-1)+r2).style.backgroundColor
			}
		}
	}
}
for(C=1;C<=99;C++){
	if(Cmd.search("Crt.J.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("crimson","darkgreen","",r1+r2)}
	if(Cmd.search("Crt.G.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("darkgray","gray","Guris",r1+r2)}
	if(Cmd.search("Crt.S.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("black","white","Sinbo",r1+r2)}
	if(Cmd.search("Crt.E.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("navy","white","Esomo",r1+r2)}
	if(Cmd.search("Crt.M.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("navy","cornflowerblue","Mokla",r1+r2)}
	if(Cmd.search("Crt.K.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("dimgray","white","Kiase",r1+r2)}
	if(Cmd.search("Ara.P.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("black","lightgray","",r1+r2)}
	if(Cmd.search("Ara.S.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("black","orange","",r1+r2)}
	if(Cmd.search("Ara.F.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("black","seagreen","",r1+r2)}
	if(Cmd.search("Ara.M.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("black","tan","",r1+r2)}
	if(Cmd.search("Ara.B.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("black","dimgray"," ",r1+r2)}
	if(Cmd.search("Ara.L.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("black","darkgray","",r1+r2)}
	if(Cmd.search("Ara.R.Rnd<"+C+">")>=0)for(g=1;g<=C;g++){Random(9,65,9,1);ItemSet("black","gainsboro","",r1+r2)}
}
if(Cmd.search("Ara.W.Rnd")>=0){Random(9,65,9,1);ItemSet("black","darkslategray","",r1+r2)}
if(Cmd.search("Ara.N.Rnd")>=0){Random(9,65,9,1);ItemSet("black","blueviolet","",r1+r2)}
if(Cmd.search("Ara.Z.Rnd")>=0){Random(9,65,9,1);ItemSet("black","greenyellow","",r1+r2)}
if(Cmd.search("Crt.C.Rnd")>=0){Random(9,65,9,1);ItemSet("blueviolet","indigo","Catra",r1+r2)}
if(Cmd.search("Crt.W.Rnd")>=0){Random(9,65,9,1);ItemSet("purple","pink","Waler",r1+r2)}
if(Cmd.search("Crt.Y.Rnd")>=0){Random(9,65,9,1);ItemSet("white","deeppink","Yokla",r1+r2)}
if(Cmd.search("Crt.D.Rnd")>=0){Random(9,65,9,1);ItemSet("red","dimgray","Diaxu",r1+r2)}
if(Cmd.search("Crt.T.Rnd")>=0){Random(9,65,9,1);ItemSet("steelblue","skyblue","Tiafu",r1+r2)}
if(Cmd.search("Crt.O.Rnd")>=0){Random(9,65,9,1);ItemSet("red","maroon","Oxdra",r1+r2)}
if(Cmd.search("Crt.X.Rnd")>=0){Random(9,65,9,1);ItemSet("yellow","olive","Xomud",r1+r2)}
if(Cmd.search("Sym.Rnd")>=0){var s
	Random(9,65,9,1);s=r1+r2;coor(s).value=O;Random(9,65,9,1)
	if(s!=r1+r2)coor(r1+r2).value=X
}
}//創建棋盤結構
function BasicRule(){
var CArea=0,OAra=0,XAra=0
spc=0;OArea=0;XArea=0
if(Turn>2){
var spc
for(cd1=65;cd1<74;cd1++){
	for(cd2=1;cd2<10;cd2++){OAra=0;XAra=0
		if(coor(Chr(cd1)+cd2)){
			var Crd=Chr(cd1)+""+cd2
			var crd1=Crd.charCodeAt(Crd.substr(0,1)),crd2=parseInt(Crd.substr(1,1))
			var F=Chr(crd1-1)+crd2,B=Chr(crd1+1)+crd2
			var R=Chr(crd1)+(crd2+1),L=Chr(crd1)+(crd2-1)
			var FR=Chr(crd1-1)+(crd2+1),FL=Chr(crd1-1)+(crd2-1)
			var BR=Chr(crd1+1)+(crd2+1),BL=Chr(crd1+1)+(crd2-1)
			if(coor(Crd).value==""){
				if(coor(F)){if(coor(F).value==O){OArea++;OAra=1}}
				if(coor(B)){if(coor(B).value==O){OArea++;OAra=1}}
				if(coor(R)){if(coor(R).value==O){OArea++;OAra=1}}
				if(coor(L)){if(coor(L).value==O){OArea++;OAra=1}}
				if(coor(FR)){if(coor(FR).value==O){OArea++;OAra=1}}
				if(coor(FL)){if(coor(FL).value==O){OArea++;OAra=1}}
				if(coor(BR)){if(coor(BR).value==O){OArea++;OAra=1}}
				if(coor(BL)){if(coor(BL).value==O){OArea++;OAra=1}}
				if(coor(F)){if(coor(F).value==X){XArea++;XAra=1}}
				if(coor(B)){if(coor(B).value==X){XArea++;XAra=1}}
				if(coor(R)){if(coor(R).value==X){XArea++;XAra=1}}
				if(coor(L)){if(coor(L).value==X){XArea++;XAra=1}}
				if(coor(FR)){if(coor(FR).value==X){XArea++;XAra=1}}
				if(coor(FL)){if(coor(FL).value==X){XArea++;XAra=1}}
				if(coor(BR)){if(coor(BR).value==X){XArea++;XAra=1}}
				if(coor(BL)){if(coor(BL).value==X){XArea++;XAra=1}}
				spc++
			}if(OAra==1&&XAra==1)CArea++
		}
	}
}
if(Turn>2){
	if(spc==0){
		Winner("雙方皆無法設置符號，平手");CleanBoard()
	}else if(OArea==0){
		Winner("O無法繼續設置符號，X獲勝");CleanBoard()
	}else if(XArea==0&&OArea>8){
		Winner("X無法繼續設置符號，O獲勝");CleanBoard()
	}
}Writer()
if(CArea==0)AutoRun()
}
}//基礎規則
function AutoRun(){
	if(coor("OFD").value.search("Rul.Ato")>=0){
		while(Turn>2){
			if(Turn%2==0){Q=X}else{Q=O}
			while(Turn>2){var Ck=0
				Random(9,65,9,1)
				for(cd1=r1.charCodeAt(r1)-1;cd1<r1.charCodeAt(r1)+2;cd1++){
					for(cd2=r2-1;cd2<r2+2;cd2++){
						if(coor(Chr(cd1)+cd2)
						&&coor(Chr(cd1)+cd2).value==Q
						&&coor(r1+r2).value=="")Ck=1
					}
				}
				if(Turn<3||Ck==1)SetSym(r1+r2)
			}
		}
	}
}//自動完成
function AreaRule(){
var Cmd=coor('OFD').value
if(Cmd.search("Rul.Ara")>=0){
	if(Cmd.search("Rul.Ara.prt")>=0){
		BasicRule();AreaRulePart()
	}else{
		if(Cmd.search("Rul.Ara.tgt")>=0){
			AreaRuleTarget(Cmd)
		}else{
			AreaRuleMulti(Cmd)
		}
	}
}else{
	var Area_K=0,AreaK=0,Area_D=0,AreaD=0
	var Area_I=0,AreaI=0,Area_J=0,AreaJ=0
	var Area_H=0,AreaH=0,Area_Q=0,AreaQ=0
	var Area_E=0,Area_T=0
	var ScoreO=0,ScoreX=0,Score=0
	for(cd1=65;cd1<74;cd1++){
		for(cd2=1;cd2<10;cd2++){
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="firebrick")Area_E++
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="powderblue")Area_T++
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="lightgray"){
				if(coor(Chr(cd1)+cd2).value==O)Winner("O設置符號於禁區，X獲勝")
				if(coor(Chr(cd1)+cd2).value==X)Winner("X設置符號於禁區，O獲勝")
			}
		if(coor(Chr(cd1)+cd2).value==O||coor(Chr(cd1)+cd2).value==X){
			var ClearBoard=0,ClearBoardType=""
			if(coor(Chr(cd1)+cd2).style.backgroundColor=="darkgray")ClearBoard=1;ClearBoardType="C"
			if(coor(Chr(cd1)+cd2).style.backgroundColor=="firebrick"&&coor(Chr(cd1)+cd2).value==O)ClearBoard=1;ClearBoardType="C"
			if(coor(Chr(cd1)+cd2).style.backgroundColor=="powderblue"&&coor(Chr(cd1)+cd2).value==X)ClearBoard=1;ClearBoardType="C"
			if(coor(Chr(cd1)+cd2).style.backgroundColor=="blueviolet")ClearBoard=1;ClearBoardType="G"
			if(coor(Chr(cd1)+cd2).style.backgroundColor=="greenyellow")ClearBoard=1;ClearBoardType=ClearBoardType+"S"
	if(coor(Chr(cd1)+cd2).style.backgroundColor=="darkslategray")ClearBoard=1;ClearBoardType=ClearBoardType+"T"
	if(coor(Chr(cd1)+cd2).style.backgroundColor=="fuchsia")ClearBoard=1;ClearBoardType=ClearBoardType+"K"
			if(ClearBoard==1){
			for(cr1=65;cr1<74;cr1++){
				for(cr2=1;cr2<10;cr2++){
					if(ClearBoardType.search("C")>=0&&coor(Chr(cr1)+cr2).style.backgroundColor=="white"&&coor(Chr(cr1)+cr2).style.color=="black")coor(Chr(cr1)+cr2).value=""
				if(ClearBoardType.search("G")>=0&&coor(Chr(cr1)+cr2).style.backgroundColor=="gray")ItemSet("black","white","",Chr(cr1)+cr2)
				if(ClearBoardType.search("S")>=0&&coor(Chr(cr1)+cr2).style.backgroundColor=="seagreen")ItemSet("black","white","",Chr(cr1)+cr2)
				if(ClearBoardType.search("T")>=0&&coor(Chr(cr1)+cr2).style.backgroundColor=="tan")ItemSet("black","white","",Chr(cr1)+cr2)
				if(ClearBoardType.search("K")>=0){
				if(coor(Chr(cr1)+cr2).style.backgroundColor=="olive"&&coor(Chr(cr1)+cr2).value=="X")ItemSet("black","white","",Chr(cr1)+cr2)
				if(coor(Chr(cr1)+cr2).style.backgroundColor=="maroon"&&coor(Chr(cr1)+cr2).value=="O")ItemSet("black","white","",Chr(cr1)+cr2)
					}
				}
				
			}
			coor(Chr(cd1)+cd2).style.backgroundColor="white"
			}
			}	
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="royalblue"){
		if(coor(Chr(cd1)+cd2).value==O)Winner("O設置符號於X封限區，O獲勝")
		if(coor(Chr(cd1)+cd2).value==X)AreaK++;Area_K++
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="crimson"){
		if(coor(Chr(cd1)+cd2).value==X)Winner("X設置符號於O封限區，X獲勝")
		if(coor(Chr(cd1)+cd2).value==O)AreaD++;Area_D++
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="deepskyblue"){
		if(coor(Chr(cd1)+cd2).value==X)AreaI++;Area_I++
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="hotpink"){
		if(coor(Chr(cd1)+cd2).value==X)AreaJ++;Area_J++
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="lightskyblue"){
		if(coor(Chr(cd1)+cd2).value==O)Winner("O設置符號於X禁區，O獲勝")
		if(coor(Chr(cd1)+cd2).value==X)Winner("X設置符號於X禁區，O獲勝")
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="indianred"){
		if(coor(Chr(cd1)+cd2).value==O)Winner("O設置符號於O禁區，X獲勝")
		if(coor(Chr(cd1)+cd2).value==X)Winner("X設置符號於O禁區，X獲勝")
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="lightsteelblue"){
		if(coor(Chr(cd1)+cd2).value==X)AreaH++;Area_H++
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="palevioletred"){
		if(coor(Chr(cd1)+cd2).value==O)AreaQ++;Area_Q++
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="steelblue"){
		if(coor(Chr(cd1)+cd2).value==O)Winner("O設置符號於X限區，O獲勝")
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="mediumvioletred"){
		if(coor(Chr(cd1)+cd2).value==X)Winner("X設置符號於O限區，X獲勝")
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="dodgerblue"){
		if(coor(Chr(cd1)+cd2).value==X)Winner("X設置符號於X防區，X獲勝")
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="orchid"){
		if(coor(Chr(cd1)+cd2).value==O)Winner("O設置符號於O防區，O獲勝")
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="cyan"){
		if(coor(Chr(cd1)+cd2).value==O)ItemSet("red","maroon","Oxdra",Chr(cd1)+cd2)
		if(coor(Chr(cd1)+cd2).value==X)ItemSet("yellow","olive","Xomud",Chr(cd1)+cd2)
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="orange"){
		if(coor(Chr(cd1)+cd2).value==O)ScoreO++
		if(coor(Chr(cd1)+cd2).value==X)ScoreX++
		Score++
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="tan"&&coor(Chr(cd1)+cd2).value!=""){
		var Txt=coor(Chr(cd1)+cd2).value
		CircleCrt("darkgray","gray","Guris",Chr(cd1)+cd2)
		ItemSet("black","tan",Txt,Chr(cd1)+cd2)
		}
		if(coor(Chr(cd1)+cd2).style.backgroundColor=="gainsboro"){Random(9, 64, 8, 1)
		ItemSet("black","white",coor(Chr(cd1)+cd2).value,r1+r2)
		coor(Chr(cd1)+cd2).style.backgroundColor="white"
		}
		}
	}
	if(Turn>3){
	if(Area_H>1&&Area_Q>1){
	if(AreaQ==Area_Q)Winner("O將自己封區全數填滿，X獲勝")
	if(AreaH==Area_H)Winner("X將自己封區全數填滿，O獲勝")
	}
	if(Area_E+10<Area_T)Winner("X取得區域較多，X獲勝")
	if(Area_T+10<Area_E)Winner("O取得區域較多，O獲勝")
	if(TotalScore!=0){
		if(TotalScore==ScoreX)Winner("X得分較高，X獲勝")
		if(TotalScore==ScoreO)Winner("O得分較高，O獲勝")
	}else{
		if(Score>2){
			if(Score%2==0){
				if(ScoreO+2==ScoreX)Winner("X得分較高，X獲勝")
				if(ScoreX+2==ScoreO)Winner("O得分較高，O獲勝")
			}else{
				if(ScoreO+1<ScoreX)Winner("X得分較高，X獲勝")
				if(ScoreX+1<ScoreO)Winner("O得分較高，O獲勝")
			}
		}else{
			if(Score<2&&Score>0){
				if(ScoreO==Score)Winner("O得分較高，O獲勝")
				if(ScoreX==Score)Winner("X得分較高，X獲勝")
			}
		}
	}
	if(Area_K>1&&Area_D>1){
		if(AreaD==Area_D)Winner("O將自己封限區全數填滿，X獲勝")
		if(AreaK==Area_K)Winner("X將自己封限區全數填滿，O獲勝")
	}
	if(Area_I>1&&Area_J>1){
		if(AreaJ==Area_J)Winner("O將自己聯區全數填滿，O獲勝")
		if(AreaI==Area_I)Winner("X將自己聯區全數填滿，X獲勝")
	}
	}
}
}//區域規則
function AreaRuleMulti(Cmd){
var ScoreO=0,ScoreX=0
var Multi=new Array(), Score=new Array()
for(Ara=1;Ara<26;Ara++){var C=0
	for(cd1=65;cd1<74;cd1++){
		for(cd2=1;cd2<10;cd2++){
			if(coor(Chr(cd1)+cd2).style.backgroundColor!="white"){var cks = 0
				for(Ars=1;Ars<26;Ars++){
					if(Multi[Ars]==coor(Chr(cd1)+cd2).style.backgroundColor){cks=1;break}
				}
				if(cks==0){C++;Multi[Ara+C]=coor(Chr(cd1)+cd2).style.backgroundColor}
			}
		}
	}
}
for(Ara=1;Ara<26;Ara++){var OAra=0,XAra=0;Score[Ara]=0
	for(cd1=65;cd1<74;cd1++){
		for(cd2=1;cd2<10;cd2++){
			if(coor(Chr(cd1)+cd2).style.backgroundColor!="white"){
				if(coor(Chr(cd1)+cd2).style.backgroundColor==Multi[Ara]){Score[Ara]++
					if(coor(Chr(cd1)+cd2).value==O)OAra++
					if(coor(Chr(cd1)+cd2).value==X)XAra++
				}
			}
		}
	}
if(Score[Ara]!=0&&Score[Ara]==OAra)ScoreO++
if(Score[Ara]!=0&&Score[Ara]==XAra)ScoreX++
}
if(Cmd.search("Rul.Ara.scr")>=0){
	if(TotalScore!=0){
		if(TotalScore==ScoreX)Winner("X得分較高，X獲勝")
		if(TotalScore==ScoreO)Winner("O得分較高，O獲勝")
	}else{
		if(ScoreO+2==ScoreX)Winner("X得分較高，X獲勝")
		if(ScoreX+2==ScoreO)Winner("O得分較高，O獲勝")
	}
}else{
	if(ScoreX==1)Winner("X優先取得一區，X獲勝")
	if(ScoreO==1)Winner("O優先取得一區，O獲勝")
}
}//區域規則(多區)
function AreaRulePart(){
var Part=["crimson","orange","seagreen","dodgerblue","blueviolet","fuchsia","tan","lightgray","greenyellow"]
var OsA,XsA,SsA
for(C=0;C<10;C++){OsA=0;XsA=0;SsA=0
	for(cd1=65;cd1<74;cd1++){
		for(cd2=1;cd2<10;cd2++){
			if(coor(Chr(cd1)+cd2).style.backgroundColor==Part[C]){SsA++
				if(coor(Chr(cd1)+cd2).value==O)OsA++
				if(coor(Chr(cd1)+cd2).value==X)XsA++
			}
		}
	}
	if(SsA==OsA+XsA&&OsA>0&&XsA>0){
		for(cd1=65;cd1<74;cd1++){
			for(cd2=1;cd2<10;cd2++){
			if(coor(Chr(cd1)+cd2).style.backgroundColor==Part[C])coor(Chr(cd1)+cd2).value=""
			}
		}
	}
}
}//區域規則(區塊)
function AreaRuleTarget(Cmd){
for(C=0;C<10;C++){
	var OsA=0,XsA=0,SsA=0
	for(cd1=65;cd1<74;cd1++){
		for(cd2=1;cd2<10;cd2++){
			if(Cmd.search("-"+Chr(cd1)+cd2+":"+C)>=0){SsA++
				if(Cmd.search(O+"-"+Chr(cd1)+cd2+":"+C)>=0&&coor(Chr(cd1)+cd2).value==O)OsA++
				if(Cmd.search(X+"-"+Chr(cd1)+cd2+":"+C)>=0&&coor(Chr(cd1)+cd2).value==X)XsA++
			}
		}
	}
	if(SsA>0&&SsA==OsA+XsA){if(Cmd.search("tgt-"+O+":"+C)>=0){Winner("OX將指定區域全數填滿，O獲勝")}else{Winner("OX將指定區域全數填滿，X獲勝")}}
}
}//區域規則(目標)
function CharaterRule(){
var Cmd=coor('OFD').value
for(cd1=65;cd1<74;cd1++){
	for(cd2=1;cd2<10;cd2++){
		var Crd=SetCrd[Turn-1]
        if(coor(Chr(cd1)+cd2).style.backgroundColor=="darkgreen"&&coor(Chr(cd1)+cd2).style.color=="crimson"){
			if(coor(Chr(cd1)+cd2).value==O)Winner("O觸動食人怪，X獲勝")
			if(coor(Chr(cd1)+cd2).value==X)Winner("X觸動食人怪，O獲勝")
		}
		if(coor(Chr(cd1)+cd2).value=="E"){
		if(Crd==Chr(cd1)+(cd2-1))CircleSym(coor(Crd).value,Chr(cd1)+cd2)
		if(Crd==Chr(cd1)+(cd2+1))CircleSym(coor(Crd).value,Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+cd2)CircleSym(coor(Crd).value,Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+cd2)CircleSym(coor(Crd).value,Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+(cd2-1))CircleSym(coor(Crd).value,Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+(cd2+1))CircleSym(coor(Crd).value,Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+(cd2+1))CircleSym(coor(Crd).value,Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+(cd2-1))CircleSym(coor(Crd).value,Chr(cd1)+cd2)
		ItemSet("navy","white","Esomo",Chr(cd1)+cd2)
		}
		if(coor(Chr(cd1)+cd2).value=="O"&&coor(Chr(cd1)+cd2).style.backgroundColor=="maroon"){
		if(Crd==Chr(cd1+1)+parseInt(cd2-1))CircleSym("O",Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+parseInt(cd2+1))CircleSym("O",Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+cd2)CircleSym("O",Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+cd2)CircleSym("O",Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+(cd2-1))CircleSym("O",Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+(cd2+1))CircleSym("O",Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+(cd2+1))CircleSym("O",Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+(cd2-1))CircleSym("O",Chr(cd1)+cd2)
		ItemSet("red","maroon","Oxdra",Chr(cd1)+cd2)
     	}
		if(coor(Chr(cd1)+cd2).value=="X"&&coor(Chr(cd1)+cd2).style.backgroundColor=="olive"){
		if(Crd==Chr(cd1+1)+parseInt(cd2-1))CircleSym("X",Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+parseInt(cd2+1))CircleSym("X",Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+cd2)CircleSym("X",Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+cd2)CircleSym("X",Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+(cd2-1))CircleSym("X",Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+(cd2+1))CircleSym("X",Chr(cd1)+cd2)
		if(Crd==Chr(cd1+1)+(cd2+1))CircleSym("X",Chr(cd1)+cd2)
		if(Crd==Chr(cd1-1)+(cd2-1))CircleSym("X",Chr(cd1)+cd2)
		ItemSet("yellow","olive","Xomud",Chr(cd1)+cd2)
		}
	}
}
if(Turn>=TurnStart&&Turn<=TurnEnd){
var CrtC=0,CrtW=0,CrtT=0,CrtQ=0
if(TurnCount==TAct)TurnCount=0;TurnCount++
	for(cd1=65;cd1<74;cd1++){
		for(cd2=1;cd2<10;cd2++){
			if(Turn==TurnEnd)if(coor(Chr(cd1)+cd2).value=="M")coor(Chr(cd1)+cd2).value=""
				if(Cmd.search("H"+cd1+cd2)>=0){
					if(Cmd.search("Crt.H.Act<T>")>=0){
						switch(TurnCount){
							case 1:
								ItemSet("black","white","",Chr(cd1-1)+(cd2+1))
								ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1)+(cd2+1));break
							case 2:
								ItemSet("black","white","",Chr(cd1)+(cd2+1))
								ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1+1)+(cd2+1));break
							case 3:
								ItemSet("black","white","",Chr(cd1+1)+(cd2+1))
								ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1+1)+cd2);break
							case 4:
								ItemSet("black","white","",Chr(cd1+1)+cd2)
								ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1+1)+(cd2-1));break
							case 5:
								ItemSet("black","white","",Chr(cd1+1)+(cd2-1))
								ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1)+(cd2-1));break
							case 6:
								ItemSet("black","white","",Chr(cd1)+(cd2-1))
								ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1-1)+(cd2-1));break
							case 7:
								ItemSet("black","white","",Chr(cd1-1)+(cd2-1))
								ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1-1)+cd2);break
							case 8:
								ItemSet("black","white","",Chr(cd1-1)+cd2)
								ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1-1)+(cd2+1));break
						}
					}
					if(Cmd.search("Crt.H.Act<R>")>=0){
						switch(TurnCount){
							case 1:
							ItemSet("black","white","",Chr(cd1+1)+(cd2+1))
							ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1)+(cd2+1));break
							case 2:
							ItemSet("black","white","",Chr(cd1)+(cd2+1))
							ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1-1)+(cd2+1));break
							case 3:
							ItemSet("black","white","",Chr(cd1-1)+(cd2+1))
							ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1-1)+cd2);break
							case 4:
							ItemSet("black","white","",Chr(cd1-1)+cd2)
							ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1-1)+(cd2-1));break
							case 5:
							ItemSet("black","white","",Chr(cd1-1)+(cd2-1))
							ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1)+(cd2-1));break
							case 6:
							ItemSet("black","white","",Chr(cd1)+(cd2-1))
							ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1+1)+(cd2-1));break
							case 7:
							ItemSet("black","white","",Chr(cd1+1)+(cd2-1))
							ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1+1)+cd2);break
							case 8:
							ItemSet("black","white","",Chr(cd1+1)+cd2)
							ItemSet("olivedrab","darkolivegreen","Haber",Chr(cd1+1)+(cd2+1));break
						}
					}
				}
				if(coor(Chr(cd1)+cd2).value=="Q"&&coor(Chr(cd1)+cd2).style.backgroundColor=="black")ItemSet("black","white","",Chr(cd1)+cd2)
				if(Cmd.search("Crt.Q.Act>"+Chr(cd1)+cd2+":"+TurnCount+">")>=0){
					ItemSet("white","black","Quare",Chr(cd1)+cd2)
				}
				if(Cmd.search("Crt.Q.Act>"+Chr(cd1)+"N:"+TurnCount+">")>=0){
					ItemSet("white","black","Quare",Chr(cd1)+cd2)
				}
				if(Cmd.search("Crt.Q.Act>T"+cd2+":"+TurnCount+">")>=0){
					ItemSet("white","black","Quare",Chr(cd1)+cd2)
				}
				if(Cmd.search("Crt.Q.ARd>"+Chr(cd1)+cd2+":"+TurnCount+">")>=0){
					if(CrtQ==0){Random(0,0,2,1);if(r2==1){ItemSet("white","black","Quare",Chr(cd1)+cd2);CrtQ=1}}
				}
				if(Cmd.search("Crt.Q.ARd>"+Chr(cd1)+"N:"+TurnCount+">")>=0){
					if(CrtQ==0){Random(0,0,2,1);if(r2==1){ItemSet("white","black","Quare",Chr(cd1)+cd2);CrtQ=1}}
				}
				if(Cmd.search("Crt.Q.ARd>T"+cd2+":"+TurnCount+">")>=0){
					if(CrtQ==0){Random(0,0,2,1);if(r2==1){ItemSet("white","black","Quare",Chr(cd1)+cd2);CrtQ=1}}
				}
				if(coor(Chr(cd1)+cd2)){
				if(coor(Chr(cd1)+cd2).value=="F"||coor(Chr(cd1)+cd2).value=="B"||coor(Chr(cd1)+cd2).value=="V"||coor(Chr(cd1)+cd2).value=="Z"||coor(Chr(cd1)+cd2).value=="L"||coor(Chr(cd1)+cd2).value=="R"||coor(Chr(cd1)+cd2).value=="N")ItemSet("black","white","",Chr(cd1)+cd2)
				if(Cmd.search("Crt.N.Act")>=0){
					if(coor(Chr(cd1)+cd2).style.color=="black"&&coor(Chr(cd1)+cd2).style.backgroundColor=="white"){
						var spc=0
						if(coor(Chr(cd1+1)+parseInt(cd2+1)))if(coor(Chr(cd1+1)+parseInt(cd2+1)).value=="")spc++
						if(coor(Chr(cd1+1)+parseInt(cd2-1)))if(coor(Chr(cd1+1)+parseInt(cd2-1)).value=="")spc++
						if(coor(Chr(cd1-1)+parseInt(cd2+1)))if(coor(Chr(cd1-1)+parseInt(cd2+1)).value=="")spc++
						if(coor(Chr(cd1-1)+parseInt(cd2-1)))if(coor(Chr(cd1-1)+parseInt(cd2-1)).value=="")spc++
						if(coor(Chr(cd1+1)+cd2))if(coor(Chr(cd1+1)+cd2).value=="")spc++
						if(coor(Chr(cd1-1)+cd2))if(coor(Chr(cd1-1)+cd2).value=="")spc++
						if(coor(Chr(cd1)+(cd2+1)))if(coor(Chr(cd1)+(cd2+1)).value=="")spc++
						if(coor(Chr(cd1)+(cd2-1)))if(coor(Chr(cd1)+(cd2-1)).value=="")spc++
						if(spc==8) ItemSet("purple","black","Nasos",Chr(cd1)+cd2)
					}
				}
				if(Cmd.search("Crt.T.Act")>=0&&coor(Chr(cd1)+cd2).value=="T"&&CrtT==0){
					var R=Math.round(Math.random()*4)+1;ItemSet("black","white","",Chr(cd1)+cd2)
					switch(R){
					case 1:
						if(coor(Chr(cd1+1)+cd2)){
						ItemSet("steelblue","skyblue","Tiafu",Chr(cd1+1)+cd2);CrtT=1
						}else{
						ItemSet("steelblue","skyblue","Tiafu",Chr(cd1)+cd2)
						}break
					case 2:
						if(coor(Chr(cd1)+""+parseInt(cd2+1))){
						ItemSet("steelblue","skyblue","Tiafu",Chr(cd1)+parseInt(cd2+1));CrtT=1
						}else{
						ItemSet("steelblue","skyblue","Tiafu",Chr(cd1)+cd2)
						}break
					case 3:
						if(coor(Chr(cd1-1)+cd2)){
						ItemSet("steelblue","skyblue","Tiafu",Chr(cd1-1)+cd2);CrtT=1
						}else{
						ItemSet("steelblue","skyblue","Tiafu",Chr(cd1)+cd2)
						}break
					case 4:
						if(coor(Chr(cd1)+""+parseInt(cd2-1))){
						ItemSet("steelblue","skyblue","Tiafu",Chr(cd1)+parseInt(cd2-1));CrtT=1
						}else{
						ItemSet("steelblue","skyblue","Tiafu",Chr(cd1)+cd2)
						}break
					}
				}
				if(Cmd.search("Crt.C.Act")>=0&&coor(Chr(cd1)+cd2).style.backgroundColor=="indigo"&&CrtC==0){
				var R=Math.round(Math.random()*8)+1
					switch(R){
					case 1:
					if(coor(Chr(cd1)+parseInt(cd2+1))){
					if(coor(Chr(cd1)+parseInt(cd2+1)).value==""){ItemSet("white","indigo","Azaga",Chr(cd1)+parseInt(cd2+1));CrtC=1}break
					}
					case 2:
					if(coor(Chr(cd1)+parseInt(cd2-1))){
					if(coor(Chr(cd1)+parseInt(cd2-1)).value==""){ItemSet("white","indigo","Azaga",Chr(cd1)+parseInt(cd2-1));CrtC=1}break
					}
					case 3:
					if(coor(Chr(cd1+1)+parseInt(cd2-1))){
					if(coor(Chr(cd1+1)+parseInt(cd2-1)).value==""){ItemSet("white","indigo","Azaga",Chr(cd1+1)+parseInt(cd2-1));CrtC=1}break
					}
					case 4:
					if(coor(Chr(cd1-1)+parseInt(cd2-1))){
					if(coor(Chr(cd1-1)+parseInt(cd2-1)).value==""){ItemSet("white","indigo","Azaga",Chr(cd1-1)+parseInt(cd2-1));CrtC=1}break
					}
					case 5:
					if(coor(Chr(cd1+1)+parseInt(cd2+1))){
					if(coor(Chr(cd1+1)+parseInt(cd2+1)).value==""){ItemSet("white","indigo","Azaga",Chr(cd1+1)+parseInt(cd2+1));CrtC=1}break
					}
					case 6:
					if(coor(Chr(cd1-1)+parseInt(cd2+1))){
					if(coor(Chr(cd1-1)+parseInt(cd2+1)).value==""){ItemSet("white","indigo","Azaga",Chr(cd1-1)+parseInt(cd2+1));CrtC=1}break
					}
					case 7:
					if(coor(Chr(cd1+1)+cd2)){
					if(coor(Chr(cd1+1)+cd2).value==""){ItemSet("white","indigo","Azaga",Chr(cd1+1)+cd2);CrtC=1}break
					}
					case 8:
					if(coor(Chr(cd1-1)+cd2)){
					if(coor(Chr(cd1-1)+cd2).value==""){ItemSet("white","indigo","Azaga",Chr(cd1-1)+cd2);CrtC=1}break
					}
					}
				}
				if(Cmd.search("Crt.W.Act")>=0&&coor(Chr(cd1)+cd2).style.backgroundColor=="pink"&&CrtW==0){
				var R=Math.round(Math.random()*4)+1
					switch(R){
					case 1:
					if(coor(Chr(cd1)+parseInt(cd2+1))){ItemSet("purple","pink","Waler",Chr(cd1)+parseInt(cd2+1));CrtW=1}break
					case 2:
					if(coor(Chr(cd1)+parseInt(cd2-1))){ItemSet("purple","pink","Waler",Chr(cd1)+parseInt(cd2-1));CrtW=1}break
					case 3:
					if(coor(Chr(cd1+1)+cd2)){ItemSet("purple","pink","Waler",Chr(cd1+1)+cd2);CrtW=1}break
					case 4:
					if(coor(Chr(cd1-1)+cd2)){ItemSet("purple","pink","Waler",Chr(cd1-1)+cd2);CrtW=1}break
					}
				}
			}
		}
	}
	for(C=1;C<100;C++){
		if(Cmd.search("Crt.V.Act<"+C+">")>=0){
			for(g=1;g<=C;g++){Random(9,65,9,1)
			if(coor(r1+r2).value==""&&coor(r1+r2).style.backgroundColor=="white"&&coor(r1+r2).style.color=="black")ItemSet("brown","darkorange","Vitor",r1+r2)
			}
		}
		if(Cmd.search("Crt.Z.Act<"+C+">")>=0){
			for(g=1;g<=C;g++){Random(9,65,9,1)
			if(coor(r1+r2).style.backgroundColor=="white"&&coor(r1+r2).style.color=="black")ItemSet("red","black","Zager",r1+r2)
			}
		}
	}
	if(Cmd.search("Crt.F.Act")>=0){Random(9,65,9,1)
	if(coor(r1+r2).value==""&&coor(r1+r2).style.backgroundColor=="white"&&coor(r1+r2).style.color=="black")ItemSet("skyblue","blue","Fixia",r1+r2)
	}
	if(Cmd.search("Crt.B.Act")>=0){Random(9,65,9,1)
	if(coor(r1+r2).style.backgroundColor=="white"&&coor(r1+r2).style.color=="black")ItemSet("Red","darkRed","Bilaz",r1+r2)
	}
	if(Cmd.search("Crt.L.Act")>=0){Random(9,65,4,1)
	if(coor(r1+r2).value==""&&coor(r1+r2).style.backgroundColor=="white"&&coor(r1+r2).style.color=="black")ItemSet("Lime","darkgreen","Luqus",r1+r2)
	}
	if(Cmd.search("Crt.R.Act")>=0){Random(9,65,4,5)
	if(coor(r1+r2).style.backgroundColor=="white"&&coor(r1+r2).style.color=="black")ItemSet("gold","darkorange","Rader",r1+r2)
	}
}
if(Cmd.search("Crt.P.Act")>=0){
	var R=Math.round(Math.random()*8)+1
	switch(R){
		case 1:
		if(coor('A1').value=="")ItemSet("dimgray","black","Poken","A1");break
		case 2:
		if(coor('A5').value=="")ItemSet("dimgray","black","Poken","A5");break
		case 3:
		if(coor('A9').value=="")ItemSet("dimgray","black","Poken","A9");break
		case 4:
		if(coor('I1').value=="")ItemSet("dimgray","black","Poken","I1");break
		case 5:
		if(coor('I5').value=="")ItemSet("dimgray","black","Poken","I5");break
		case 6:
		if(coor('I9').value=="")ItemSet("dimgray","black","Poken","I9");break
		case 7:
		if(coor('E1').value=="")ItemSet("dimgray","black","Poken","E1");break
		case 8:
		if(coor('E9').value=="")ItemSet("dimgray","black","Poken","E9");break
	}
}
}//角色規則
function ShapeRule(){
var Cmd=coor('OFD').value
	var ScoreO=0,ScoreX=0
	for(cd1=65;cd1<74;cd1++){
		for(cd2=1;cd2<10;cd2++){
			if(Cmd.search("Shp.crs")>=0){
				if(coor(Chr(cd1)+cd2).value==O){var ckso=0,cksx=0
				if(coor(Chr(cd1)+(cd2-1)))if(coor(Chr(cd1)+(cd2-1)).value==O)ckso++
				if(coor(Chr(cd1)+(cd2+1)))if(coor(Chr(cd1)+(cd2+1)).value==O)ckso++
				if(coor(Chr(cd1-1)+cd2))if(coor(Chr(cd1-1)+cd2).value==O)ckso++
				if(coor(Chr(cd1+1)+cd2))if(coor(Chr(cd1+1)+cd2).value==O)ckso++
				if(coor(Chr(cd1)+(cd2-1)))if(coor(Chr(cd1)+(cd2-1)).value==X)cksx++
				if(coor(Chr(cd1)+(cd2+1)))if(coor(Chr(cd1)+(cd2+1)).value==X)cksx++
				if(coor(Chr(cd1-1)+cd2))if(coor(Chr(cd1-1)+cd2).value==X)cksx++
				if(coor(Chr(cd1+1)+cd2))if(coor(Chr(cd1+1)+cd2).value==X)cksx++
				if(ckso==4){
					if(Cmd.search("Shp.crs.nml")>=0)Winner("O完成十字形，O獲勝")
					if(Cmd.search("Shp.crs.scr")>=0)ScoreO++
				}
				if(cksx==4){
					if(Cmd.search("Shp.crs.kil")>=0)ItemSet("black","white","",Chr(cd1)+cd2)
					if(Cmd.search("Shp.crs.rpl")>=0)ItemSet("black","white","X",Chr(cd1)+cd2)
				}
				}
				if(coor(Chr(cd1)+cd2).value==X){var ckso=0,cksx=0
				if(coor(Chr(cd1)+(cd2-1)))if(coor(Chr(cd1)+(cd2-1)).value==O)ckso++
				if(coor(Chr(cd1)+(cd2+1)))if(coor(Chr(cd1)+(cd2+1)).value==O)ckso++
				if(coor(Chr(cd1-1)+cd2))if(coor(Chr(cd1-1)+cd2).value==O)ckso++
				if(coor(Chr(cd1+1)+cd2))if(coor(Chr(cd1+1)+cd2).value==O)ckso++
				if(coor(Chr(cd1)+(cd2-1)))if(coor(Chr(cd1)+(cd2-1)).value==X)cksx++
				if(coor(Chr(cd1)+(cd2+1)))if(coor(Chr(cd1)+(cd2+1)).value==X)cksx++
				if(coor(Chr(cd1-1)+cd2))if(coor(Chr(cd1-1)+cd2).value==X)cksx++
				if(coor(Chr(cd1+1)+cd2))if(coor(Chr(cd1+1)+cd2).value==X)cksx++
				if(cksx==4){
					if(Cmd.search("Shp.crs.nml")>=0)Winner("X完成十字形，X獲勝")
					if(Cmd.search("Shp.crs.scr")>=0)ScoreX++
				}
				if(ckso==4){
					if(Cmd.search("Shp.crs.kil")>=0)ItemSet("black","white","",Chr(cd1)+cd2)
					if(Cmd.search("Shp.crs.rpl")>=0)ItemSet("black","white","O",Chr(cd1)+cd2)
				}
				}
			}
			if(Cmd.search("Shp.sqr")>=0){
				if(coor(Chr(cd1)+cd2).value==O){var cks=0
				if(coor(Chr(cd1)+(cd2+1)))if(coor(Chr(cd1)+(cd2+1)).value==O)cks++
				if(coor(Chr(cd1+1)+cd2))if(coor(Chr(cd1+1)+cd2).value==O)cks++
				if(coor(Chr(cd1+1)+(cd2+1)))if(coor(Chr(cd1+1)+(cd2+1)).value==O)cks++
				if(cks==3){
				if(Cmd.search("Shp.sqr.nml")>=0)Winner("O完成方形，O獲勝")
				if(Cmd.search("Shp.sqr.scr")>=0)ScoreO++
				}
				}
				if(coor(Chr(cd1)+cd2).value==X){var cks=0
				if(coor(Chr(cd1)+(cd2+1)))if(coor(Chr(cd1)+(cd2+1)).value==X)cks++
				if(coor(Chr(cd1+1)+cd2))if(coor(Chr(cd1+1)+cd2).value==X)cks++
				if(coor(Chr(cd1+1)+(cd2+1)))if(coor(Chr(cd1+1)+(cd2+1)).value==X)cks++
				if(cks==3){
				if(Cmd.search("Shp.sqr.nml")>=0)Winner("X完成方形，X獲勝")
				if(Cmd.search("Shp.sqr.scr")>=0)ScoreX++
				}
				}
			}
			if(Cmd.search("Shp.X")>=0){
				if(coor(Chr(cd1)+cd2).value==O){var ckso=0,cksx=0
				if(coor(Chr(cd1-1)+(cd2-1)))if(coor(Chr(cd1-1)+(cd2-1)).value==O)ckso++
				if(coor(Chr(cd1+1)+(cd2+1)))if(coor(Chr(cd1+1)+(cd2+1)).value==O)ckso++
				if(coor(Chr(cd1-1)+(cd2+1)))if(coor(Chr(cd1-1)+(cd2+1)).value==O)ckso++
				if(coor(Chr(cd1+1)+(cd2-1)))if(coor(Chr(cd1+1)+(cd2-1)).value==O)ckso++
				if(coor(Chr(cd1-1)+(cd2-1)))if(coor(Chr(cd1-1)+(cd2-1)).value==X)cksx++
				if(coor(Chr(cd1+1)+(cd2+1)))if(coor(Chr(cd1+1)+(cd2+1)).value==X)cksx++
				if(coor(Chr(cd1-1)+(cd2+1)))if(coor(Chr(cd1-1)+(cd2+1)).value==X)cksx++
				if(coor(Chr(cd1+1)+(cd2-1)))if(coor(Chr(cd1+1)+(cd2-1)).value==X)cksx++
				if(ckso==4){
				if(Cmd.search("Shp.X.nml")>=0)Winner("O完成叉字形，O獲勝")
				if(Cmd.search("Shp.X.scr")>=0)ScoreO++
				}
				if(cksx==4){
				if(Cmd.search("Shp.X.kil")>=0)ItemSet("black","white","",Chr(cd1)+cd2)
				if(Cmd.search("Shp.X.rpl")>=0)ItemSet("black","white","X",Chr(cd1)+cd2)
				}
				}
				if(coor(Chr(cd1)+cd2).value==X){var ckso=0,cksx=0
				if(coor(Chr(cd1-1)+(cd2-1)))if(coor(Chr(cd1-1)+(cd2-1)).value==X)cksx++
				if(coor(Chr(cd1+1)+(cd2+1)))if(coor(Chr(cd1+1)+(cd2+1)).value==X)cksx++
				if(coor(Chr(cd1-1)+(cd2+1)))if(coor(Chr(cd1-1)+(cd2+1)).value==X)cksx++
				if(coor(Chr(cd1+1)+(cd2-1)))if(coor(Chr(cd1+1)+(cd2-1)).value==X)cksx++
				if(coor(Chr(cd1-1)+(cd2-1)))if(coor(Chr(cd1-1)+(cd2-1)).value==O)ckso++
				if(coor(Chr(cd1+1)+(cd2+1)))if(coor(Chr(cd1+1)+(cd2+1)).value==O)ckso++
				if(coor(Chr(cd1-1)+(cd2+1)))if(coor(Chr(cd1-1)+(cd2+1)).value==O)ckso++
				if(coor(Chr(cd1+1)+(cd2-1)))if(coor(Chr(cd1+1)+(cd2-1)).value==O)ckso++
				if(cksx==4){
				if(Cmd.search("Shp.X.nml")>=0)Winner("X完成叉字形，X獲勝")
				if(Cmd.search("Shp.X.scr")>=0)ScoreX++
				}
				if(ckso==4){
				if(Cmd.search("Shp.X.kil")>=0)ItemSet("black","white","",Chr(cd1)+cd2)
				if(Cmd.search("Shp.X.rpl")>=0)ItemSet("black","white","O",Chr(cd1)+cd2)
				}
				}
			}
			for(c=2;c<10;c++){
				if(coor(Chr(cd1)+cd2).value==O||coor(Chr(cd1)+cd2).value==X){
				if(Cmd.search("Shp.H.nml<"+c+">")>=0){
				var cks=0
				for(d=1;d<=c-1;d++){
					if(coor(Chr(cd1+d)+cd2))if(coor(Chr(cd1+d)+cd2).value==coor(Chr(cd1)+cd2).value)cks++
				}
				if(cks==c-1)Winner(coor(Chr(cd1)+cd2).value+"完成橫線，"+coor(Chr(cd1)+cd2).value+"獲勝")
				}
				if(Cmd.search("Shp.V.nml<"+c+">")>=0){
				var cks=0
				for(d=1;d<=c-1;d++){
					if(coor(Chr(cd1)+(cd2+d)))if(coor(Chr(cd1)+(cd2+d)).value==coor(Chr(cd1)+cd2).value)cks++
				}
				if(cks==c-1)Winner(coor(Chr(cd1)+cd2).value+"完成直線，"+coor(Chr(cd1)+cd2).value+"獲勝")
				}
				if(Cmd.search("Shp.Rh.nml<"+c+">")>=0){
				var cks =0
				for(d=1;d<=c-1;d++){
					if(coor(Chr(cd1+d)+(cd2+d)))if(coor(Chr(cd1+d)+(cd2+d)).value==coor(Chr(cd1)+cd2).value)cks++
				}
				if(cks==c-1)Winner(coor(Chr(cd1)+cd2).value+"完成反斜線，"+coor(Chr(cd1)+cd2).value+"獲勝")
				}
				if(Cmd.search("Shp.Sh.nml<"+c+">")>=0){
				var cks=0
				for(d=1;d<=c-1;d++){
					if(coor(Chr(cd1+d)+(cd2-d)))if(coor(Chr(cd1+d)+(cd2-d)).value==coor(Chr(cd1)+cd2).value)cks++
				}
				if(cks==c-1)Winner(coor(Chr(cd1)+cd2).value+"完成斜線，"+coor(Chr(cd1)+cd2).value+"獲勝")
				}
				}
				if(coor(Chr(cd1)+cd2).value==O){
					if(Cmd.search("Shp.H")>=0){var cks=0,typ=""
						for(d=1;d<10;d++){
							if(coor(Chr(cd1+d)+cd2)){
								if(coor(Chr(cd1+d)+cd2).value==X){cks++}else{typ=coor(Chr(cd1+d)+cd2).value;break}
								}
						}
						if(typ==O){
							for(d=1;d<=cks;d++){
								if(Cmd.search("Shp.H.kil")>=0)if(coor(Chr(cd1+d)+cd2).value==X)coor(Chr(cd1+d)+cd2).value=""
								if(Cmd.search("Shp.H.hrm")>=0)if(coor(Chr(cd1+d)+cd2).value==X)ItemSet("maroon","white","X.",Chr(cd1+d)+cd2)
								if(Cmd.search("Shp.H.rpl")>=0)if(coor(Chr(cd1+d)+cd2).value==X)coor(Chr(cd1+d)+cd2).value=O
							}
						}
					}
					if(Cmd.search("Shp.V")>=0){var cks=0,typ=""
						for(d=1;d<10;d++){
						if(coor(Chr(cd1)+(cd2+d))){
							if(coor(Chr(cd1)+(cd2+d)).value==X){cks++}else{typ=coor(Chr(cd1)+(cd2+d)).value;break}
							}
						}
						if(typ==O){
							for(d=1;d<=cks;d++){
								if(Cmd.search("Shp.V.kil")>=0)if(coor(Chr(cd1)+(cd2+d)).value==X)coor(Chr(cd1)+(cd2+d)).value=""
								if(Cmd.search("Shp.V.hrm")>=0)if(coor(Chr(cd1)+(cd2+d)).value==X)ItemSet("maroon","white","X.",Chr(cd1)+(cd2+d))
								if(Cmd.search("Shp.V.rpl")>=0)if(coor(Chr(cd1)+(cd2+d)).value==X)coor(Chr(cd1)+(cd2+d)).value=O
								}
						}
					}
					if(Cmd.search("Shp.Rh")>=0){var cks=0,typ=""
						for(d=1;d<10;d++){
							if(coor(Chr(cd1+d)+(cd2+d))){
								if(coor(Chr(cd1+d)+(cd2+d)).value==X){cks++}else{typ=coor(Chr(cd1+d)+(cd2+d)).value;break}
								}
							}
						if(typ==O){
								for(d=1;d<=cks;d++){
									if(Cmd.search("Shp.Rh.kil")>=0)if(coor(Chr(cd1+d)+(cd2+d)).value==X)coor(Chr(cd1+d)+(cd2+d)).value=""
									if(Cmd.search("Shp.Rh.hrm")>=0)if(coor(Chr(cd1+d)+(cd2+d)).value==X)ItemSet("maroon","white","X.",Chr(cd1+d)+(cd2+d))
									if(Cmd.search("Shp.Rh.rpl")>=0)if(coor(Chr(cd1+d)+(cd2+d)).value==X)coor(Chr(cd1+d)+(cd2+d)).value=O
								}
						}
					}
					if(Cmd.search("Shp.Sh")>=0){var cks=0,typ=""
						for(d=1;d<10;d++){
							if(coor(Chr(cd1+d)+(cd2-d))){
								if(coor(Chr(cd1+d)+(cd2-d)).value==X){cks++}else{typ=coor(Chr(cd1+d)+(cd2-d)).value;break}
											}
										}
						if(typ==O){
						for(d=1;d<=cks;d++){
							if(Cmd.search("Shp.Sh.kil")>=0)if(coor(Chr(cd1+d)+(cd2-d)).value==X)coor(Chr(cd1+d)+(cd2-d)).value=""
							if(Cmd.search("Shp.Sh.hrm")>=0)if(coor(Chr(cd1+d)+(cd2-d)).value==X)ItemSet("maroon","white","X.",Chr(cd1+d)+(cd2-d))
							if(Cmd.search("Shp.Sh.rpl")>=0)if(coor(Chr(cd1+d)+(cd2-d)).value==X)coor(Chr(cd1+d)+(cd2-d)).value=O
						}
						}
					}
				}
				if(coor(Chr(cd1)+cd2).value==X){
					if(Cmd.search("Shp.H")>=0){var cks=0,typ=""
						for(d=1;d<10;d++){
							if(coor(Chr(cd1+d)+cd2)){
								if(coor(Chr(cd1+d)+cd2).value==O){cks++}else{typ=coor(Chr(cd1+d)+cd2).value;break}
								}
						}
						if(typ==X){
							for(d=1;d<=cks;d++){
								if(Cmd.search("Shp.H.kil")>=0)if(coor(Chr(cd1+d)+cd2).value==O)coor(Chr(cd1+d)+cd2).value=""
								if(Cmd.search("Shp.H.hrm")>=0)if(coor(Chr(cd1+d)+cd2).value==O)ItemSet("maroon","white","O.",Chr(cd1+d)+cd2)
								if(Cmd.search("Shp.H.rpl")>=0)if(coor(Chr(cd1+d)+cd2).value==O)coor(Chr(cd1+d)+cd2).value=X
							}
						}
					}
					if(Cmd.search("Shp.V")>=0){var cks=0,typ=""
						for(d=1;d<10;d++){
						if(coor(Chr(cd1)+(cd2+d))){
							if(coor(Chr(cd1)+(cd2+d)).value==O){cks++}else{typ=coor(Chr(cd1)+(cd2+d)).value;break}
							}
						}
						if(typ==X){
							for(d=1;d<=cks;d++){
								if(Cmd.search("Shp.V.kil")>=0)if(coor(Chr(cd1)+(cd2+d)).value==O)coor(Chr(cd1)+(cd2+d)).value=""
								if(Cmd.search("Shp.V.hrm")>=0)if(coor(Chr(cd1)+(cd2+d)).value==O)ItemSet("maroon","white","O.",Chr(cd1)+(cd2+d))
								if(Cmd.search("Shp.V.rpl")>=0)if(coor(Chr(cd1)+(cd2+d)).value==O)coor(Chr(cd1)+(cd2+d)).value=X
								}
						}
					}
					if(Cmd.search("Shp.Rh")>=0){var cks=0,typ=""
						for(d=1;d<10;d++){
							if(coor(Chr(cd1+d)+(cd2+d))){
								if(coor(Chr(cd1+d)+(cd2+d)).value==O){cks++}else{typ=coor(Chr(cd1+d)+(cd2+d)).value;break}
								}
							}
						if(typ==X){
								for(d=1;d<=cks;d++){
									if(Cmd.search("Shp.Rh.kil")>=0)if(coor(Chr(cd1+d)+(cd2+d)).value==O)coor(Chr(cd1+d)+(cd2+d)).value=""
									if(Cmd.search("Shp.Rh.hrm")>=0)if(coor(Chr(cd1+d)+(cd2+d)).value==O)ItemSet("maroon","white","O.",Chr(cd1+d)+(cd2+d))
									if(Cmd.search("Shp.Rh.rpl")>=0)if(coor(Chr(cd1+d)+(cd2+d)).value==O)coor(Chr(cd1+d)+(cd2+d)).value=X
								}
						}
					}
					if(Cmd.search("Shp.Sh")>=0){var cks=0,typ=""
						for(d=1;d<10;d++){
							if(coor(Chr(cd1+d)+(cd2-d))){
								if(coor(Chr(cd1+d)+(cd2-d)).value==O){cks++}else{typ=coor(Chr(cd1+d)+(cd2-d)).value;break}
											}
										}
						if(typ==X){
						for(d=1;d<=cks;d++){
							if(Cmd.search("Shp.Sh.kil")>=0)if(coor(Chr(cd1+d)+(cd2-d)).value==O)coor(Chr(cd1+d)+(cd2-d)).value=""
							if(Cmd.search("Shp.Sh.hrm")>=0)if(coor(Chr(cd1+d)+(cd2-d)).value==O)ItemSet("maroon","white","O.",Chr(cd1+d)+(cd2-d))
							if(Cmd.search("Shp.Sh.rpl")>=0)if(coor(Chr(cd1+d)+(cd2-d)).value==O)coor(Chr(cd1+d)+(cd2-d)).value=X
						}
						}
					}
				}
			}
		}
	}
	if(TotalScore!=0){
	if(TotalScore==ScoreX)Winner("X得分較高，X獲勝")
	if(TotalScore==ScoreO)Winner("O得分較高，O獲勝")
	}else{
	if(ScoreO>ScoreX+1)Winner("O得分較高，O獲勝")
	if(ScoreX>ScoreO+1)Winner("X得分較高，X獲勝")
	}
}//形狀規則
function Winner(Msg){alert(Msg);CleanBoard()}//勝負訊息
function ItemSet(FC,BC,Txt,Crd){
if(coor(Crd)){
coor(Crd).style.backgroundColor=BC;coor(Crd).style.color=FC
coor(Crd).value=Txt.substr(0,1)
}
}//建立物件
function CircleCrt(FC,BC,Txt,Crd){
var crd1=Crd.charCodeAt(Crd.substr(0,1)),crd2=parseInt(Crd.substr(1,1))
for(var cd1=crd1-1;cd1<=crd1+1;cd1++){
	for(var cd2=crd2-1;cd2<=crd2+1;cd2++){
		if(coor(Chr(cd1)+cd2)){
			ItemSet(FC,BC,Txt,Chr(cd1)+cd2)
		}
	}
}
}//環狀建立角色
function CircleSym(Txt,Crd){
var crd1=Crd.charCodeAt(Crd.substr(0,1)),crd2=parseInt(Crd.substr(1,1))
for(var cd1=crd1-1;cd1<=crd1+1;cd1++){
	for(var cd2=crd2-1;cd2<=crd2+1;cd2++){
		if(coor(Chr(cd1)+cd2)&&coor(Chr(cd1)+cd2).value!=""){
			if(coor(Chr(cd1)+cd2).value!=" ")coor(Chr(cd1)+cd2).value=Txt.substr(0,1)
		}
	}
}
}//環狀建立符號
function CircleAra(Txt,Crd){
var crd1=Crd.charCodeAt(Crd.substr(0,1)),crd2=parseInt(Crd.substr(1,1))
for(cd1=crd1-1;cd1<=crd1+1;cd1++){
	for(cd2=crd2-1;cd2<=crd2+1;cd2++){
		if(coor(Chr(cd1)+cd2)){
			if(coor(Chr(cd1)+cd2).style.backgroundColor=="white"&&coor(Chr(cd1)+cd2).style.color=="black"){
			if(Txt=="D")ItemSet("black","crimson",coor(Chr(cd1)+cd2).value,Chr(cd1)+cd2)
			if(Txt=="K")ItemSet("black","royalblue",coor(Chr(cd1)+cd2).value,Chr(cd1)+cd2)
			if(Txt=="Q")ItemSet("black","palevioletred",coor(Chr(cd1)+cd2).value,Chr(cd1)+cd2)
			if(Txt=="H")ItemSet("black","lightsteelblue",coor(Chr(cd1)+cd2).value,Chr(cd1)+cd2)
			if(Txt=="U")ItemSet("black","mediumvioletred",coor(Chr(cd1)+cd2).value,Chr(cd1)+cd2)
			if(Txt=="Y")ItemSet("black","steelblue",coor(Chr(cd1)+cd2).value,Chr(cd1)+cd2)
			ItemSet("black","white",coor(Crd).value,Crd)
			}
			if(coor(Chr(cd1)+cd2).value==""){
				if(Txt=="E")ItemSet("black","firebrick",coor(Chr(cd1)+cd2).value,Chr(cd1)+cd2)
				if(Txt=="T")ItemSet("black","powderblue",coor(Chr(cd1)+cd2).value,Chr(cd1)+cd2)
			}
		}
	}
}
}//環狀建立區域
function Random(cd1Start,cd1End,cd2Start,cd2End){
r1=Chr(Math.floor(Math.random()*cd1Start)+cd1End)
r2=Math.floor(Math.random()*cd2Start)+cd2End
}//隨機座標
function Blood(Crd,Point){
switch(Point){
	case 1:
	if(coor(Crd)&&coor(Crd).value==Q){
		if(coor(Crd).style.color=="coral")coor(Crd).style.color="maroon"
		if(coor(Crd).style.color=="green")coor(Crd).style.color="coral"
		if(coor(Crd).style.color=="black")coor(Crd).style.color="green"
	}break;
	case 2:
	if(coor(Crd)&&coor(Crd).value==Q){
		if(coor(Crd).style.color=="coral")coor(Crd).style.color="maroon"
		if(coor(Crd).style.color=="green")coor(Crd).style.color="marron"
		if(coor(Crd).style.color=="black")coor(Crd).style.color="coral"
	}break;
	case 3:
	if(coor(Crd)&&coor(Crd).value==Q){
		coor(Crd).style.color="maroon"
	}break;
}
document.all.Weapon.style.display='none';BasicRule();Writer()
if(coor(Crd).style.color=="maroon")coor(Crd).value=coor(Crd).value+" "
}//血量計算
function Counter(){
var Cmd=coor('OFD').value,CrtQ=0
if(Turn>=TurnStart&&Turn<=TurnEnd){
TimeCount++
if(TimeCount>=DAct)TimeCount=1
if(Cmd.search("Crt.D.Dym<V>")>=0){
	for(i=65;i<74;i++){
		if(coor(Chr(i)+TimeCount).value=="D"&&coor(Chr(i)+TimeCount).style.color=="red"){ItemSet("black","white","",Chr(i)+TimeCount)
			if(TimeCount==9){
				ItemSet("red","dimgray","Diaxu",Chr(i)+"1")
			}else{
				ItemSet("red","dimgray","Diaxu",Chr(i)+(TimeCount+1))
			}
		}
	}
}
if(Cmd.search("Crt.D.Dym<H>")>=0){
	for(i=1;i<10;i++){
		if(coor(Chr(TimeCount+64)+i).value=="D"&&coor(Chr(TimeCount+64)+i).style.color=="red"){
	ItemSet("black","white","",Chr(TimeCount+64)+i)
			if(TimeCount==9){
				ItemSet("red","dimgray","Diaxu","A"+i)
			}else{
				ItemSet("red","dimgray","Diaxu",Chr(TimeCount+65)+i)
			}
		}
	}
}
for(cd1=65;cd1<74;cd1++){
	for(cd2=1;cd2<10;cd2++){
		if(Cmd.search("I"+cd1+cd2)>=0){
			if(Cmd.search("Crt.I.Dym<T>")>=0){
				switch(TimeCount){
				case 2:
				ItemSet("black","white","",Chr(cd1)+cd2);ItemSet("white","silver","Ibers",Chr(cd1-1)+cd2);break
				case 3:
				ItemSet("black","white","",Chr(cd1-1)+cd2);ItemSet("white","silver","Ibers",Chr(cd1-1)+(cd2+1));break
				case 4:
				ItemSet("black","white","",Chr(cd1-1)+(cd2+1));ItemSet("white","silver","Ibers",Chr(cd1)+(cd2+1));break
				case 5:
				ItemSet("black","white","",Chr(cd1)+(cd2+1));ItemSet("white","silver","Ibers",Chr(cd1)+cd2);break
				}
			}
			if(Cmd.search("Crt.I.Dym<R>")>=0){
				switch(TimeCount){
				case 2:
				ItemSet("black","white","",Chr(cd1)+cd2);ItemSet("white","silver","Ibers",Chr(cd1+1)+cd2);break
				case 3:
				ItemSet("black","white","",Chr(cd1+1)+cd2);ItemSet("white","silver","Ibers",Chr(cd1+1)+(cd2+1));break
				case 4:
				ItemSet("black","white","",Chr(cd1+1)+(cd2+1));ItemSet("white","silver","Ibers",Chr(cd1)+(cd2+1));break
				case 5:
				ItemSet("black","white","",Chr(cd1)+(cd2+1));ItemSet("white","silver","Ibers",Chr(cd1)+cd2);break
				}
			}
		}
		if(Cmd.search("U"+cd1+cd2)>=0){
			if(Cmd.search("Crt.U.Dym<T>")>=0){
				switch(TimeCount){
				case 1:
				ItemSet("black","lightgray","",Chr(cd1+1)+(cd2+1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1)+(cd2+1));break
				case 2:
				ItemSet("black","lightgray","",Chr(cd1)+(cd2+1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1-1)+(cd2+1));break
				case 3:
				ItemSet("black","lightgray","",Chr(cd1-1)+(cd2+1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1-1)+cd2);break
				case 4:
				ItemSet("black","lightgray","",Chr(cd1-1)+cd2);ItemSet("midnightblue","orangered","Uinos",Chr(cd1-1)+(cd2-1));break
				case 5:
				ItemSet("black","lightgray","",Chr(cd1-1)+(cd2-1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1)+(cd2-1));break
				case 6:
				ItemSet("black","lightgray","",Chr(cd1)+(cd2-1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1+1)+(cd2-1));break
				case 7:
				ItemSet("black","lightgray","",Chr(cd1+1)+(cd2-1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1+1)+cd2);break
				case 8:
				ItemSet("black","lightgray","",Chr(cd1+1)+cd2);ItemSet("midnightblue","orangered","Uinos",Chr(cd1+1)+(cd2+1));break
				}
			}
			if(Cmd.search("Crt.U.Dym<R>")>=0){
				switch(TimeCount){
				case 1:
				ItemSet("black","lightgray","",Chr(cd1-1)+(cd2+1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1)+(cd2+1));break
				case 2:
				ItemSet("black","lightgray","",Chr(cd1)+(cd2+1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1+1)+(cd2+1));break
				case 3:
				ItemSet("black","lightgray","",Chr(cd1+1)+(cd2+1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1+1)+cd2);break
				case 4:
				ItemSet("black","lightgray","",Chr(cd1+1)+cd2);ItemSet("midnightblue","orangered","Uinos",Chr(cd1+1)+(cd2-1));break
				case 5:
				ItemSet("black","lightgray","",Chr(cd1+1)+(cd2-1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1)+(cd2-1));break
				case 6:
				ItemSet("black","lightgray","",Chr(cd1)+(cd2-1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1-1)+(cd2-1));break
				case 7:
				ItemSet("black","lightgray","",Chr(cd1-1)+(cd2-1));ItemSet("midnightblue","orangered","Uinos",Chr(cd1-1)+cd2);break
				case 8:
				ItemSet("black","lightgray","",Chr(cd1-1)+cd2);ItemSet("midnightblue","orangered","Uinos",Chr(cd1-1)+(cd2+1));break
				}
			}
		}
		if(Cmd.search("Crt.Q.D")>=0&&coor(Chr(cd1)+cd2).value=="Q"&&coor(Chr(cd1)+cd2).style.backgroundColor=="black")ItemSet("black","white","",Chr(cd1)+cd2)
		if(Cmd.search("Crt.Q.Dym>"+Chr(cd1)+cd2+":"+TimeCount+">")>=0){
			ItemSet("white","black","Quare",Chr(cd1)+cd2)
		}
		if(Cmd.search("Crt.Q.Dym>"+Chr(cd1)+"N:"+TimeCount+">")>=0){
			ItemSet("white","black","Quare",Chr(cd1)+cd2)
		}
		if(Cmd.search("Crt.Q.Dym>T"+cd2+":"+TimeCount+">")>=0){
			ItemSet("white","black","Quare",Chr(cd1)+cd2)
		}
		if(Cmd.search("Crt.Q.DRd>"+Chr(cd1)+cd2+":"+TimeCount+">")>=0){
			if(CrtQ==0){Random(0,0,2,1);if(r2==1){ItemSet("white","black","Quare",Chr(cd1)+cd2);CrtQ=1}}
		}
		if(Cmd.search("Crt.Q.DRd>"+Chr(cd1)+"N:"+TimeCount+">")>=0){
			if(CrtQ==0){Random(0,0,2,1);if(r2==1){ItemSet("white","black","Quare",Chr(cd1)+cd2);CrtQ=1}}
		}
		if(Cmd.search("Crt.Q.DRd>T"+cd2+":"+TimeCount+">")>=0){
			if(CrtQ==0){Random(0,0,2,1);if(r2==1){ItemSet("white","black","Quare",Chr(cd1)+cd2);CrtQ=1}}
		}
	}
}
}
setTimeout(Counter,1000)
}//動態角色
function Direction(){
var Cmd=coor("OFD").value, Content="";Chs=""
for(C=1;C<100;C++){
if(Cmd.search("T<"+C+",")>=0)Content=Content+"功能初始回合為"+C+ "\n"
if(Cmd.search(","+C+">")>=0)Content=Content+"功能結束回合為"+C+ "\n"
if(Cmd.search("<T:"+C+">")>=0)Content=Content+"預載為第"+C+"回合\n"
if(Cmd.search("<S:"+C+">")>=0)Content=Content+"得分數為"+C+"分\n"
if(Cmd.search("<DA:"+C+">")>=0)Content=Content+"天神Quare採用畫格的方式，每"+C+"秒重複\n"
if(Cmd.search("<TA:"+C+">")>=0)Content=Content+"天神Quare採用畫格的方式，每"+C+"回合重複\n"
if(Cmd.search("Crt.J.Rnd<"+C+">")>=0)Content=Content+"食人妖Junky將生成"+C+"只\n"
if(Cmd.search("Crt.G.Rnd<"+C+">")>=0)Content=Content+"石像鬼Guris將生成"+C+"只\n"
if(Cmd.search("Crt.K.Rnd<"+C+">")>=0)Content=Content+"變形怪Kiase將生成"+C+"只\n"
if(Cmd.search("Crt.S.Rnd<"+C+">")>=0)Content=Content+"村民Sinbo將生成"+C+"只\n"
if(Cmd.search("Crt.E.Rnd<"+C+">")>=0)Content=Content+"將軍Esomo將生成"+C+"只\n"
if(Cmd.search("Crt.M.Rnd<"+C+">")>=0)Content=Content+"幽靈Mokla將生成"+C+"只\n"
if(Cmd.search("Crt.Z.Act<"+C+">")>=0)Content=Content+"魔族Zager每回合將生成"+C+"只\n"
if(Cmd.search("Crt.V.Act<"+C+">")>=0)Content=Content+"精靈Vitor每回合將生成"+C+"只\n"
if(Cmd.search("Ara.P.Rnd<"+C+">")>=0)Content=Content+"將生成"+C+"個禁區\n"
if(Cmd.search("Ara.S.Rnd<"+C+">")>=0)Content=Content+"將生成"+C+"個得分區\n"
if(Cmd.search("Ara.F.Rnd<"+C+">")>=0)Content=Content+"將生成"+C+"個安全區\n"
if(Cmd.search("Ara.M.Rnd<"+C+">")>=0)Content=Content+"將生成"+C+"個陷阱區\n"
if(Cmd.search("Ara.B.Rnd<"+C+">")>=0)Content=Content+"將生成"+C+"個障礙物\n"
if(Cmd.search("Ara.L.Rnd<"+C+">")>=0)Content=Content+"將生成"+C+"個滅區\n"
if(Cmd.search("Ara.R.Rnd<"+C+">")>=0)Content=Content+"將生成"+C+"個創區\n"
if(Cmd.search("Shp.H.nml<"+C+">")>=0)Content=Content+"以"+C+"個符號形成橫線取勝\n"
if(Cmd.search("Shp.V.nml<"+C+">")>=0)Content=Content+"以"+C+"個符號形成直線取勝\n"
if(Cmd.search("Shp.Rh.nml<"+C+">")>=0)Content=Content+"以"+C+"個符號形成斜線取勝\n"
if(Cmd.search("Shp.Sh.nml<"+C+">")>=0)Content=Content+"以"+C+"個符號形成反斜線取勝\n"
if(Cmd.search("Rul.Ara.prt<"+C+">")>=0&&C<8&&C>3)Content=Content+"將有"+C+"個區塊\n"
if(Cmd.search("Rul.Min<"+C+">")>=0&&C<8)Content=Content+"將有"+C+"個地雷\n"
}
if(Cmd.search("Sym.Ara.D")>=0)Content=Content+"首回合設置環狀產生雙方封限區\n"
if(Cmd.search("Sym.Ara.U")>=0)Content=Content+"首回合設置環狀產生雙方限區\n"
if(Cmd.search("Sym.Ara.Q")>=0)Content=Content+"首回合設置環狀產生雙方封區\n"
if(Cmd.search("Sym.Ara.E")>=0)Content=Content+"首回合設置環狀產生雙方禁區，得到較多區域者獲勝\n"
if(Cmd.search("Sym.Ara.P")>=0)Content=Content+"首回合設置於交錯點產生禁區\n"
if(Cmd.search("Sym.Ara.F")>=0)Content=Content+"首回合設置產生安全區\n"
if(Cmd.search("Sym.Ara.O")>=0)Content=Content+"首回合設置產生皇化區\n"
if(Cmd.search("Sym.Rnd")>=0)Content=Content+"隨機產生雙方符號\n"
if(Cmd.search("Ara.W.Rnd")>=0)Content=Content+"將生成滅陷區\n"
if(Cmd.search("Ara.N.Rnd")>=0)Content=Content+"將生成滅障區\n"
if(Cmd.search("Ara.Z.Rnd")>=0)Content=Content+"將生成滅安區\n"
if(Cmd.search("Crt.C.Rnd")>=0)Content=Content+"將生成半魔領導Catra\n"
if(Cmd.search("Crt.W.Rnd")>=0)Content=Content+"將生成增殖蟲Waler\n"
if(Cmd.search("Crt.Y.Rnd")>=0)Content=Content+"將生成召使Yokla\n"
if(Cmd.search("Crt.D.Rnd")>=0)Content=Content+"將生成影妖Diaxu\n"
if(Cmd.search("Crt.T.Rnd")>=0)Content=Content+"將生成旅人Tiafu\n"
if(Cmd.search("Crt.O.Rnd")>=0)Content=Content+"將生成O皇Oxdra\n"
if(Cmd.search("Crt.X.Rnd")>=0)Content=Content+"將生成X皇Xomud\n"
if(Cmd.search("Crt.F.Act")>=0)Content=Content+"精靈長老每回合將隨機產生\n"
if(Cmd.search("Crt.B.Act")>=0)Content=Content+"魔族酋長每回合將隨機吃掉符號\n"
if(Cmd.search("Crt.L.Act")>=0)Content=Content+"精靈戰士每回合將隨機產生\n"
if(Cmd.search("Crt.R.Act")>=0)Content=Content+"魔族將軍每回合將隨機吃掉符號\n"
if(Cmd.search("Crt.C.Act")>=0)Content=Content+"半魔每回合將隨機藉連線產生\n"
if(Cmd.search("Crt.W.Act")>=0)Content=Content+"增殖蟲每回合將藉正四方產生\n"
if(Cmd.search("Crt.T.Act")>=0)Content=Content+"旅人每回合將隨機移動\n"
if(Cmd.search("Crt.N.Act")>=0)Content=Content+"殭屍每回合將吃掉未產生一般連線之符號\n"
if(Cmd.search("Crt.P.Act")>=0)Content=Content+"怨靈每回合將隨機產生在角落\n"
if(Cmd.search("Crt.H.Act<T>")>=0)Content=Content+"巨人Haber每回合將順時針移動\n"
if(Cmd.search("Crt.H.Act<R>")>=0)Content=Content+"巨人Haber每回合將逆時針移動\n"
if(Cmd.search("Crt.D.Dym<V>")>=0)Content=Content+"影妖Diaxu每秒將直線移動\n"
if(Cmd.search("Crt.D.Dym<H>")>=0)Content=Content+"影妖Diaxu每秒將橫線移動\n"
if(Cmd.search("Crt.I.Dym<T>")>=0)Content=Content+"鬼影Ibers每秒將順時針移動\n"
if(Cmd.search("Crt.I.Dym<R>")>=0)Content=Content+"鬼影Ibers每秒將逆時針移動\n"
if(Cmd.search("Crt.U.Dym<T>")>=0)Content=Content+"狂魔Uinos每秒將順時針移動\n"
if(Cmd.search("Crt.U.Dym<R>")>=0)Content=Content+"狂魔Uinos每秒將逆時針移動\n"
if(Cmd.search("Crt.Q.Act")>=0)Content=Content+"天神Quare每回合將以指定形式移動\n"
if(Cmd.search("Crt.Q.Dym")>=0)Content=Content+"天神Quare每秒將以指定形式移動\n"
if(Cmd.search("Crt.Q.ARd")>=0)Content=Content+"天神Quare每回合將以指定範圍產生一只\n"
if(Cmd.search("Crt.Q.DRd")>=0)Content=Content+"天神Quare每秒將以指定範圍產生一只\n"
if(Cmd.search("Shp.crs.kil")>=0)Content=Content+"以十字形圍繞對方，使其消失\n"
if(Cmd.search("Shp.X.kil")>=0)Content=Content+"以叉字形圍繞對方，使其消失\n"
if(Cmd.search("Shp.H.kil")>=0)Content=Content+"形成橫線使對方符號消失\n"
if(Cmd.search("Shp.V.kil")>=0)Content=Content+"形成直線使對方符號消失\n"
if(Cmd.search("Shp.Rh.kil")>=0)Content=Content+"形成斜線使對方符號消失\n"
if(Cmd.search("Shp.Sh.kil")>=0)Content=Content+"形成反斜線使對方符號消失\n"
if(Cmd.search("Shp.crs.rpl")>=0)Content=Content+"以十字形圍繞對方，使其變更\n"
if(Cmd.search("Shp.X.rpl")>=0)Content=Content+"以叉字形圍繞對方，使其變更\n"
if(Cmd.search("Shp.H.rpl")>=0)Content=Content+"形成橫線變更對方符號\n"
if(Cmd.search("Shp.V.rpl")>=0)Content=Content+"形成直線變更對方符號\n"
if(Cmd.search("Shp.Rh.rpl")>=0)Content=Content+"形成斜線變更對方符號\n"
if(Cmd.search("Shp.Sh.rpl")>=0)Content=Content+"形成反斜線變更對方符號\n"
if(Cmd.search("Shp.crs.nml")>=0)Content=Content+"完成一個十字形取勝\n"
if(Cmd.search("Shp.X.nml")>=0)Content=Content+"完成一個叉字形取勝\n"
if(Cmd.search("Shp.sqr.nml")>=0)Content=Content+"完成一個方形取勝\n"
if(Cmd.search("Shp.crs.scr")>=0)Content=Content+"完成一個十字形得分\n"
if(Cmd.search("Shp.X.scr")>=0)Content=Content+"完成一個叉字形得分\n"
if(Cmd.search("Shp.sqr.scr")>=0)Content=Content+"完成一個方形得分\n"
if(Cmd.search("Shp.H.hrm")>=0)Content=Content+"形成橫線殺死對方符號\n"
if(Cmd.search("Shp.V.hrm")>=0)Content=Content+"形成直線殺死對方符號\n"
if(Cmd.search("Shp.Rh.hrm")>=0)Content=Content+"形成斜線殺死對方符號\n"
if(Cmd.search("Shp.Sh.hrm")>=0)Content=Content+"形成反斜線殺死對方符號\n"
if(Cmd.search("Ara.prt")>=0)Content=Content+"區域將以區塊性分部\n"
if(Cmd.search("Rul.Ara ")>=0)Content=Content+"設法占領更多區域\n"
if(Cmd.search("Rul.Ara.scr")>=0)Content=Content+"設法占領更多區域得分\n"
if(Cmd.search("Rul.Ara.prt")>=0)Content=Content+"區塊布滿雙方符號時，將自動清空\n"
if(Cmd.search("Rul.Ara.tgt")>=0)Content=Content+"指定區塊有指定符號時，進行勝負判別\n"
if(Cmd.search("Rul.Ldr")>=0)Content=Content+"對方領導不存在時，我方獲勝\n"
if(Cmd.search("Rul.Wpn")>=0)Content=Content+"允許武器的使用\n"
if(Cmd.search("Rul.Bld")>=0)Content=Content+"殺死對方符號得分\n"
if(Cmd.search("Rul.Cnt.dis")>=0)Content=Content+"符號連線將會被阻斷\n"
if(Cmd.search("Rul.Cnt.kil")>=0)Content=Content+"符號連線將會被破壞\n"
if(Cmd.search("Rul.Bld")>=0)Content=Content+"殺死對方符號得分\n"
if(Cmd.search("Cnt.rmt")>=0)Content=Content+"允許遠程連線\n"
if(Cmd.search("Cnt.abn")>=0)Content=Content+"允許異常連線\n"
if(Cmd.search("Cnt.non")>=0)Content=Content+"允許不連線\n"
if(Cmd.search("Rul.Chs")>=0){
Content=Content+"做為非單符號棋盤\n"
if(Cmd.search("Rul.Chs.Ldr")>=0)Content=Content+"設法將對方棕色符號(領導)吃掉取勝\n"
for(C=97;C<106;C++){
	var typ=Chr(C),clr="",md="",cd="",cdt=""
	if(C==97)clr="紅";if(C==98)clr="橙";if(C==99)clr="黃";if(C==100)clr="綠";
	if(C==101)clr="藍";if(C==102)clr="紫";if(C==103)clr="粉";if(C==104)clr="靛藍";if(C==105)clr="棕"
	for(tp=0;tp<9;tp++){
		if(tp==0)md=" ";if(tp==1)md=".f";if(tp==2)md=".k";if(tp==3)md=".l";if(tp==4)md=".j";if(tp==5)md=".s";if(tp==6)md=".s.l"
		if(Cmd.search(typ+".8"+md)>=0)Cmd=Cmd+typ+".4"+md+typ+".YX"+md
		if(Cmd.search(typ+".4"+md)>=0)Cmd=Cmd+typ+".X"+md+typ+".Y"+md
		if(Cmd.search(typ+".X"+md)>=0)Cmd=Cmd+typ+".R"+md+typ+".L"+md
		if(Cmd.search(typ+".Y"+md)>=0)Cmd=Cmd+typ+".F"+md+typ+".B"+md
		if(Cmd.search(typ+".YX"+md)>=0)Cmd=Cmd+typ+".FX"+md+typ+".BX"+md
		if(Cmd.search(typ+".FX"+md)>=0)Cmd=Cmd+typ+".FR"+md+typ+".FL"+md
		if(Cmd.search(typ+".BX"+md)>=0)Cmd=Cmd+typ+".BR"+md+typ+".BL"+md
		if(Cmd.search(typ+".YR"+md)>=0)Cmd=Cmd+typ+".FR"+md+typ+".BR"+md
		if(Cmd.search(typ+".YL"+md)>=0)Cmd=Cmd+typ+".FL"+md+typ+".BL"+md
		if(Cmd.search(typ+".8n"+md)>=0)Cmd=Cmd+typ+".YXX"+md+typ+".YYX"+md
		if(Cmd.search(typ+".YXX"+md)>=0)Cmd=Cmd+typ+".FXX"+md+typ+".BXX"+md
		if(Cmd.search(typ+".FXX"+md)>=0)Cmd=Cmd+typ+".FRR"+md+typ+".FLL"+md
		if(Cmd.search(typ+".BXX"+md)>=0)Cmd=Cmd+typ+".BRR"+md+typ+".BLL"+md
		if(Cmd.search(typ+".YRR"+md)>=0)Cmd=Cmd+typ+".FRR"+md+typ+".BRR"+md
		if(Cmd.search(typ+".YLL"+md)>=0)Cmd=Cmd+typ+".FLL"+md+typ+".BLL"+md
		if(Cmd.search(typ+".YYX"+md)>=0)Cmd=Cmd+typ+".FFX"+md+typ+".BBX"+md
		if(Cmd.search(typ+".FFX"+md)>=0)Cmd=Cmd+typ+".FFR"+md+typ+".FFL"+md
		if(Cmd.search(typ+".BBX"+md)>=0)Cmd=Cmd+typ+".BBR"+md+typ+".BBL"+md
		if(Cmd.search(typ+".YYR"+md)>=0)Cmd=Cmd+typ+".FFR"+md+typ+".BBR"+md
		if(Cmd.search(typ+".YYL"+md)>=0)Cmd=Cmd+typ+".FFL"+md+typ+".BBL"+md
		if(Cmd.search(typ+".28"+md)>=0)Cmd=Cmd+typ+".24"+md+typ+".2YX"+md
		if(Cmd.search(typ+".24"+md)>=0)Cmd=Cmd+typ+".2X"+md+typ+".2Y"+md
		if(Cmd.search(typ+".2X"+md)>=0)Cmd=Cmd+typ+".2R"+md+typ+".2L"+md
		if(Cmd.search(typ+".2Y"+md)>=0)Cmd=Cmd+typ+".2F"+md+typ+".2B"+md
		if(Cmd.search(typ+".2YX"+md)>=0)Cmd=Cmd+typ+".2FX"+md+typ+".2BX"+md
		if(Cmd.search(typ+".2FX"+md)>=0)Cmd=Cmd+typ+".2FR"+md+typ+".2FL"+md
		if(Cmd.search(typ+".2BX"+md)>=0)Cmd=Cmd+typ+".2BR"+md+typ+".2BL"+md
		if(Cmd.search(typ+".2YR"+md)>=0)Cmd=Cmd+typ+".2FR"+md+typ+".2BR"+md
		if(Cmd.search(typ+".2YL"+md)>=0)Cmd=Cmd+typ+".2FL"+md+typ+".2BL"+md
	}
	if(Cmd.search(typ+".F")>=0)ChessDirection(typ,Cmd,clr,"前",".F")
	if(Cmd.search(typ+".B")>=0)ChessDirection(typ,Cmd,clr,"後",".B")
	if(Cmd.search(typ+".R")>=0)ChessDirection(typ,Cmd,clr,"右",".R")
	if(Cmd.search(typ+".L")>=0)ChessDirection(typ,Cmd,clr,"左",".L")
	if(Cmd.search(typ+".FR")>=0)ChessDirection(typ,Cmd,clr,"右前",".FR")
	if(Cmd.search(typ+".FL")>=0)ChessDirection(typ,Cmd,clr,"左前",".FL")
	if(Cmd.search(typ+".BR")>=0)ChessDirection(typ,Cmd,clr,"右後",".BR")
	if(Cmd.search(typ+".BL")>=0)ChessDirection(typ,Cmd,clr,"左後",".BL")
	if(Cmd.search(typ+".2F")>=0)ChessDirection(typ,Cmd,clr,"前前",".2F")
	if(Cmd.search(typ+".2B")>=0)ChessDirection(typ,Cmd,clr,"後後",".2B")
	if(Cmd.search(typ+".2R")>=0)ChessDirection(typ,Cmd,clr,"右右",".2R")
	if(Cmd.search(typ+".2L")>=0)ChessDirection(typ,Cmd,clr,"左左",".2L")
	if(Cmd.search(typ+".2FR")>=0)ChessDirection(typ,Cmd,clr,"右右前前",".2FR")
	if(Cmd.search(typ+".2FL")>=0)ChessDirection(typ,Cmd,clr,"左左前前",".2FL")
	if(Cmd.search(typ+".2BR")>=0)ChessDirection(typ,Cmd,clr,"右右後後",".2BR")
	if(Cmd.search(typ+".2BL")>=0)ChessDirection(typ,Cmd,clr,"左左後後",".2BL")
	if(Cmd.search(typ+".FFR")>=0)ChessDirection(typ,Cmd,clr,"右前前",".FFR")
	if(Cmd.search(typ+".FFL")>=0)ChessDirection(typ,Cmd,clr,"左前前",".FFL")
	if(Cmd.search(typ+".BBR")>=0)ChessDirection(typ,Cmd,clr,"右後後",".BBR")
	if(Cmd.search(typ+".BBL")>=0)ChessDirection(typ,Cmd,clr,"左後後",".BBL")
	if(Cmd.search(typ+".FRR")>=0)ChessDirection(typ,Cmd,clr,"右右前",".FRR")
	if(Cmd.search(typ+".FLL")>=0)ChessDirection(typ,Cmd,clr,"左左前",".FLL")
	if(Cmd.search(typ+".BRR")>=0)ChessDirection(typ,Cmd,clr,"右右後",".BRR")
	if(Cmd.search(typ+".BLL")>=0)ChessDirection(typ,Cmd,clr,"左左後",".BLL")
}
}
if(Content!="")alert(Content+Chs)
if(Cmd.search("Rul.Wpn")>=0&&confirm("是否載入武器說明？")==true){
alert("藥劑Drug：使附近的符號進入不死狀態\n斧Ax：兩回合後使附近的符號進入死亡狀態\n槍Spear：指定方向兩單位符號給予傷害2\n劍Sword：斜四方位符號給予傷害2\n刀knife：正四方位符號給予傷害2\n弓Bow：指定方向單位符號給予傷害1\n盾Shield：可無效弓的攻勢\n叉Fork：指定方向一單位符號給予傷害3\n矛Lance：指定方向三單位符號給予傷害1")
}
}//模式說明
function ChessDirection(typ,Cmd,clr,cd,cdt){var Content=""
Content=Content+clr+"色的符號，"+cd+"方"
if(Cmd.search(typ+cdt+".k")>=0)Content=Content+"若有符號時，才可移動將其吃掉"
if(Cmd.search(typ+cdt+".f")>=0)Content=Content+"僅在剛開始時，才可移動"
if(Cmd.search(typ+cdt+".l")>=0)Content=Content+"若無符號時，才可移動"
if(Cmd.search(typ+cdt+".s")>=0)Content=Content+"可不限長度移動"
if(Cmd.search(typ+cdt+".s.l")>=0)Content=Content+"，但無法吃掉符號"
if(Cmd.search(typ+cdt+".j")>=0)Content=Content+"可跳吃符號"
if(Cmd.search(typ+cdt+" ")>=0)Content=Content+"可移動吃符號"
if(Content!=clr+"色的符號，"+cd+"方")Chs=Chs+Content+"\n"
}//棋盤說明
function Command(typ){
	if(coor(typ).style.backgroundColor=='lightgray'){
		coor(typ).style.backgroundColor='gray'
	}else{
		coor(typ).style.backgroundColor='lightgray'
	}
}//簡易指令集
function CommandInput(){var Cmd=""
if(parseInt(coor('TurnS').value)>0&&parseInt(coor('TurnE').value)>0){
	Cmd="T<"+coor('TurnS').value+","+coor('TurnE').value+"> "
}var RA="",RC="",RS="",Ct=""
if(parseInt(coor('Scr').value)>0)Cmd=Cmd+"<S:"+coor('Scr').value+">"
if(parseInt(coor('TurnT').value)>0)Cmd=Cmd+"<T:"+coor('TurnT').value+">"
if(coor('Rul.Ara').style.backgroundColor=="lightgray")RA="Rul.Ara "
if(coor('Rul.Ara.scr').style.backgroundColor=="lightgray")RA="Rul.Ara.scr "
if(coor('Rul.Ara.prt').style.backgroundColor=="lightgray")RA="Rul.Ara.prt<"+coor("Araprt").value+"> "
if(coor('Rul.Bld').style.backgroundColor=="lightgray")Cmd=Cmd+"Rul.Bld "
if(coor('Rul.Ldr').style.backgroundColor=="lightgray")Cmd=Cmd+"Rul.Ldr "
if(coor('Rul.Ato').style.backgroundColor=="lightgray")Cmd=Cmd+"Rul.Ato "
if(coor('Rul.Wpn').style.backgroundColor=="lightgray")Cmd=Cmd+"Rul.Wpn "
if(coor('Rul.Min').style.backgroundColor=="lightgray")Cmd=Cmd+"Rul.Min<"+coor("Min").value+"> "
if(coor('Rul.Chs').style.backgroundColor=="lightgray")RC="Rul.Chs "
if(coor('Rul.Chs.Ldr').style.backgroundColor=="lightgray")RC="Rul.Chs.Ldr "
if(coor('Rul.Cnt.kil').style.backgroundColor=="lightgray")Ct="Rul.Cnt.kil "
if(coor('Rul.Cnt.dis').style.backgroundColor=="lightgray")Ct="Rul.Cnt.dis "
if(coor('Cnt.non').style.backgroundColor=="lightgray"){
	Cmd=Cmd+"Cnt.non "
}else{
	if(coor('Cnt.rmt').style.backgroundColor=="lightgray")Cmd=Cmd+"Cnt.rmt "
	if(coor('Cnt.abn').style.backgroundColor=="lightgray")Cmd=Cmd+"Cnt.abn "
}
if(coor('Shp.nml').checked==true){
	if(coor('Shp.sqr').checked==true)RS=RS+" Shp.sqr.nml"
	if(coor('Shp.crs').checked==true)RS=RS+" Shp.crs.nml"
	if(coor('Shp.X').checked==true)RS=RS+" Shp.X.nml"
	if(parseInt(coor('Shp.val').value)>0){
		if(coor('Shp.V').checked==true)RS=RS+" Shp.V.nml<"+coor('Shp.val').value+">"
		if(coor('Shp.H').checked==true)RS=RS+" Shp.H.nml<"+coor('Shp.val').value+">"
		if(coor('Shp.Sh').checked==true)RS=RS+" Shp.Sh.nml<"+coor('Shp.val').value+">"
		if(coor('Shp.Rh').checked==true)RS=RS+" Shp.Rh.nml<"+coor('Shp.val').value+">"
	}
}
if(coor('Shp.scr').checked==true){
	if(coor('Shp.sqr').checked==true)RS=RS+" Shp.sqr.scr"
	if(coor('Shp.crs').checked==true)RS=RS+" Shp.crs.scr"
	if(coor('Shp.X').checked==true)RS=RS+" Shp.X.scr"
}
if(coor('Shp.kil').checked==true){
	if(coor('Shp.crs').checked==true)RS=RS+" Shp.crs.kil"
	if(coor('Shp.X').checked==true)RS=RS+" Shp.X.kil"
	if(coor('Shp.V').checked==true)RS=RS+" Shp.V.kil"
	if(coor('Shp.H').checked==true)RS=RS+" Shp.H.kil"
	if(coor('Shp.Sh').checked==true)RS=RS+" Shp.Sh.kil"
	if(coor('Shp.Rh').checked==true)RS=RS+" Shp.Rh.kil"
}
if(coor('Shp.rpl').checked==true){
	if(coor('Shp.crs').checked==true)RS=RS+" Shp.crs.rpl"
	if(coor('Shp.X').checked==true)RS=RS+" Shp.X.rpl"
	if(coor('Shp.V').checked==true)RS=RS+" Shp.V.rpl"
	if(coor('Shp.H').checked==true)RS=RS+" Shp.H.rpl"
	if(coor('Shp.Sh').checked==true)RS=RS+" Shp.Sh.rpl"
	if(coor('Shp.Rh').checked==true)RS=RS+" Shp.Rh.rpl"
}
if(coor('Shp.hrm').checked==true){
	if(coor('Shp.V').checked==true)RS=RS+" Shp.V.hrm"
	if(coor('Shp.H').checked==true)RS=RS+" Shp.H.hrm"
	if(coor('Shp.Sh').checked==true)RS=RS+" Shp.Sh.hrm"
	if(coor('Shp.Rh').checked==true)RS=RS+" Shp.Rh.hrm"
}
Cmd=Cmd+Ct+RA+RC+RS
coor('OFD').value=coor('exm').value+Cmd
}//指令輸入
</script>
<script>
function Show(R){
	for(c=1;c<8;c++){
		if(coor("R"+c))coor("R"+c).style.display="none"
	}
	coor(R).style.display="inline"
}//區塊顯示
function ModeLoad(){
if(coor("OFD").value.search("#")==0){
Reader(Mode[coor("OFD").value.substr(1,coor("OFD").value.length-1)])
coor("OFD").value=Mode[coor("OFD").value.substr(1,coor("OFD").value.length-1)]
}
}//導入模式
function coor(name){return(document.getElementById(name))}
function Chr(value){return(String.fromCharCode(value))}
function checkoff(){var Sym=0
for(cd1=65;cd1<74;cd1++){
    for(cd2=1;cd2<10;cd2++){
		if(coor(Chr(cd1)+cd2).value!="")Sym++
	}
}
return Sym
}//棋盤確認
function dragoverHandler(evt){evt.preventDefault();}
function destroyClickedElement(evt){document.body.removeChild(evt.target);}
function dropHandler(evt) {
evt.preventDefault();var files=evt.dataTransfer.files;
for (var i in files) {
var fr=new FileReader();
fr.onload=function openfile(evt) {coor('exm').value=evt.target.result;}
fr.readAsText(files[i]);document.all.Command.style.display="inline"
}
}//讀取拖曳檔案
function OutputText(_text) {
	var _fileName=prompt("輸入下載檔名，點選取消即可複製字串")
	if(_fileName==null){
	    prompt('下列字串為要導出的檔案內容文字，歡迎複製',_text)
	}else{
		var textFileAsBlob = new Blob([_text]);
		var downloadLink = document.createElement("a");
		downloadLink.download = _fileName+".qre";
		downloadLink.innerHTML = "Download File";
		if (window.webkitURL != null) {
			downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
		} else {
			downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
			downloadLink.onclick = destroyClickedElement;
			downloadLink.style.display = "none";
			document.body.appendChild(downloadLink);
		}
		downloadLink.click();
	}
}//輸出回合檔案
</script>
</head>
<body leftmargin="0" topmargin="0" onload="Show('R7');CleanBoard()" onbeforeunload="if(checkoff()>0)return '棋局尚未結束'" oncontextmenu="return false">
<div style="width:100%;position:fixed;">
<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr bgcolor="dimgray" style="color:white;cursor:pointer" align="center" valign="middle">
  	<td height="30" align="center" valign="middle" onclick="location.href='http://fb.me/qobidop.Square.Connect'" class="lst" title="前往粉絲專頁"><img src="https://upload.wikimedia.org/wikipedia/commons/2/20/Square.Connect.png" height="30" width="30" /><font style="font-size:30px"><font color="blue">Square</font><font color="red">.</font>Connect</font></td>
    <td class="lst" onclick="Show('R1')" title="新手必看！">基礎說明</td>
    <td class="lst" onclick="Show('R2')">區域規則</td>
    <td class="lst" onclick="Show('R3')">角色規則</td>
    <td class="lst" onclick="Show('R4')">武器系統</td>
    <td class="lst" onclick="Show('R5')">形狀規則</td>
    <td class="lst" onclick="Show('R6')">自訂模式</td>
    <td class="lst" onclick="Show('R7')">開始遊玩</td>
  </tr>
</table>
</div><div class="rr"></div>
<div style="background-color:white">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
  <tr>
    <td valign="top">
      <div id="R1" style="display:none">首回合可隨意設置符號於任何格子，下回合必須設置符號於剛才設置的符號附近,如下表所示：
          <table border="1" align="center" cellpadding="0" cellspacing="0">
            <tr align="center">
              <td bgcolor="#999999" height="30" width="30">2FL</td><td bgcolor="#cccccc" width="30">FFL</td><td bgcolor="#999999" width="30">FF</td><td bgcolor="#cccccc" width="30">FFR</td><td bgcolor="#999999" width="30">2FR</td></tr>
            <tr align="center">
              <td bgcolor="#cccccc" height="30">FLL</td><td bgcolor="#666666">FL</td><td bgcolor="#666666">F</td><td bgcolor="#666666">FR</td><td bgcolor="#cccccc">FRR</td></tr>
            <tr align="center" >
              <td bgcolor="#999999" height="30">LL</td><td bgcolor="#666666">L</td>
              <td>C</td><td bgcolor="#666666">R</td><td bgcolor="#999999">RR</td></tr>
            <tr align="center">
              <td bgcolor="#cccccc" height="30">BLL</td><td bgcolor="#666666">BL</td><td bgcolor="#666666">B</td><td bgcolor="#666666">BR</td><td bgcolor="#cccccc">BRR</td></tr>
            <tr align="center">
              <td bgcolor="#999999" height="30">2BL</td><td bgcolor="#cccccc">BBL</td><td bgcolor="#999999">BB</td><td bgcolor="#cccccc">BBR</td><td bgcolor="#999999">2BR</td></tr>
        </table><br />C為目前設置符號的位置：<br />
        下回合可設置於深灰色處(即F部分)，此區域又稱一般連線區域(NCt,Cnt.nml)<br />以下兩者在指定狀態下才能設置：<br />
        而較深灰色處(即FF部分)，此區域又稱為遠程連線區域(RCt,Cnt.rmt)<br />而較淺灰色處(即FFL部分)，此區域又稱為異常連線區域(ACt,Cnt.abn)
      </div>
      <div id="R2" style="display:none">設置符號於不同區域時會有不同的現象發生，如下表所示：
          <table align="center" border="1" cellpadding="0" cellspacing="0" width="100%">
            <tr><td bgcolor="orange" height="30" width="30">&nbsp;</td><td align="center">得分區</td><td>設置者獲得一分</td></tr>
            <tr><td bgcolor="dimgray" height="30">&nbsp;</td><td align="center">障礙物</td><td>符號無法設置於此</td></tr>
            <tr><td bgcolor="lightgray" height="30">&nbsp;</td><td align="center">禁區</td><td>設置者判對方獲勝</td></tr>
            <tr><td bgcolor="darkgray" height="30">&nbsp;</td><td align="center">滅區</td><td>設置者將清除場上白色一般符號</td></tr>
            <tr><td bgcolor="gainsboro" height="30">&nbsp;</td><td align="center">創區</td><td>設置者符號將會隨機在棋盤設置符號</td></tr>
            <tr><td bgcolor="tan" height="30">&nbsp;</td><td align="center">陷阱區</td><td>設置後附近將產生石像鬼</td></tr>
            <tr><td bgcolor="darkslategray" height="30">&nbsp;</td><td align="center">滅陷區</td><td>設置後將會清除場上所有陷阱區</td></tr>
            <tr><td bgcolor="seagreen" height="30">&nbsp;</td><td align="center">安全區</td><td>無任何影響</td></tr>
            <tr><td bgcolor="blueviolet" height="30">&nbsp;</td><td align="center">滅障區</td><td>設置後將會清除場上所有障礙物</td></tr>
            <tr><td bgcolor="greenyellow" height="30">&nbsp;</td><td align="center">滅安區</td><td>設置後將會清除場上所有安全區</td></tr>
            <tr><td bgcolor="indianred" height="30">&nbsp;</td><td align="center">O禁區</td><td>O或X設置任一格判X獲勝</td></tr>
            <tr><td bgcolor="lightskyblue" height="30">&nbsp;</td><td align="center">X禁區</td><td>X或O設置任一格判O獲勝</td></tr>
            <tr><td bgcolor="crimson" height="30">&nbsp;</td><td align="center">O封限</td><td>若皆為O符號或X設置任一格判X獲勝</td></tr>
            <tr><td bgcolor="royalblue" height="30">&nbsp;</td><td align="center">X封限</td><td>若皆為X符號或O設置任一格判X獲勝</td></tr>
            <tr><td bgcolor="palevioletred" height="30">&nbsp;</td><td align="center">O封區</td><td>若皆為O符號判X獲勝</td></tr>
            <tr><td bgcolor="lightsteelblue" height="30">&nbsp;</td><td align="center">X封區</td><td>若皆為X符號判O獲勝</td></tr>
            <tr><td bgcolor="mediumvioletred" height="30">&nbsp;</td><td align="center">O限區</td><td>X設置任一格判X獲勝</td></tr>
            <tr><td bgcolor="steelblue" height="30">&nbsp;</td><td align="center">X限區</td><td>O設置任一格判O獲勝</td></tr>
            <tr><td bgcolor="orchid" height="30">&nbsp;</td><td align="center">O防區</td><td>O設置任一格判O獲勝</td></tr>
            <tr><td bgcolor="dodgerblue" height="30">&nbsp;</td><td align="center">X防區</td><td>X設置任一格判X獲勝</td></tr>
            <tr><td bgcolor="hotpink" height="30">&nbsp;</td><td align="center">O聯區</td><td>若皆為O符號判O獲勝</td></tr>
            <tr><td bgcolor="deepskyblue" height="30">&nbsp;</td><td align="center">X聯區</td><td>若皆為X符號判X獲勝</td></tr>
            <tr><td bgcolor="firebrick" height="30">&nbsp;</td><td align="center">O滅區</td><td>設置O將清除場上白色一般符號</td></tr>
            <tr><td bgcolor="powderblue" height="30">&nbsp;</td><td align="center">X滅區</td><td>設置X將清除場上白色一般符號</td></tr>
            <tr><td bgcolor="cyan" height="30">&nbsp;</td><td align="center">皇化區</td><td>設置者將使符號變更為皇</td></tr>
            <tr><td bgcolor="fuchsia" height="30">&nbsp;</td><td align="center">滅皇區</td><td>設置者將清除場上所有的皇</td></tr>
          </table>
      </div>
      <div id="R3" style="display:none">角色會有不同的能力，如下表所示：
        <table align="center" border="1" cellpadding="0" cellspacing="0" width="100%">
            <tr><td align="center" bgcolor="indigo" height="30" valign="middle" width="30"><font color="white">A</font></td><td align="center" valign="middle">半魔</td><td valign="middle">將在場上隨機設置半魔</td></tr>
            <tr><td align="center" bgcolor="darkred" height="30" valign="middle"><font color="red">B</font></td><td align="center" valign="middle">魔族酋長</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="indigo" height="30" valign="middle"><font color="blueviolet">C</font></td><td align="center" valign="middle">半魔領導</td><td valign="middle">將在場上隨機設置半魔</td></tr>
            <tr><td align="center" bgcolor="dimgray" height="30" valign="middle"><font color="red">D</font></td><td align="center" valign="middle">影妖</td><td valign="middle">無</td></tr>
            <tr><td align="center" height="30" valign="middle"><font color="navy">E</font></td><td align="center" valign="middle">將軍</td><td valign="middle">促使附近符號變更為設置於本符號附近的符號</td></tr>
            <tr><td align="center" bgcolor="blue" height="30" valign="middle"><font color="skyblue">F</font></td><td align="center" valign="middle">精靈長老</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="gray" height="30" valign="middle"><font color="darkgray">G</font></td><td align="center" valign="middle">石像鬼</td><td valign="middle">符號無法設置於此</td></tr>
            <tr><td align="center" bgcolor="darkolivegreen" height="30" valign="middle"><font color="olivedrab">H</font></td><td align="center" valign="middle">巨人</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="silver" height="30" valign="middle"><font color="white">I</font></td><td align="center" valign="middle">鬼影</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="darkgreen" height="30" valign="middle"><font color="crimson">J</font></td><td align="center" valign="middle">食人怪</td><td valign="middle">設置者判對方獲勝</td></tr>
            <tr><td align="center" height="30" valign="middle"><font color="dimgray">K</font></td><td align="center" valign="middle">變形者</td><td valign="middle">雙方皆可利用本符號連線</td></tr>
            <tr><td align="center" bgcolor="darkgreen" height="30" valign="middle"><font color="lime">L</font></td><td align="center" valign="middle">精靈戰士</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="cornflowerblue" height="30" valign="middle"><font color="navy">M</font></td><td align="center" valign="middle">幽靈</td><td valign="middle">於指定回合更為空白格</td></tr>
            <tr><td align="center" bgcolor="black" height="30" valign="middle"><font color="purple">N</font></td><td align="center" valign="middle">殭屍</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="maroon" height="30" valign="middle"><font color="red">O</font></td><td align="center" valign="middle">O皇</td><td valign="middle">&nbsp;促使附近符號變更為O</td></tr>
            <tr><td align="center" bgcolor="black" height="30" valign="middle"><font color="dimgray">P</font></td><td align="center" valign="middle">怨靈</td><td valign="middle">將產生符號於角落</td></tr>
            <tr><td align="center" height="30" valign="middle"><font color="white">Q</font></td><td align="center" valign="middle">天神</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="black" height="30" valign="middle"><font color="white">Q</font></td><td align="center" valign="middle">魔神</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="darkorange" height="30" valign="middle"><font color="gold">R</font></td><td align="center" valign="middle">魔族將軍</td><td valign="middle">無</td></tr>
            <tr><td align="center" height="30" valign="middle">S</td><td align="center" valign="middle">村民</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="skyblue" height="30" valign="middle"><font color="steelblue">T</font></td><td align="center" valign="middle">旅人</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="orangered" height="30" valign="middle"><font color="midnightblue">U</font></td><td align="center" valign="middle">狂魔</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="darkorange" height="30" valign="middle">V</td><td align="center" valign="middle">精靈</td><td valign="middle">無</td></tr>
            <tr><td align="center" bgcolor="pink" height="30" valign="middle"><font color="purple">W</font></td><td align="center" valign="middle">增殖蟲</td><td valign="middle">將在場上隨機設置增殖蟲</td></tr>
            <tr><td align="center" bgcolor="olive" height="30" valign="middle"><font color="yellow">X</font></td><td align="center" valign="middle">X皇</td><td valign="middle">促使附近符號變更為X</td></tr>
            <tr><td align="center" bgcolor="deeppink" height="30" valign="middle"><font color="white">Y</font></td><td align="center" valign="middle">召喚者</td><td valign="middle">點選後在場上隨機設置石像鬼</td></tr>
            <tr><td align="center" bgcolor="black" height="30" valign="middle"><font color="red">Z</font></td><td align="center" valign="middle">魔族</td><td valign="middle">無</td></tr>
          </table>
      </div>
      <div id="R4" style="display:none">
        武器會有不同的傷害與範圍，再次點選符號時可選擇，如下表所示：
          <table align="center" border="1" cellpadding="0" cellspacing="0" width="100%">
            <tr><td align="center" height="30" valign="middle" width="30">)|(</td><td align="center" valign="middle">斧頭</td><td valign="middle">兩回合後，附近符號傷害3</td></tr>
            <tr><td align="center" height="30" valign="middle" width="30">Φ</td><td align="center" valign="middle">弓箭</td><td valign="middle">給予指定長度之符號傷害1</td></tr>
            <tr><td align="center" height="30" valign="middle" width="30">Θ</td><td align="center" valign="middle">盾牌</td><td valign="middle">於弓箭指定長度內時弓箭無效</td></tr>
            <tr><td align="center" height="30" valign="middle" width="30">Λ</td><td align="center" valign="middle">長槍</td><td valign="middle">給予指定方向兩格符號傷害2</td></tr>
            <tr><td align="center" height="30" valign="middle" width="30">ϝ</td><td align="center" valign="middle">長矛</td><td valign="middle">給予指定方向三格符號傷害1</td></tr>
            <tr><td align="center" height="30" valign="middle" width="30">Ψ</td><td align="center" valign="middle">長叉</td><td valign="middle">給予指定方向一格符號傷害3</td></tr>
            <tr><td align="center" height="30" valign="middle" width="30">ϡ</td><td align="center" valign="middle">刀刃</td><td valign="middle">給予斜四方傷害2</td></tr>
            <tr><td align="center" height="30" valign="middle" width="30">Ξ</td><td align="center" valign="middle">長劍</td><td valign="middle">給予正四方傷害2</td></tr>
            <tr><td align="center" height="30" valign="middle" width="30">δ</td><td align="center" valign="middle">藥劑</td><td valign="middle">正四方符號中毒，兩回合內不受攻擊，結束後受到傷害1</td></tr>
          </table>
      </div>
      <div id="R5" style="display:none">
        指定形狀如下：
        <table align="center"border="1"cellpadding="0"cellspacing="0">
        <tr align="center"valign="middle">
          <td width="30"height="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">O</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">O</td>
          <td width="30">O</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
          <td width="30">&nbsp;</td>
        </tr>
        <tr align="center"valign="middle">
        <td height="30">&nbsp;</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        </tr>
        <tr align="center"valign="middle">
        <td height="30">&nbsp;</td>
        <td>O</td>
        <td bgcolor="#cccccc">O</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td bgcolor="#cccccc">O</td>
        <td bgcolor="#cccccc">O</td>
        <td bgcolor="#cccccc">O</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td></tr>
        <tr align="center"valign="middle">
        <td height="30">&nbsp;</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>O</td>
        <td>O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td bgcolor="#cccccc">O</td>
        <td>&nbsp;</td></tr>
        <tr align="center"valign="middle">
        <td height="30"align="center"valign="middle">&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td align="center"valign="middle">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td align="center"valign="middle">O</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
        <td align="center"valign="middle">O</td></tr>
        <tr align="center"valign="middle">
        <td colspan="5" height="30">十字(crs)</td>
        <td colspan="5">叉字形(X)</td>
        <td colspan="5">方形(sqr)</td>
        <td colspan="5"height="30">直(V)</td>
        <td colspan="5">橫(H)</td>
        <td colspan="5">斜(Sh)</td>
        <td colspan="5">反斜(Rh)</td>
        </tr>
        </table>
      淺灰色處為傷害式(.hrm)，取代式(.rpl)，清除式(.kil)之效果區域
      </div>
      <div id="R6" style="display:none">
      方格連線本身有提供提供指令碼，方便自行設計模式。<br />將滑鼠移至右側，可喚出簡易規則設定欄，設定好後，點選導出指令即可完成設定。
      <br />也可以點選&quot;Command&quot;於指令碼區首字輸入#再輸入指定經典模式，即可使用該模式。<br>
      <span id="ModeContent">無法載入更新內容，可能是您的瀏覽器將更新內容視為不信任的來源</span>
      </div>
      <div id="R7">
        <table align="center" border="0" cellpadding="0" cellspacing="0" width="100%">
          <tr>
            <td onmouseover="document.all.Command.style.display='inline';body.style.backgroundColor='lightgray'"  onmouseout="document.all.Command.style.display='none';body.style.backgroundColor='white'" bgcolor="gray" valign="top" width="1">
              <div class="lst">
                <table id="Command" hidden="" style="cursor:default;" border="0" cellpadding="0" cellspacing="0">
                  <tr><th valign="middle">規則設定</th></tr>
                  <tr><td valign="middle" id="Rul.Ato" onclick="Command('Rul.Ato')" style="background-color:lightgray">Rul.Ato(自動完成)</td></tr>
                  <tr><td valign="middle" id="Rul.Ldr" onclick="Command('Rul.Ldr')">Rul.Ldr(領導制)</td></tr>
                  <tr><td valign="middle" id="Rul.Bld" onclick="Command('Rul.Bld')">Rul.Bld(傷害制)</td></tr>
                  <tr><td valign="middle" id="Rul.Wpn" onclick="Command('Rul.Wpn')">Rul.Wpn(允許武器使用)</td></tr>
                  <tr><td valign="middle" id="Rul.Ara" onclick="Command('Rul.Ara')">Rul.Ara(區域化)</td></tr>
                  <tr><td valign="middle" id="Rul.Ara.scr" onclick="Command('Rul.Ara.scr')">Rul.Ara.scr(區域計分制)</td></tr>
                  <tr><td valign="middle" nowrap="nowrap" id="Rul.Ara.prt" onclick="Command('Rul.Ara.prt')">Rul.Ara.prt(區塊化區域)<input id="Araprt" class="Val" style="float:right" maxlength="1" type="text" /></td></tr>
                  <tr><td valign="middle" id="Rul.Chs" onclick="Command('Rul.Chs')">Rul.Chs(棋盤化)</td></tr>
                  <tr><td valign="middle" id="Rul.Chs.Ldr" onclick="Command('Rul.Chs.Ldr')">Rul.Chs.Ldr(棋盤領導制)</td></tr>
                  <tr><td valign="middle" id="Rul.Cnt.dis" onclick="Command('Rul.Cnt.dis')">Rul.Cnt.dis(連線阻斷制)</td></tr>
                  <tr><td valign="middle" id="Rul.Cnt.kil" onclick="Command('Rul.Cnt.kil')">Rul.Cnt.kil(連線抹殺制)</td></tr>
                  <tr><td valign="middle" id="Rul.Min" onclick="Command('Rul.Min')">Rul.Min(地雷制)<input id="Min" class="Val" style="float:right" maxlength="1" type="text" /></td></tr>
                  <tr><td valign="middle" nowrap="nowrap">預載回合：<input id="TurnT" class="Val" maxlength="2" type="text" />得分要求：<input id="Scr" class="Val" maxlength="2" type="text" /></td></tr>
                  <tr><td valign="middle">開始回合：<input id="TurnS" class="Val" maxlength="2" type="text" />結束回合：<input id="TurnE" class="Val" maxlength="2" type="text" /></td></tr>
                  <tr><th valign="middle">連線設定</th>
                  </tr><tr><td valign="middle" id="Cnt.rmt" onclick="Command('Cnt.rmt')">Cnt.rmt(遠程連線)</td></tr>
                  <tr><td valign="middle" id="Cnt.abn" onclick="Command('Cnt.abn')">Cnt.abn(異常連線)</td></tr>
                  <tr><td valign="middle" id="Cnt.non" onclick="Command('Cnt.non')">Cnt.non(取消連線)</td></tr>
                  <tr><th valign="middle">形狀設定 長度：<input id="Shp.val" style="border:medium none ;background-color:lightgray;width:15px;" maxlength="1" type="text" /></th></tr>
                  <tr><td valign="middle">
                    <input id="Shp.crs" type="checkbox" />十字形<input id="Shp.X" type="checkbox" />叉字形<br />
                    <input id="Shp.V" type="checkbox" />直<input id="Shp.H" type="checkbox" />橫<br />
                    <input id="Shp.Sh" type="checkbox" />斜<input id="Shp.Rh" type="checkbox" />反斜<br />
                    <input id="Shp.sqr" type="checkbox" />方形<input id="Shp.nml" type="checkbox" />一般式<br />
                    <input id="Shp.kil" type="checkbox" />清除式<input id="Shp.hrm" type="checkbox" />傷害式<br />
                    <input id="Shp.scr" type="checkbox" />得分式<input id="Shp.rpl" type="checkbox" />取代式<br />
                  </td></tr>
                  <tr><th valign="middle">額外指令</th></tr>
                  <tr><td valign="middle"><textarea id="exm" style="border:medium none ;background-color:lightgray;width:97%;height:100px;"></textarea></td></tr>
                  <tr><th align="center" valign="middle" style="background-color:dimgray;" onclick="document.all.Command.style.display='none';CommandInput();body.style.backgroundColor='white';if(confirm('是否清除棋盤？')==true)CleanBoard()">導入指令</th></tr>
                  <tr><th align="center" valign="middle" style="background-color:dimgray;" onclick="CommandInput();OutputText(coor('OFD').value)">導出指令</th></tr>
                </table>
              </div>
            </td>
            <td align="center">
              <div id="DragDrop" ondragover="dragoverHandler(event)" ondrop="dropHandler(event)">
                   <table id="Weapon" hidden="" align="center" border="0" width="100">
                      <tr align="center" valign="middle">
                          <td>
                              <input value="Cancel" class="cmd" onclick="document.all.Weapon.style.display='none'" type="button" />
                              <input value="Drug" class="cmd" onclick="Wdug()" type="button" /><script>function Wdug(){
                                  if(coor(SetCrd[Turn-1]).value!=""){
                                      coor(SetCrd[Turn-1]).value="δ"
        if(coor(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-1)).value==O|coor(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-1)).value==X)coor(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-1)).style.color="dodgerblue"
        if(coor(SetCrd[Turn-1].substr(0,1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+1)).value==O|coor(SetCrd[Turn-1].substr(0,1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+1)).value==X)coor(SetCrd[Turn-1].substr(0,1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+1)).style.color="dodgerblue"
        if(coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+1)+parseInt(SetCrd[Turn-1].substr(1,1))).value==O|coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+1)+parseInt(SetCrd[Turn-1].substr(1,1))).value==X)coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+1)+parseInt(SetCrd[Turn-1].substr(1,1))).style.color="dodgerblue"
        if(coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-1)+parseInt(SetCrd[Turn-1].substr(1,1))).value==O|coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-1)+parseInt(SetCrd[Turn-1].substr(1,1))).value==X)coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-1)+parseInt(SetCrd[Turn-1].substr(1,1))).style.color="dodgerblue"
                                  }document.all.Weapon.style.display="none"
                              }</script>
                              <input value="Spear" class="cmd" onclick="Wspr()" type="button" /><script>function Wspr(){
                                   if(coor(SetCrd[Turn-1]).value!=""){
                                      coor(SetCrd[Turn-1]).value="ϝ"
                                      var Crd=prompt('輸入攻擊方向' ,'輸入F(前)B(後)R(右)L(左)')
                                      for(C=1;C<3;C++){
                                          if(Crd=="F")Blood(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-C),2)
                                          if(Crd=="B")Blood(SetCrd[Turn-1].substr(0,1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+C),2)
                                          if(Crd=="R")Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+C)+parseInt(SetCrd[Turn-1].substr(1,1)),2)
                                          if(Crd=="L")Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-C)+parseInt(SetCrd[Turn-1].substr(1,1)),2)
                                      }coor(SetCrd[Turn-1]).style.color="maroon"
                                       }
                              }</script>
                              <input value="Knife" class="cmd" onclick="Wknf()" type="button" /><script>function Wknf(){
                                  if(coor(SetCrd[Turn-1]).value!=""){
                                      coor(SetCrd[Turn-1]).value="ϡ"
                                      Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+1)+parseInt(SetCrd[Turn-1].substr(1,1)-1),2)
                                      Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-1)+parseInt(SetCrd[Turn-1].substr(1,1)-1),2)
                                      Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+1),2)
                                      Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+1),2)
                                  coor(SetCrd[Turn-1]).style.color="maroon"
                                  }
                              }</script>
                              <input value="Sword" class="cmd" onclick="Wswd()" type="button" /><script>function Wswd(){
                                   if(coor(SetCrd[Turn-1]).value!=""){
                                      coor(SetCrd[Turn-1]).value="Ξ"
                                      Blood(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-1),2)
                                      Blood(SetCrd[Turn-1].substr(0,1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+1),2)
                                      Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+1)+parseInt(SetCrd[Turn-1].substr(1,1)),2)
                                      Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-1)+parseInt(SetCrd[Turn-1].substr(1,1)),2)
                                      }coor(SetCrd[Turn-1]).style.color="maroon"
                                  }</script>
                              <input value="Ax" class="cmd" onclick="Wax()" type="button" /><script>function Wax(){
                              if(coor(SetCrd[Turn-1]).value!="")coor(SetCrd[Turn-1]).value=")|(";document.all.Weapon.style.display="none"
                              }</script>
                              <input value="Bow" class="cmd" onclick="Wbw()" type="button" /><script>function Wbw(){
                                   if(coor(SetCrd[Turn-1]).value!=""){
                                      coor(SetCrd[Turn-1]).value="Φ"
                                      var Crd=prompt('輸入攻擊方向與值' ,'輸入F(前)B(後)R(右)L(左)')
                                      for(i=0;i<=parseInt(Crd.substr(1,1))+1;i++){
                                          if(Crd.search("F")>=0){
                                              if(coor(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-i)).value=="Θ"&&coor(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-i)).style.color=="black"){
                                                  alert("攻擊失效");break
                                              }
                                              if(i==parseInt(Crd.substr(1,1)))Blood(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-i),1)
                                          }
                                          if(Crd.search("B")>=0){
                                              if(coor(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)+i)).value=="Θ"&&coor(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)+C)).style.color=="black"){
                                                  alert("攻擊失效");break
                                              }
                                              if(i==parseInt(Crd.substr(1,1)))Blood(SetCrd[Turn-1].substr(0,1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+i),1)
                                          }
                                          if(Crd.search("R")>=0){
                                              if(coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+i)+parseInt(SetCrd[Turn-1].substr(1,1))).value=="Θ"&&coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+i)+parseInt(SetCrd[Turn-1].substr(1,1))).style.color=="black"){
                                                  alert("攻擊失效");break
                                              }
                                              if(i==parseInt(Crd.substr(1,1)))Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+i)+parseInt(SetCrd[Turn-1].substr(1,1)),1)
                                          }
                                          if(Crd.search("L")>=0){
                                              if(coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-i)+parseInt(SetCrd[Turn-1].substr(1,1))).value=="Θ"&&coor(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-i)+parseInt(SetCrd[Turn-1].substr(1,1))).style.color=="black"){
                                                  alert("攻擊失效");break
                                              }
                                              if(i==parseInt(Crd.substr(1,1)))Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-i)+parseInt(SetCrd[Turn-1].substr(1,1)),1)
                                          }
                                      }
                                      coor(SetCrd[Turn-1]).style.color="maroon"
                                  }
                              }</script>
                              <input value="Shield" class="cmd" onclick="Wshd()" type="button" /><script>function Wshd(){
                                  if(coor(SetCrd[Turn-1]).value!="")coor(SetCrd[Turn-1]).value="Θ";document.all.Weapon.style.display="none"
                              }</script>
                              <input value="Fork" class="cmd" onclick="Wfrk()" type="button" /><script>function Wfrk(){
                                   if(coor(SetCrd[Turn-1]).value!=""){
                                      coor(SetCrd[Turn-1]).value="Ψ"
                                      var Crd=prompt('輸入攻擊方向' ,'輸入F(前)B(後)R(右)L(左)')
                                      if(Crd=="F")Blood(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-1),3)
                                      if(Crd=="B")Blood(SetCrd[Turn-1].substr(0,1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+1),3)
                                      if(Crd=="R")Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+1)+parseInt(SetCrd[Turn-1].substr(1,1)),3)
                                      if(Crd=="L")Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-1)+parseInt(SetCrd[Turn-1].substr(1,1)),3)
                                      }coor(SetCrd[Turn-1]).style.color="maroon"
                              }</script>
                              <input value="Lance" class="cmd" onclick="Wlcr()" type="button" /><script>function Wlcr(){
                                   if(coor(SetCrd[Turn-1]).value!=""){
                                      coor(SetCrd[Turn-1]).value="Λ"
                                      var Crd=prompt('輸入攻擊方向' ,'輸入F(前)B(後)R(右)L(左)')
                                      for(C=1;C<4;C++){
                                          if(Crd=="F")Blood(SetCrd[Turn-1].substr(0,1)+parseInt(SetCrd[Turn-1].substr(1,1)-C),1)
                                          if(Crd=="B")Blood(SetCrd[Turn-1].substr(0,1)+parseInt(parseInt(SetCrd[Turn-1].substr(1,1))+C),1)
                                          if(Crd=="R")Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))+C)+parseInt(SetCrd[Turn-1].substr(1,1)),1)
                                          if(Crd=="L")Blood(Chr(SetCrd[Turn-1].charCodeAt(SetCrd[Turn-1].substr(0,1))-C)+parseInt(SetCrd[Turn-1].substr(1,1)),1)
                                      }coor(SetCrd[Turn-1]).style.color="maroon"
                                       }
                              }</script>
                          </td>
                      </tr>
                    </table>
                   <table align="center">
                      <tr><td>
                        <table align="center" border="0" cellpadding="0" cellspacing="0">
                              <tr>
                                <td><input id="A1" class="bod" onclick="SetSym('A1')" /></td>
                                <td><input id="B1" class="bod" onclick="SetSym('B1')" /></td>
                                <td><input id="C1" class="bod" onclick="SetSym('C1')" /></td>
                                <td><input id="D1" class="bod" onclick="SetSym('D1')" /></td>
                                <td><input id="E1" class="bod" onclick="SetSym('E1')" /></td>
                                <td><input id="F1" class="bod" onclick="SetSym('F1')" /></td>
                                <td><input id="G1" class="bod" onclick="SetSym('G1')" /></td>
                                <td><input id="H1" class="bod" onclick="SetSym('H1')" /></td>
                                <td><input id="I1" class="bod" onclick="SetSym('I1')" /></td>
                              </tr>
                              <tr>
                                <td><input id="A2" class="bod" onclick="SetSym('A2')" /></td>
                                <td><input id="B2" class="bod" onclick="SetSym('B2')" /></td>
                                <td><input id="C2" class="bod" onclick="SetSym('C2')" /></td>
                                <td><input id="D2" class="bod" onclick="SetSym('D2')" /></td>
                                <td><input id="E2" class="bod" onclick="SetSym('E2')" /></td>
                                <td><input id="F2" class="bod" onclick="SetSym('F2')" /></td>
                                <td><input id="G2" class="bod" onclick="SetSym('G2')" /></td>
                                <td><input id="H2" class="bod" onclick="SetSym('H2')" /></td>
                                <td><input id="I2" class="bod" onclick="SetSym('I2')" /></td>
                              </tr>
                              <tr>
                                <td><input id="A3" class="bod" onclick="SetSym('A3')" /></td>
                                <td><input id="B3" class="bod" onclick="SetSym('B3')" /></td>
                                <td><input id="C3" class="bod" onclick="SetSym('C3')" /></td>
                                <td><input id="D3" class="bod" onclick="SetSym('D3')" /></td>
                                <td><input id="E3" class="bod" onclick="SetSym('E3')" /></td>
                                <td><input id="F3" class="bod" onclick="SetSym('F3')" /></td>
                                <td><input id="G3" class="bod" onclick="SetSym('G3')" /></td>
                                <td><input id="H3" class="bod" onclick="SetSym('H3')" /></td>
                                <td><input id="I3" class="bod" onclick="SetSym('I3')" /></td>
                              </tr>
                              <tr>                            
                                <td><input id="A4" class="bod" onclick="SetSym('A4')" /></td>
                                <td><input id="B4" class="bod" onclick="SetSym('B4')" /></td>
                                <td><input id="C4" class="bod" onclick="SetSym('C4')" /></td>
                                <td><input id="D4" class="bod" onclick="SetSym('D4')" /></td>
                                <td><input id="E4" class="bod" onclick="SetSym('E4')" /></td>
                                <td><input id="F4" class="bod" onclick="SetSym('F4')" /></td>
                                <td><input id="G4" class="bod" onclick="SetSym('G4')" /></td>
                                <td><input id="H4" class="bod" onclick="SetSym('H4')" /></td>
                                <td><input id="I4" class="bod" onclick="SetSym('I4')" /></td>
                              </tr>
                              <tr>
                                <td><input id="A5" class="bod" onclick="SetSym('A5')" /></td>
                                <td><input id="B5" class="bod" onclick="SetSym('B5')" /></td>
                                <td><input id="C5" class="bod" onclick="SetSym('C5')" /></td>
                                <td><input id="D5" class="bod" onclick="SetSym('D5')" /></td>
                                <td><input id="E5" class="bod" onclick="SetSym('E5')" /></td>
                                <td><input id="F5" class="bod" onclick="SetSym('F5')" /></td>
                                <td><input id="G5" class="bod" onclick="SetSym('G5')" /></td>
                                <td><input id="H5" class="bod" onclick="SetSym('H5')" /></td>
                                <td><input id="I5" class="bod" onclick="SetSym('I5')" /></td>
                              </tr>
                              <tr>
                                <td><input id="A6" class="bod" onclick="SetSym('A6')" /></td>
                                <td><input id="B6" class="bod" onclick="SetSym('B6')" /></td>
                                <td><input id="C6" class="bod" onclick="SetSym('C6')" /></td>
                                <td><input id="D6" class="bod" onclick="SetSym('D6')" /></td>
                                <td><input id="E6" class="bod" onclick="SetSym('E6')" /></td>
                                <td><input id="F6" class="bod" onclick="SetSym('F6')" /></td>
                                <td><input id="G6" class="bod" onclick="SetSym('G6')" /></td>
                                <td><input id="H6" class="bod" onclick="SetSym('H6')" /></td>
                                <td><input id="I6" class="bod" onclick="SetSym('I6')" /></td>
                              </tr>
                              <tr>
                                <td><input id="A7" class="bod" onclick="SetSym('A7')" /></td>
                                <td><input id="B7" class="bod" onclick="SetSym('B7')" /></td>
                                <td><input id="C7" class="bod" onclick="SetSym('C7')" /></td>
                                <td><input id="D7" class="bod" onclick="SetSym('D7')" /></td>
                                <td><input id="E7" class="bod" onclick="SetSym('E7')" /></td>
                                <td><input id="F7" class="bod" onclick="SetSym('F7')" /></td>
                                <td><input id="G7" class="bod" onclick="SetSym('G7')" /></td>
                                <td><input id="H7" class="bod" onclick="SetSym('H7')" /></td>
                                <td><input id="I7" class="bod" onclick="SetSym('I7')" /></td>
                              </tr>
                              <tr>
                                <td><input id="A8" class="bod" onclick="SetSym('A8')" /></td>
                                <td><input id="B8" class="bod" onclick="SetSym('B8')" /></td>
                                <td><input id="C8" class="bod" onclick="SetSym('C8')" /></td>
                                <td><input id="D8" class="bod" onclick="SetSym('D8')" /></td>
                                <td><input id="E8" class="bod" onclick="SetSym('E8')" /></td>
                                <td><input id="F8" class="bod" onclick="SetSym('F8')" /></td>
                                <td><input id="G8" class="bod" onclick="SetSym('G8')" /></td>
                                <td><input id="H8" class="bod" onclick="SetSym('H8')" /></td>
                                <td><input id="I8" class="bod" onclick="SetSym('I8')" /></td>
                              </tr>
                              <tr>
                                <td><input id="A9" class="bod" onclick="SetSym('A9')" /></td>
                                <td><input id="B9" class="bod" onclick="SetSym('B9')" /></td>
                                <td><input id="C9" class="bod" onclick="SetSym('C9')" /></td>
                                <td><input id="D9" class="bod" onclick="SetSym('D9')" /></td>
                                <td><input id="E9" class="bod" onclick="SetSym('E9')" /></td>
                                <td><input id="F9" class="bod" onclick="SetSym('F9')" /></td>
                                <td><input id="G9" class="bod" onclick="SetSym('G9')" /></td>
                                <td><input id="H9" class="bod" onclick="SetSym('H9')" /></td>
                                <td><input id="I9" class="bod" onclick="SetSym('I9')" /></td>
                              </tr>
                            </table>
                        <input value="Command" id="Cmd" class="cmd" onclick="coor('OFD').type='Text'" type="button" ondblclick="document.all.Command.style.display='inline'" title="導入指令"/><br />
                        <input value="Direction" id="Dir" class="cnd" onclick="Direction()" type="button" title="模式說明"/><input value="Output" class="cnd" onclick="OutputText(Board[Turn])" type="button" title="導出資料" /><br />
                        <input value="Clean" id="Cln" class="cnd" onclick="if(confirm('是否清除棋盤？')==true)CleanBoard()" type="button" title="清除棋盤"  /><input value="Undo(0)" id="Undo" class="cnd" onclick="if(Turn>2){Turn--;Reader(Board[Turn]+'undo')}else{alert('重做失敗')};coor('Undo').value='Undo('+(Turn-1)+')'" ondblclick="var C=prompt('輸入你要回去的回合');if(parseInt(C)>0){Turn=parseInt(C)+1;Reader(Board[Turn]+'undo');coor('Undo').value='Undo('+(Turn-1)+')'}" type="button" title="回上一步" /><br />
                        <input value="Rul.Ato" class="cmd" id="OFD" type="hidden" />
                      </td></tr>
                    </table> 
              </div>
            </td>
          </tr>
        </table>
      </div>
      <hr align="center" color="blue" noshade="noshade" size="5" width="100%" />
      <div align="right"><div align="left"><a href="Lite.html">Lite version</a></div>Square.Connect is made by <a href="http://www.facebook.com/quivarix">quivarix team</a></div>
    </td>
  </tr>
</table>
</div>
</body>
<script src="Modes.js"></script>
</html>
