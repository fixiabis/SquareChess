<html><head><title>Square.Connect ULite</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><script>var Turn=1,P="",Q="",crd8=["F","B","R","L","FR","FL","BR","BL"];function Val(str){return Math.floor(str)}function Split(str,slt){return str.split(slt)}function Chr(str){return String.fromCharCode(str)}function Ct(id){return document.getElementById(id)}function create(){var B="<table border='0' cellpadding='0' cellspacing='0' align='center'>";for(cd1=65;cd1<74;cd1++){B+="<tr>";for(cd2=1;cd2<10;cd2++){B+="<td><input type='button' value='' id='"+Chr(cd1)+cd2+"' onclick='Set(this.id)' style='color:black;background-color:white;border:solid 1px' /></td>"}B+="</tr>"}B+="</table>";Ct("Board").innerHTML=B;resize()}function resize(){var size=Val(document.body.scrollWidth/10);for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){var sz=size+"px",C=Ct(Chr(cd1)+cd2);C.style.fontSize=size-10+"px";C.style.height=sz;C.style.width=sz}}}function Set(crd){Q="";if(Turn%2==0){P="X"}else{P="O"};if(Turn<3){Q=""}else{Q=P}if(Cnt("F;B;R;L;FR;FL;BR;BL",crd)==true&&Ct(crd).value==""){Turn++;Ct(crd).value=P}else{alert("連線失敗")}Rul()}function Crd(arw,crd){arw=Split(arw,"");var X=0,Y=0;for(var i=0;i<arw.length;i++){switch(arw[i]){case"F":Y--;break;case"B":Y++;break;case"R":X++;break;case"L":X--;break}}return Chr(crd.charCodeAt(crd)+X)+(Val(crd.substr(1,1))+Y)}function Cnt(ord,crd){var ck=false;ord=Split(ord,";");for(a=0;a<ord.length;a++){var cd=Split(ord[a],",");for(b=0;b<cd.length;b++){if(Ct(Crd(cd[b],crd))){var C=Ct(Crd(cd[b],crd));if(cd[b].indexOf("s")>=0){if(C.value==""){ck=true}else{ck=false}}else{if(C.value==Q){ck=true}else{ck=false}}if(ck==true)return ck}}}return ck}function Rul(){var OA=0,XA=0;for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){var CkO=0,CkX=0,C=Chr(cd1)+cd2;for(n=0;n<crd8.length;n++){if(Ct(Crd(crd8[n],C))){var D=Ct(Crd(crd8[n],C));if(D.value=="O"){CkO=1}else if(D.value=="X"){CkX=1}}}if(Ct(C).value==""){if(CkO==1)OA++;if(CkX==1)XA++}}}if(Turn>2){if(OA==0&&XA==0){Res("平手")}else if(OA==0){Res("X方獲勝")}else if(Turn%2==0&&XA==0){Res("O方獲勝")}}}function Res(msg){alert(msg);for(cd1=65;cd1<74;cd1++){for(cd2=1;cd2<10;cd2++){Ct(Chr(cd1)+cd2).value=""}}Turn=1}</script></head><body onload="create()" onresize="resize()" onscroll="resize()" onbeforeunload="if(Turn>1)return '棋局尚未結束'"><span id="Board"></span></body></html>